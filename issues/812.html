<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Bug #812: Exiv2 destroys hard links - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="67oSidhmUrbEJSMe22Lg7FEOrO4JftTYfMrd/K8UOO8J97lmqhyetpFBPBJktezfbpz4l/iddWKB6k107C3fgA==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
    <link rel="alternate" type="application/atom+xml" title="Exiv2 - Bug #812: Exiv2 destroys hard links" href="https://dev.exiv2.org/issues/812.atom" />
<script src="/javascripts/context_menu.js?1550767427"></script><link rel="stylesheet" media="screen" href="/stylesheets/context_menu.css?1550767427" /></head>
<body class="project-exiv2 has-main-menu controller-issues action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="issues" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="issues" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=issues" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=issues">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues selected" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="">
    <div id="sidebar">
          <h3>Issues</h3>

<ul>
<li><a href="/projects/exiv2/issues?set_filter=1">View all issues</a></li>
<li><a href="/projects/exiv2/issues/report">Summary</a></li>

</ul>









        
    </div>

    <div id="content">
        
        <div class="contextual">





</div>


<h2>Bug #812</h2>

<div class="issue tracker-1 status-5 priority-5 priority-high3 closed details">

  <div class="gravatar-with-child">
    
    
  </div>

<div class="subject">
<div><h3>Exiv2 destroys hard links</h3></div>
</div>
        <p class="author">
        Added by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="06 Feb 2012 20:36" href="/projects/exiv2/activity?from=2012-02-06">almost 10 years</a> ago.
        Updated <a title="03 May 2012 17:14" href="/projects/exiv2/activity?from=2012-05-03">over 9 years</a> ago.
        </p>

<div class="attributes">
<div class="splitcontent"><div class="splitcontentleft"><div class="status attribute"><div class="label">Status:</div><div class="value">Closed</div></div><div class="priority attribute"><div class="label">Priority:</div><div class="value">High</div></div><div class="assigned-to attribute"><div class="label">Assignee:</div><div class="value"><a class="user active" href="/users/53">Andreas Huggel</a></div></div><div class="category attribute"><div class="label">Category:</div><div class="value">basicio</div></div><div class="fixed-version attribute"><div class="label">Target version:</div><div class="value"><a title="23 Apr 2012" href="/versions/49">0.23</a></div></div></div><div class="splitcontentleft"><div class="start-date attribute"><div class="label">Start date:</div><div class="value">06 Feb 2012</div></div><div class="due-date attribute"><div class="label">Due date:</div><div class="value"></div></div><div class="progress attribute"><div class="label">% Done:</div><div class="value"><table class="progress progress-100"><tr><td style="width: 100%;" class="closed" title="100%"></td></tr></table><p class="percent">100%</p></div></div><div class="estimated-hours attribute"><div class="label">Estimated time:</div><div class="value"></div></div></div></div>


</div>

<hr />
<div class="description">
  <div class="contextual">
  
  </div>

  <p><strong>Description</strong></p>
  <div class="wiki">
  <p>See <a class="external" href="http://dev.exiv2.org/boards/3/topics/1103">http://dev.exiv2.org/boards/3/topics/1103</a></p>


	<p>Reported by Anders Kamf</p>
  </div>
</div>







</div>

<div id="issue-changesets">
<h3>Associated revisions</h3>
    <div class="changeset">
    <p><a title="Revision 2658" href="/projects/exiv2/repository/exiv2/revisions/2658">Revision 2658</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/2658/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="06 Feb 2012 20:41" href="/projects/exiv2/activity?from=2012-02-06">almost 10 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p><a class="issue tracker-1 status-5 priority-5 priority-high3 closed" title="Bug: Exiv2 destroys hard links (Closed)" href="/issues/812">#812</a>: Don't destroy files when checking if they are writable; use a memory buffer instead of a temporary file when writing files with hard links to preserve the links.</p>
    </div>
    </div>
    <div class="changeset">
    <p><a title="Revision 2660" href="/projects/exiv2/repository/exiv2/revisions/2660">Revision 2660</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/2660/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="10 Feb 2012 19:58" href="/projects/exiv2/activity?from=2012-02-10">almost 10 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p><a class="issue tracker-1 status-5 priority-5 priority-high3 closed" title="Bug: Exiv2 destroys hard links (Closed)" href="/issues/812">#812</a>: Added function to determine the number of hard links on Windows NTFS. (Thomas Beutlich)</p>
    </div>
    </div>
    <div class="changeset">
    <p><a title="Revision 2688" href="/projects/exiv2/repository/exiv2/revisions/2688">Revision 2688</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/2688/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="23 Mar 2012 18:57" href="/projects/exiv2/activity?from=2012-03-23">over 9 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p><a class="issue tracker-1 status-5 priority-5 priority-high3 closed" title="Bug: Exiv2 destroys hard links (Closed)" href="/issues/812">#812</a>: Changed LoadLibrary to LoadLibraryA (Thomas Beutlich).</p>
    </div>
    </div>
    <div class="changeset">
    <p><a title="Revision 2689" href="/projects/exiv2/repository/exiv2/revisions/2689">Revision 2689</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/2689/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="24 Mar 2012 06:00" href="/projects/exiv2/activity?from=2012-03-24">over 9 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p><a class="issue tracker-1 status-5 priority-5 priority-high3 closed" title="Bug: Exiv2 destroys hard links (Closed)" href="/issues/812">#812</a>: Tweak to make the code compile with MSYS/MinGW.</p>
    </div>
    </div>
    <div class="changeset">
    <p><a title="Revision 3630" href="/projects/exiv2/repository/exiv2/revisions/3630">Revision 3630</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/3630/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="24 Mar 2015 00:27" href="/projects/exiv2/activity?from=2015-03-24">over 6 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p><a class="issue tracker-1 status-5 priority-4 priority-default closed" title="Bug: pyexiv2 fails on cifs shares on an Ubuntu client (Closed)" href="/issues/1043">#1043</a> and <a class="issue tracker-1 status-5 priority-4 priority-default closed" title="Bug: Exiv2 nulls file on CIFS share when modifying Exif.Photo.UserComment (Closed)" href="/issues/1042">#1042</a>.  Thanks to Thomas for showing that <a class="changeset" title="#1042 and #1043.  Don&#39;t use a MemIo object for small temporary files." href="/projects/exiv2/repository/exiv2/revisions/3627">r3627</a> reintroduced <a class="issue tracker-1 status-5 priority-5 priority-high3 closed" title="Bug: Exiv2 destroys hard links (Closed)" href="/issues/812">#812</a>.  Thanks to Thoralf for suggesting msync MemIo fix.</p>
    </div>
    </div>
    <div class="changeset">
    <p><a title="Revision 3631" href="/projects/exiv2/repository/exiv2/revisions/3631">Revision 3631</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/3631/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="24 Mar 2015 10:36" href="/projects/exiv2/activity?from=2015-03-24">over 6 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p><a class="issue tracker-1 status-5 priority-4 priority-default closed" title="Bug: Exiv2 nulls file on CIFS share when modifying Exif.Photo.UserComment (Closed)" href="/issues/1042">#1042</a> <a class="issue tracker-1 status-5 priority-4 priority-default closed" title="Bug: pyexiv2 fails on cifs shares on an Ubuntu client (Closed)" href="/issues/1043">#1043</a> <a class="issue tracker-1 status-5 priority-5 priority-high3 closed" title="Bug: Exiv2 destroys hard links (Closed)" href="/issues/812">#812</a>  Added test regression detectors</p>
    </div>
    </div>
    <div class="changeset">
    <p><a title="Revision 3635" href="/projects/exiv2/repository/exiv2/revisions/3635">Revision 3635</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/3635/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="24 Mar 2015 22:25" href="/projects/exiv2/activity?from=2015-03-24">over 6 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p><a class="issue tracker-1 status-5 priority-4 priority-default closed" title="Bug: pyexiv2 fails on cifs shares on an Ubuntu client (Closed)" href="/issues/1043">#1043</a> <a class="issue tracker-1 status-5 priority-4 priority-default closed" title="Bug: Exiv2 nulls file on CIFS share when modifying Exif.Photo.UserComment (Closed)" href="/issues/1042">#1042</a> <a class="issue tracker-1 status-5 priority-5 priority-high3 closed" title="Bug: Exiv2 destroys hard links (Closed)" href="/issues/812">#812</a>.  Thank You to Thomas for this "polishing" patch.  Thank you to everybody who has worked on this issue.  Adding all the comments on the three issues together comes to about 60 items by at least 6 contributors.  And it involves platform issues, networking, Linux and Windows APIs.  One of the most complex issues to arise in Exiv2.  Well done everybody.  And we've dealt with this quickly.  Only 9 days since Calvin first reported <a class="issue tracker-1 status-5 priority-4 priority-default closed" title="Bug: Exiv2 nulls file on CIFS share when modifying Exif.Photo.UserComment (Closed)" href="/issues/1042">#1042</a>.</p>


	<p>I use the term "complex" to mean many threads of technology.  "complex" != "complicated".  "complicated" = "difficult to understand".  We try to avoid "complicated".</p>
    </div>
    </div>

</div>



<div id="history">
<h3>History</h3>
  <div id="change-2058" class="journal has-details">
    <div id="note-1">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-1" class="journal-link">#1</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="15 Feb 2012 05:17" href="/projects/exiv2/activity?from=2012-02-15">almost 10 years</a> ago
      <span id="journal-2058-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>Assigned</i> to <i>Resolved</i></li>
    </ul>
    
    </div>
  </div>
  
  <div id="change-2106" class="journal has-details">
    <div id="note-2">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-2" class="journal-link">#2</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="20 Apr 2012 21:01" href="/projects/exiv2/activity?from=2012-04-20">over 9 years</a> ago
      <span id="journal-2106-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>% Done</strong> changed from <i>0</i> to <i>100</i></li>
    </ul>
    
    </div>
  </div>
  
  <div id="change-2135" class="journal has-details">
    <div id="note-3">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-3" class="journal-link">#3</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="03 May 2012 17:14" href="/projects/exiv2/activity?from=2012-05-03">over 9 years</a> ago
      <span id="journal-2135-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>Resolved</i> to <i>Closed</i></li>
    </ul>
    
    </div>
  </div>
  


</div>

<div style="clear: both;"></div>
<div class="contextual">





</div>


<div style="clear: both;"></div>


<p class="other-formats">Also available in:  <span><a class="atom" rel="nofollow" href="/issues/812.atom">Atom</a></span>
  <span><a class="pdf" rel="nofollow" href="/issues/812.pdf">PDF</a></span>
</p>





        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
