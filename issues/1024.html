<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Feature #1024: Provide regular expression support for the exiv2 -g feature - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="9qOE7xfgLhGWkchBanJpaffRjyzTZeSzpgcTFGkeamYU7i8AZZriEcP1103VpWVayEPbVSKGRQlbJ4OcKieNCQ==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
    <link rel="alternate" type="application/atom+xml" title="Exiv2 - Feature #1024: Provide regular expression support for the exiv2 -g feature" href="https://dev.exiv2.org/issues/1024.atom" />
<script src="/javascripts/context_menu.js?1550767427"></script><link rel="stylesheet" media="screen" href="/stylesheets/context_menu.css?1550767427" /></head>
<body class="project-exiv2 has-main-menu controller-issues action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="issues" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="issues" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=issues" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=issues">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues selected" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="">
    <div id="sidebar">
          <h3>Issues</h3>

<ul>
<li><a href="/projects/exiv2/issues?set_filter=1">View all issues</a></li>
<li><a href="/projects/exiv2/issues/report">Summary</a></li>

</ul>









        
    </div>

    <div id="content">
        
        <div class="contextual">





</div>


<h2>Feature #1024</h2>

<div class="issue tracker-2 status-5 priority-4 priority-default closed details">

  <div class="gravatar-with-child">
    
    
  </div>

<div class="subject">
<div><h3>Provide regular expression support for the exiv2 -g feature</h3></div>
</div>
        <p class="author">
        Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="10 Jan 2015 21:13" href="/projects/exiv2/activity?from=2015-01-10">almost 7 years</a> ago.
        Updated <a title="22 Dec 2015 04:47" href="/projects/exiv2/activity?from=2015-12-22">almost 6 years</a> ago.
        </p>

<div class="attributes">
<div class="splitcontent"><div class="splitcontentleft"><div class="status attribute"><div class="label">Status:</div><div class="value">Closed</div></div><div class="priority attribute"><div class="label">Priority:</div><div class="value">Normal</div></div><div class="assigned-to attribute"><div class="label">Assignee:</div><div class="value"><a class="user active" href="/users/119">Robin Mills</a></div></div><div class="category attribute"><div class="label">Category:</div><div class="value">samples</div></div><div class="fixed-version attribute"><div class="label">Target version:</div><div class="value"><a title="28 Apr 2017" href="/versions/52">0.26</a></div></div></div><div class="splitcontentleft"><div class="start-date attribute"><div class="label">Start date:</div><div class="value">10 Jan 2015</div></div><div class="due-date attribute"><div class="label">Due date:</div><div class="value"></div></div><div class="progress attribute"><div class="label">% Done:</div><div class="value"><table class="progress progress-100"><tr><td style="width: 100%;" class="closed" title="100%"></td></tr></table><p class="percent">100%</p></div></div><div class="estimated-hours attribute"><div class="label">Estimated time:</div><div class="value">4.00 h</div></div></div></div>


</div>

<hr />
<div class="description">
  <div class="contextual">
  
  </div>

  <p><strong>Description</strong></p>
  <div class="wiki">
  <p>Thomas has done some work on this as a side task in <a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Modify exiv2/actions.cpp return -3/253 when no metadata has been found. (Closed)" href="/issues/917">#917</a>.  He attached the file.  Here are my comments on his suggestion:</p>


<blockquote>

	<p>Good work.  Thanks very much.  I didn’t know about &lt;regex.h&gt; - I think this must be quite a new addition to standard C++.  A wonderful new addition.</p>


	<p>I will integrate this to the trunk and add a build flag HAVE_REGEX.  Exiv2(.exe) will degrade to earlier behaviour (string match) when &lt;regex.h&gt; is not available.  I will update the man page src/exiv2.1.</p>


	<p>According to MSDN docs, &lt;regex.h&gt; is supported by Visual Studio 2010 and later.  I’ll investigate if earlier MSVC editions can use GCC's /usr/include/regex.h which is on the build machines for Cygwin and MinGW builds.  However MSVC will have to be able to build OK when &lt;regex.h&gt; is not available as this will be “standard” on older windows platforms.</p>


	<p>I should add something to the test suite.    I’ll update exiv2 -v -V (--verbose —version) to output the value of HAVE_REGEX.  Our current use of exiv2 -v -V in our test suite is limited to the new webready code, and test/build-test.py.  However exiv2 -v -V provides us with the potential for the test suite to morph appropriately.</p>


</blockquote>

<pre>509 rmills@rmillsmbp:~/gnu/exiv2/trunk $ exiv2 -pa -g "L..s" -g Make ~/Pictures/Christmas/ElTeide/DSC_4056.jpg 
Exif.Image.Make                              Ascii      18  NIKON CORPORATION
Exif.Photo.MakerNote                         Undefined 14328  (Binary value suppressed)
Exif.MakerNote.Offset                        Long        1  876
Exif.MakerNote.ByteOrder                     Ascii       3  II
Exif.Nikon3.LensType                         Byte        1  D G VR
Exif.Nikon3.Lens                             Rational    4  18-250mm F3.5-6.3
Exif.Nikon3.LensFStops                       Undefined   4  4.16667
Exif.NikonLd3.LensIDNumber                   Byte        1  Sigma 18-250mm F3.5-6.3 DC OS Macro HSM
Exif.NikonLd3.LensFStops                     Byte        1  F4.2
510 rmills@rmillsmbp:~/gnu/exiv2/trunk $  </pre>

	<p>Thomas has pointed out that it may be desirable to clean up regular expressions which are out of scope.  I don't feel we need to bother with this for the exiv2(.exe) sample application.</p>


<blockquote>

	<p>I did not bother cleaning up the compiled regexps on shutdown, assuming that they will be removed on program termination anyway. But if there is a special mode of the program (e.g. a lib mode?) where the keys_ member goes out of scope, the cleanup function <strong>regfree</strong> should be called for each of its members before that happens.</p>


</blockquote>

	<p>Thanks very much to Thomas for this contribution.</p>
  </div>
</div>






<hr />
<div id="relations">
<div class="contextual">
</div>

<p><strong>Related issues</strong></p>

<form data-cm-url="/issues/context_menu" action="/issues/1024" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="km9XFqu7RZy1t3dWXG4oINBtJ7FNv7oByd+DpXD/PrtwIvz52cGJnODTaFrjuSQT7/9zyLxcG7s0/xMtM8bZ1A==" />
  <table class="list issues odd-even"><tr id="relation-118" class="issue hascontextmenu issue tracker-2 status-5 priority-4 priority-default closed"><td class="checkbox"><input type="checkbox" name="ids[]" value="917" /></td><td class="subject" style="width: 50%">Related to Exiv2 - <a class="issue tracker-2 status-5 priority-4 priority-default closed" href="/issues/917">Feature #917</a>: Modify exiv2/actions.cpp return -3/253 when no metadata has been found.</td><td class="status">Closed</td><td class="start_date">11 Aug 2013</td><td class="due_date"></td><td class="done_ratio"><table class="progress progress-100"><tr><td style="width: 100%;" class="closed" title="100%"></td></tr></table><p class="percent"></p></td><td class="buttons"><a title="Actions" class="icon-only icon-actions js-contextmenu" href="#">Actions</a></td></tr><tr id="relation-126" class="issue hascontextmenu issue tracker-2 status-5 priority-4 priority-default closed"><td class="checkbox"><input type="checkbox" name="ids[]" value="1053" /></td><td class="subject" style="width: 50%">Related to Exiv2 - <a class="issue tracker-2 status-5 priority-4 priority-default closed" href="/issues/1053">Feature #1053</a>: Add option -K Key (--key Key) to specify one or more keys to output.</td><td class="status">Closed</td><td class="start_date">08 Apr 2015</td><td class="due_date"></td><td class="done_ratio"><table class="progress progress-100"><tr><td style="width: 100%;" class="closed" title="100%"></td></tr></table><p class="percent"></p></td><td class="buttons"><a title="Actions" class="icon-only icon-actions js-contextmenu" href="#">Actions</a></td></tr></table>
</form>
<form class="new_relation" id="new-relation-form" style="display: none;" action="/issues/1024/relations" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" />


<p><select onchange="setPredecessorFieldsVisibility();" name="relation[relation_type]" id="relation_relation_type"><option selected="selected" value="relates">Related to</option>
<option value="duplicates">Is duplicate of</option>
<option value="duplicated">Has duplicate</option>
<option value="blocks">Blocks</option>
<option value="blocked">Blocked by</option>
<option value="precedes">Precedes</option>
<option value="follows">Follows</option>
<option value="copied_to">Copied to</option>
<option value="copied_from">Copied from</option></select>
Issue #<input size="10" type="text" name="relation[issue_to_id]" id="relation_issue_to_id" />
<span id="predecessor_fields" style="display:none;">
Delay: <input size="3" type="text" name="relation[delay]" id="relation_delay" /> days
</span>
<input type="submit" name="commit" value="Add" data-disable-with="Add" />
<a href="#" onclick="$(&quot;#new-relation-form&quot;).hide();; return false;">Cancel</a>
</p>

<script>
//<![CDATA[
observeAutocompleteField('relation_issue_to_id', '/issues/auto_complete?issue_id=1024&project_id=exiv2&scope=all')
//]]>
</script>

<script>
//<![CDATA[
setPredecessorFieldsVisibility();
//]]>
</script>

</form>
</div>

</div>

<div id="issue-changesets">
<h3>Associated revisions</h3>
    <div class="changeset">
    <p><a title="Revision 3562" href="/projects/exiv2/repository/exiv2/revisions/3562">Revision 3562</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/3562/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="11 Jan 2015 17:24" href="/projects/exiv2/activity?from=2015-01-11">almost 7 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p><a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Provide regular expression support for the exiv2 -g feature (Closed)" href="/issues/1024">#1024</a>.  Thank you, Thomas for this very useful contribution.</p>
    </div>
    </div>
    <div class="changeset">
    <p><a title="Revision 3563" href="/projects/exiv2/repository/exiv2/revisions/3563">Revision 3563</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/3563/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="11 Jan 2015 17:25" href="/projects/exiv2/activity?from=2015-01-11">almost 7 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p><a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Provide regular expression support for the exiv2 -g feature (Closed)" href="/issues/1024">#1024</a>.  Adding file missing from <a class="changeset" title="#1024.  Thank you, Thomas for this very useful contribution." href="/projects/exiv2/repository/exiv2/revisions/3562">r3562</a>.</p>
    </div>
    </div>
    <div class="changeset">
    <p><a title="Revision 3564" href="/projects/exiv2/repository/exiv2/revisions/3564">Revision 3564</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/3564/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="11 Jan 2015 21:38" href="/projects/exiv2/activity?from=2015-01-11">almost 7 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p><a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Provide regular expression support for the exiv2 -g feature (Closed)" href="/issues/1024">#1024</a>.  Add CMake support for regex.  Fixed unused variables in version.cpp</p>
    </div>
    </div>
    <div class="changeset">
    <p><a title="Revision 3686" href="/projects/exiv2/repository/exiv2/revisions/3686">Revision 3686</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/3686/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="13 Apr 2015 12:33" href="/projects/exiv2/activity?from=2015-04-13">over 6 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p><a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Provide regular expression support for the exiv2 -g feature (Closed)" href="/issues/1024">#1024</a> and <a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Add option -K Key (--key Key) to specify one or more keys to output. (Closed)" href="/issues/1053">#1053</a>.  Changed option REG_EXTENDED and REG_BASIC to support ^ as a begin marker.</p>
    </div>
    </div>
    <div class="changeset">
    <p><a title="Revision 4075" href="/projects/exiv2/repository/exiv2/revisions/4075">Revision 4075</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/4075/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="08 Dec 2015 09:27" href="/projects/exiv2/activity?from=2015-12-08">almost 6 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p><a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Provide regular expression support for the exiv2 -g feature (Closed)" href="/issues/1024">#1024</a>.  Support for C++11 #include &lt;regex&gt;.  --grep keys may have an optional trailer /i to indicate to ignore case.</p>
    </div>
    </div>

</div>



<div id="history">
<h3>History</h3>
  <div id="change-3091" class="journal has-notes has-details">
    <div id="note-1">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-1" class="journal-link">#1</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="11 Jan 2015 17:48" href="/projects/exiv2/activity?from=2015-01-11">almost 7 years</a> ago
      <span id="journal-3091-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>Assigned</i> to <i>Resolved</i></li>
    </ul>
    <div id="journal-3091-notes" class="wiki"><p>Submitted <a class="changeset" title="#1024.  Thank you, Thomas for this very useful contribution." href="/projects/exiv2/repository/exiv2/revisions/3562">r3562</a> and <a class="changeset" title="#1024.  Adding file missing from r3562." href="/projects/exiv2/repository/exiv2/revisions/3563">r3563</a>.  Thank you, Thomas for this contribution.</p>


	<p>Currently MinGW detects &lt;regex.h&gt; and fails to link libregex.a.  I don't know why not, so I've forced MinGW to undefine EXV_HAVE_REGEX.  There are warnings about unused variables in src/version.cpp on all platforms.  And I haven't added anything special to the test suite for the -g feature.  For the moment, this is "good enough".  I will cleanup the warnings before we ship v0.25.  Everything builds and passes the test suite on the build server.</p></div>
    </div>
  </div>
  
  <div id="change-3092" class="journal has-notes">
    <div id="note-2">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-2" class="journal-link">#2</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="11 Jan 2015 22:21" href="/projects/exiv2/activity?from=2015-01-11">almost 7 years</a> ago
      <span id="journal-3092-private_notes" class=""></span>
    </h4>

    <div id="journal-3092-notes" class="wiki"><p><a class="changeset" title="#1024.  Add CMake support for regex.  Fixed unused variables in version.cpp" href="/projects/exiv2/repository/exiv2/revisions/3564">r3564</a>.  CMake support.  Fixed unused variables in src/version.cpp.</p>


	<p>I installed Visual Studio 2012 and VS 2013 Windows Desktop Express on the build server.  Very pleased to say that the msvc2005 environment builds exiv2 with both 2012 and 2013 and the test suite passes.</p>


	<p>Neither 2012 nor 2013 include &lt;regex.h&gt;.  I tried copying the Cygwin &lt;regex.h&gt; to &lt;exiv2dir&gt;/include/exiv2/regex.h.  It doesn't compile because regex.h requires other header files which are not available with Visual Studio.  I'm not going to do any further work on this.  -g degrades to a string match for all MSVC builds.</p></div>
    </div>
  </div>
  
  <div id="change-3104" class="journal has-notes">
    <div id="note-3">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-3" class="journal-link">#3</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/4008">T Modes</a> <a title="17 Jan 2015 09:53" href="/projects/exiv2/activity?from=2015-01-17">almost 7 years</a> ago
      <span id="journal-3104-private_notes" class=""></span>
    </h4>

    <div id="journal-3104-notes" class="wiki"><p>Robin Mills wrote:</p>


<blockquote>

	<p>Neither 2012 nor 2013 include &lt;regex.h&gt;.</p>


</blockquote>

	<p>Yes, but both have &lt;regex&gt; from C++11. Maybe this could be an alternative.</p></div>
    </div>
  </div>
  
  <div id="change-3105" class="journal has-notes">
    <div id="note-4">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-4" class="journal-link">#4</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="17 Jan 2015 10:27" href="/projects/exiv2/activity?from=2015-01-17">almost 7 years</a> ago
      <span id="journal-3105-private_notes" class=""></span>
    </h4>

    <div id="journal-3105-notes" class="wiki"><p>Thanks T.  I expected it to be there.  Perhaps I have to set something in the msvc project files to say "use C++11" if available.</p>


	<p>We're in the end-game of getting v0.25 ready for release and I'm reluctant to start messing about with msvc.  I'm happy to stick to "-g match" degrades to match on MSVC and MinGW builds.</p>


	<p>If you know how to fix this, I'll be happy to accept a patch.</p>


	<p>Robin</p></div>
    </div>
  </div>
  
  <div id="change-3106" class="journal has-notes">
    <div id="note-5">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-5" class="journal-link">#5</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="17 Jan 2015 11:27" href="/projects/exiv2/activity?from=2015-01-17">almost 7 years</a> ago
      <span id="journal-3106-private_notes" class=""></span>
    </h4>

    <div id="journal-3106-notes" class="wiki"><p>I've looked at this on Visual Studio 2013 Windows Desktop Express Edition.  Indeed #include &lt;regex&gt; works and it will be possible to use &lt;regex&gt; instead of "regex.h".</p>


	<p>Adopting #include &lt;regex&gt; is not pain free because the standard &lt;regex&gt; is not source compatible with "regex.h".  The standard uses std::regex instead of ::regex_t.  And, from inspection, I believe there will be other code changes.  For example, the macro REGEX_NOTBOL in "regex.h" becomes enum match_flag_type { ... match_not_bol ... }</p>


	<p>For sure, all of this can be changed.  However, we should really sense three regex support conditions: &lt;regex&gt;, "regex.h" and 'no regex' (which Safari keeps changing to reggae).</p>


	<p>I'm reluctant to divert energy into this for v0.25.</p></div>
    </div>
  </div>
  
  <div id="change-3418" class="journal has-notes has-details">
    <div id="note-6">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-6" class="journal-link">#6</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="13 Apr 2015 09:45" href="/projects/exiv2/activity?from=2015-04-13">over 6 years</a> ago
      <span id="journal-3418-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>Resolved</i> to <i>Assigned</i></li>
    </ul>
    <div id="journal-3418-notes" class="wiki"><p>I've asked Thomas to do more work on this to detect the three build conditions for the autotools and CMake build environments.  I've asked Thomas B to fix msvc2005 when Thomas S is complete.</p>


	<p>0) No regex support (-g = simple match)<br />1) &lt;regex.h&gt;  # GCC<br />2) &lt;regex&gt; # C++ 11</p>


	<p>Additionally, I discovered that ^ and $ are not effective in -g options (see <a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Add option -K Key (--key Key) to specify one or more keys to output. (Closed)" href="/issues/1053">#1053</a> and forum discussion).  Thomas has correctly identified this as using REGEX_NOTBOT and REGEX_NOTEOL.  I've submitted a fix for this <a class="changeset" title="#1028 and #1053.  Change options to regex to respect ^ and $ in option -g" href="/projects/exiv2/repository/exiv2/revisions/3684">r3684</a> and <a class="changeset" title="remove newly added header" href="/projects/exiv2/repository/exiv2/revisions/3685">r3685</a>.  Thomas - you are welcome to change my fix if you wish.</p>


	<p>I've tried expressions such as -g /tag/i and these are ineffective.  We should define the syntax of the -g option in the man page src/exiv2.1</p>


	<p>Thomas S, can you also add to the test suite to ensure -g performs as expected.  You can determine the level of regex support (0,1 or 2) with the following command which uses regex!<pre>536 rmills@rmillsmbp:~ $ exiv2 -vVg regex
exiv2 0.24 001800 (64 bit build)
have_regex=1
537 rmills@rmillsmbp:~ $ </pre></p>


	<p>Thanks very much to Thomas S and Thomas B for working on this.</p></div>
    </div>
  </div>
  
  <div id="change-3444" class="journal has-notes has-details">
    <div id="note-7">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-7" class="journal-link">#7</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="19 Apr 2015 22:11" href="/projects/exiv2/activity?from=2015-04-19">over 6 years</a> ago
      <span id="journal-3444-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Target version</strong> changed from <i>0.25</i> to <i>0.26</i></li>
    </ul>
    <div id="journal-3444-notes" class="wiki"><p>I'm going to defer this for v0.26.  Thanks to Thomas S, -g/--grep is supported on GCC.  C++ 11 compilers will have to wait for v0.26 when Thomas has time available to work on this.</p></div>
    </div>
  </div>
  
  <div id="change-4540" class="journal has-notes has-details">
    <div id="note-8">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-8" class="journal-link">#8</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="08 Dec 2015 09:27" href="/projects/exiv2/activity?from=2015-12-08">almost 6 years</a> ago
      <span id="journal-4540-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>Assigned</i> to <i>Resolved</i></li>
       <li><strong>Assignee</strong> changed from <i>Thomas Schmidt</i> to <i>Robin Mills</i></li>
       <li><strong>% Done</strong> changed from <i>0</i> to <i>100</i></li>
       <li><strong>Estimated time</strong> set to <i>4.00 h</i></li>
    </ul>
    <div id="journal-4540-notes" class="wiki"><p>Fix submitted: <a class="changeset" title="#1024.  Support for C++11 #include &lt;regex&gt;.  --grep keys may have an optional trailer /i to indic..." href="/projects/exiv2/repository/exiv2/revisions/4075">r4075</a></p>


	<p>The --grep feature will use include &lt;regex&gt; when built with c++11.  On other platforms, &lt;regex.h&gt; will be used if available, else string match.  The pattern can been "embellished" with the optional trailer /i = ignore case. <pre>673 rmills@rmillsmbp:~/gnu/exiv2/trunk $ exiv2 -pa --grep gpsl/i test/data/exiv2-bug1122.exv 
Exif.GPSInfo.GPSLatitudeRef                  Ascii       2  North
Exif.GPSInfo.GPSLatitude                     Rational    3  52deg 3.81700' 
Exif.GPSInfo.GPSLongitudeRef                 Ascii       2  East
Exif.GPSInfo.GPSLongitude                    Rational    3  1deg 13.81940' 
674 rmills@rmillsmbp:~/gnu/exiv2/trunk $ </pre>You can detect the configuration with exiv2 -vV  (verbose version). <pre>667 rmills@rmillsmbp:~/gnu/exiv2/trunk $ exiv2 -vV --grep cplus --grep regex
exiv2 0.25 001900 (64 bit build)
cplusplus=199711       &lt;-------- __cplusplus preprocessor value
cplusplus11=0          &lt;---- not C++11
have_regex=1           &lt;---- has &lt;regex.h&gt;
668 rmills@rmillsmbp:~/gnu/exiv2/trunk $ </pre></p></div>
    </div>
  </div>
  
  <div id="change-4561" class="journal has-details">
    <div id="note-9">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-9" class="journal-link">#9</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="22 Dec 2015 04:47" href="/projects/exiv2/activity?from=2015-12-22">almost 6 years</a> ago
      <span id="journal-4561-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>Resolved</i> to <i>Closed</i></li>
    </ul>
    
    </div>
  </div>
  


</div>

<div style="clear: both;"></div>
<div class="contextual">





</div>


<div style="clear: both;"></div>


<p class="other-formats">Also available in:  <span><a class="atom" rel="nofollow" href="/issues/1024.atom">Atom</a></span>
  <span><a class="pdf" rel="nofollow" href="/issues/1024.pdf">PDF</a></span>
</p>





        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
