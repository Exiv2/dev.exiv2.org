<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Bug #731: Error: Directory NikonPreview, entry 0xXXX has invalid size XXX*1; skipping entry. - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="DqHniQI8t515Zm5dogqIw7mi9drqMe8pbnIaL+KPkoHs7ExmcEZ7nSwCcVEd3YTwhjChoxvSTpOTUoqnobZ17g==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
    <link rel="alternate" type="application/atom+xml" title="Exiv2 - Bug #731: Error: Directory NikonPreview, entry 0xXXX has invalid size XXX*1; skipping entry." href="https://dev.exiv2.org/issues/731.atom" />
<script src="/javascripts/context_menu.js?1550767427"></script><link rel="stylesheet" media="screen" href="/stylesheets/context_menu.css?1550767427" /></head>
<body class="project-exiv2 has-main-menu controller-issues action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="issues" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="issues" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=issues" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=issues">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues selected" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="">
    <div id="sidebar">
          <h3>Issues</h3>

<ul>
<li><a href="/projects/exiv2/issues?set_filter=1">View all issues</a></li>
<li><a href="/projects/exiv2/issues/report">Summary</a></li>

</ul>









        
    </div>

    <div id="content">
        
        <div class="contextual">





</div>


<h2>Bug #731</h2>

<div class="issue tracker-1 status-6 priority-4 priority-default closed details">
    <div class="next-prev-links contextual">
      <a title="#732" accesskey="p" href="/issues/732">« Previous</a> |
        <span class="position">
          <a href="/issues?f%5B%5D=status_id&amp;f%5B%5D=author_id&amp;op%5Bauthor_id%5D=%3D&amp;op%5Bstatus_id%5D=%2A&amp;page=1&amp;per_page=25&amp;set_filter=1&amp;sort=id%3Adesc&amp;v%5Bauthor_id%5D%5B%5D=1272&amp;v%5Bstatus_id%5D%5B%5D=">2 of 2</a>
        </span> |
      Next »
    </div>

  <div class="gravatar-with-child">
    
    
  </div>

<div class="subject">
<div><h3>Error: Directory NikonPreview, entry 0xXXX has invalid size XXX*1; skipping entry.</h3></div>
</div>
        <p class="author">
        Added by <a class="user active" href="/users/1272">Ariel Garcia</a> <a title="26 Sep 2010 02:20" href="/projects/exiv2/activity?from=2010-09-26">about 11 years</a> ago.
        Updated <a title="27 Sep 2010 17:54" href="/projects/exiv2/activity?from=2010-09-27">about 11 years</a> ago.
        </p>

<div class="attributes">
<div class="splitcontent"><div class="splitcontentleft"><div class="status attribute"><div class="label">Status:</div><div class="value">Rejected</div></div><div class="priority attribute"><div class="label">Priority:</div><div class="value">Normal</div></div><div class="assigned-to attribute"><div class="label">Assignee:</div><div class="value">-</div></div><div class="category attribute"><div class="label">Category:</div><div class="value">-</div></div></div><div class="splitcontentleft"><div class="start-date attribute"><div class="label">Start date:</div><div class="value">26 Sep 2010</div></div><div class="due-date attribute"><div class="label">Due date:</div><div class="value"></div></div><div class="progress attribute"><div class="label">% Done:</div><div class="value"><table class="progress progress-0"><tr><td style="width: 100%;" class="todo"></td></tr></table><p class="percent">0%</p></div></div><div class="estimated-hours attribute"><div class="label">Estimated time:</div><div class="value"></div></div></div></div>


</div>

<hr />
<div class="description">
  <div class="contextual">
  
  </div>

  <p><strong>Description</strong></p>
  <div class="wiki">
  <p>When running</p>
	<pre><code>exiv2 -pc tree.jpg</code></pre>


	<p>on a jpg created with a Nikon camera (and reprocessed with gimp afterwards)<br />i get tons of Error messages like the following</p>


	<p>$ exiv2 -pc tree.jpg<br />Error: Directory NikonPreview: Next pointer is out of bounds; ignored.<br />Warning: Directory NikonPreview, entry 0x0000 has unknown Exif (TIFF) type 8224; setting type size 1.<br />Error: Directory NikonPreview, entry 0x0000 has invalid size 538976288*1; skipping entry.<br />[...]<br />Warning: Directory NikonPreview, entry 0x2020 has unknown Exif (TIFF) type 512; setting type size 1.<br />Error: Offset of directory NikonPreview, entry 0x2020 is out of bounds: Offset = 0x00010201; truncating the entry<br />[...]</p>


	<p>See the attached file for details.</p>


	<p>Ubuntu Bug: <br />   <a class="external" href="https://bugs.launchpad.net/debian/+source/exiv2/+bug/601555">https://bugs.launchpad.net/debian/+source/exiv2/+bug/601555</a></p>


	<p>Debian Bug:<br />   <a class="external" href="http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=598079">http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=598079</a></p>


	<p>Related information:<br />   <a class="external" href="http://mail.kde.org/pipermail/digikam-users/2009-July/007947.html">http://mail.kde.org/pipermail/digikam-users/2009-July/007947.html</a></p>
  </div>
</div>
  <hr />
  <p><strong>Files</strong></p>
  <div class="attachments">
<div class="contextual">
  
</div>
<table>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/204">ff</a>    <span class="size">(13.5 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/204/ff">ff</a>  </td>
  <td>exiv 2 -pc stderr output</td>
  <td>
      <span class="author">Ariel Garcia, 26 Sep 2010 02:20</span>
  </td>
  <td>
  </td>
</tr>
</table>
</div>








</div>




<div id="history">
<h3>History</h3>
  <div id="change-1743" class="journal has-notes has-details">
    <div id="note-1">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-1" class="journal-link">#1</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="26 Sep 2010 20:51" href="/projects/exiv2/activity?from=2010-09-26">about 11 years</a> ago
      <span id="journal-1743-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>New</i> to <i>Feedback</i></li>
    </ul>
    <div id="journal-1743-notes" class="wiki"><p>I'm not sure what exactly this bug report claims is wrong.</p>


	<p>Such messages typically indicate that part of the metadata structure (the Nikon preview IFD in this case) of the image was corrupted during an earlier image processing step. Exiv2 thus cannot read nor write to that part of the metadata. It can still read and write other parts of the Exif metadata.</p>


	<p>Exiv2 writes to Nikon images without corrupting this IFD, at least recent versions, which know about it do. So if the image metadata was corrupted by exiv2, please test with exiv2 0.20 and provide steps to reproduce the problem.</p>


	<p>If the complaint is that these errors and warnings should be suppressed, then this is related to <a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Error handler: Applications should be able to register an error handler (Closed)" href="/issues/476">#476</a> and <a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: silence warnings from code (Closed)" href="/issues/614">#614</a> which have been resolved recently.</p>


	<p>As the bug seems to have originated from a digiKam user: libkexiv2, which is used by digiKam, was also changed (just yesterday) to make use of that new functionality. Please checkout exiv2 and libkexiv2 from SVN and build digiKam with these to test it.</p></div>
    </div>
  </div>
  
  <div id="change-1746" class="journal has-notes">
    <div id="note-2">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-2" class="journal-link">#2</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/1272">Ariel Garcia</a> <a title="27 Sep 2010 15:51" href="/projects/exiv2/activity?from=2010-09-27">about 11 years</a> ago
      <span id="journal-1746-private_notes" class=""></span>
    </h4>

    <div id="journal-1746-notes" class="wiki"><p>Thanks Andreas,<br />yes you are right, sorry...</p>


	<p>I now checked and the messages don't come up with the original (Nikon) .JPG (nor .NEF), but only for the GIMP-postprocessed files!! :-(<br />So i guess the bug has to be filled against Gimp...</p>


	<p>Thanks again and sorry for the dummy bug.</p></div>
    </div>
  </div>
  
  <div id="change-1747" class="journal has-notes">
    <div id="note-3">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-3" class="journal-link">#3</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/1272">Ariel Garcia</a> <a title="27 Sep 2010 15:56" href="/projects/exiv2/activity?from=2010-09-27">about 11 years</a> ago
      <span id="journal-1747-private_notes" class=""></span>
    </h4>

    <div id="journal-1747-notes" class="wiki"><p>To be more concrete: i checked the cameras' original .JPG -> no errors nor warnings<br />and then opened and saved (no editing took place) that same file with Gimp -> error message appeared.</p></div>
    </div>
  </div>
  
  <div id="change-1748" class="journal has-notes">
    <div id="note-4">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-4" class="journal-link">#4</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/1272">Ariel Garcia</a> <a title="27 Sep 2010 16:14" href="/projects/exiv2/activity?from=2010-09-27">about 11 years</a> ago
      <span id="journal-1748-private_notes" class=""></span>
    </h4>

    <div id="journal-1748-notes" class="wiki"><p>It should be GIMP bug <a class="external" href="https://bugzilla.gnome.org/show_bug.cgi?id=551636">https://bugzilla.gnome.org/show_bug.cgi?id=551636</a></p>


	<p>:-((</p></div>
    </div>
  </div>
  
  <div id="change-1749" class="journal has-details">
    <div id="note-5">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-5" class="journal-link">#5</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="27 Sep 2010 17:54" href="/projects/exiv2/activity?from=2010-09-27">about 11 years</a> ago
      <span id="journal-1749-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>Feedback</i> to <i>Rejected</i></li>
    </ul>
    
    </div>
  </div>
  


</div>

<div style="clear: both;"></div>
<div class="contextual">





</div>


<div style="clear: both;"></div>


<p class="other-formats">Also available in:  <span><a class="atom" rel="nofollow" href="/issues/731.atom">Atom</a></span>
  <span><a class="pdf" rel="nofollow" href="/issues/731.pdf">PDF</a></span>
</p>





        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
