<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Feature #1124: Multi-page tiff image support - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="As3VvGqRTAMujwIX+tIbBvEM6qSpQ4jcPwuo+at8B/vggH5TGOuAA3vrHRtFBRc1zp6+3VigKWbCKzhx6EXglA==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
    <link rel="alternate" type="application/atom+xml" title="Exiv2 - Feature #1124: Multi-page tiff image support" href="https://dev.exiv2.org/issues/1124.atom" />
<script src="/javascripts/context_menu.js?1550767427"></script><link rel="stylesheet" media="screen" href="/stylesheets/context_menu.css?1550767427" /></head>
<body class="project-exiv2 has-main-menu controller-issues action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="issues" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="issues" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=issues" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=issues">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues selected" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="">
    <div id="sidebar">
          <h3>Issues</h3>

<ul>
<li><a href="/projects/exiv2/issues?set_filter=1">View all issues</a></li>
<li><a href="/projects/exiv2/issues/report">Summary</a></li>

</ul>









        
    </div>

    <div id="content">
        
        <div class="contextual">





</div>


<h2>Feature #1124</h2>

<div class="issue tracker-2 status-2 priority-4 priority-default details">

  <div class="gravatar-with-child">
    
    
  </div>

<div class="subject">
<div><h3>Multi-page tiff image support</h3></div>
</div>
        <p class="author">
        Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="03 Oct 2015 19:36" href="/projects/exiv2/activity?from=2015-10-03">about 6 years</a> ago.
        Updated <a title="13 Jun 2016 11:46" href="/projects/exiv2/activity?from=2016-06-13">over 5 years</a> ago.
        </p>

<div class="attributes">
<div class="splitcontent"><div class="splitcontentleft"><div class="status attribute"><div class="label">Status:</div><div class="value">Assigned</div></div><div class="priority attribute"><div class="label">Priority:</div><div class="value">Normal</div></div><div class="assigned-to attribute"><div class="label">Assignee:</div><div class="value"><a class="user active" href="/users/119">Robin Mills</a></div></div><div class="category attribute"><div class="label">Category:</div><div class="value">tiff parser</div></div><div class="fixed-version attribute"><div class="label">Target version:</div><div class="value"><a title="31 Dec 2020" href="/versions/54">0.28</a></div></div></div><div class="splitcontentleft"><div class="start-date attribute"><div class="label">Start date:</div><div class="value">03 Oct 2015</div></div><div class="due-date attribute"><div class="label">Due date:</div><div class="value"></div></div><div class="progress attribute"><div class="label">% Done:</div><div class="value"><table class="progress progress-0"><tr><td style="width: 100%;" class="todo"></td></tr></table><p class="percent">0%</p></div></div><div class="estimated-hours attribute"><div class="label">Estimated time:</div><div class="value"></div></div></div></div>


</div>

<hr />
<div class="description">
  <div class="contextual">
  
  </div>

  <p><strong>Description</strong></p>
  <div class="wiki">
  <p><a class="external" href="http://dev.exiv2.org/boards/3/topics/1030">http://dev.exiv2.org/boards/3/topics/1030</a></p>
  </div>
</div>
  <hr />
  <p><strong>Files</strong></p>
  <div class="attachments">
<div class="contextual">
  
</div>
<table>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/853">multipage_tif_example.tif</a>    <span class="size">(4.2 MB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/853/multipage_tif_example.tif">multipage_tif_example.tif</a>  </td>
  <td></td>
  <td>
      <span class="author">Robin Mills, 28 Oct 2015 18:13</span>
  </td>
  <td>
  </td>
</tr>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/854">bug.tiff</a>    <span class="size">(235 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/854/bug.tiff">bug.tiff</a>  </td>
  <td></td>
  <td>
      <span class="author">Robin Mills, 29 Oct 2015 09:04</span>
  </td>
  <td>
  </td>
</tr>
</table>
</div>








</div>




<div id="history">
<h3>History</h3>
  <div id="change-4343" class="journal has-notes">
    <div id="note-1">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-1" class="journal-link">#1</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="05 Oct 2015 06:25" href="/projects/exiv2/activity?from=2015-10-05">about 6 years</a> ago
      <span id="journal-4343-private_notes" class=""></span>
    </h4>

    <div id="journal-4343-notes" class="wiki"><p>Below is my answer to a private email I received a few days ago, along the same lines as what Robin said in the forum. Not sure if that email is related to the <a href="http://dev.exiv2.org/boards/3/topics/1030?r=2256#message-2256" class="external">latest comment in the forum</a>:</p>


<blockquote>

	<p>Exiv2 doesn't support TIFFs with multiple images (IFDs linked with a next-IFD pointer), that's a limitation of the exiting architecture. Historically, Exiv2 first supported Exif in JPEGs which is a TIFF structure that consists of two linked IFDs, the second one for the thumbnail image - so two should actually work, but not three or more.</p>


	<p>If you are interested to enhance the Exiv2 library, I may be able to give you some pointers to get you started. It is not a straightforward change though and has not been been requested frequently, I don't think this is a feature that anyone from the team is planning to look into soon.</p>


</blockquote></div>
    </div>
  </div>
  
  <div id="change-4347" class="journal has-details">
    <div id="note-2">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-2" class="journal-link">#2</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="06 Oct 2015 20:39" href="/projects/exiv2/activity?from=2015-10-06">about 6 years</a> ago
      <span id="journal-4347-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Tracker</strong> changed from <i>Bug</i> to <i>Feature</i></li>
    </ul>
    
    </div>
  </div>
  
  <div id="change-4408" class="journal has-notes has-details">
    <div id="note-3">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-3" class="journal-link">#3</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="28 Oct 2015 18:13" href="/projects/exiv2/activity?from=2015-10-28">about 6 years</a> ago
      <span id="journal-4408-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>File</strong> <a href="/attachments/853">multipage_tif_example.tif</a> <a class="icon-only icon-download" title="Download" href="/attachments/download/853/multipage_tif_example.tif">multipage_tif_example.tif</a> added</li>
    </ul>
    <div id="journal-4408-notes" class="wiki"><p>Mikayel Egibyan has spoken to me by private email about this.</p>


	<p>The following website discusses multipage tiffs:  <a class="external" href="http://www.nightprogrammer.org/development/multipage-tiff-example-download-test-image-file/">http://www.nightprogrammer.org/development/multipage-tiff-example-download-test-image-file/</a></p>


	<p>Running the command: exiv2 -pa <a class="external" href="http://…...tif">http://…...tif</a> reveals nothing. however exiv2 -pS <a class="external" href="http://....tif">http://....tif</a> reveals a lot of metadata. <pre>$ exiv2 -pS http://www.nightprogrammer.org/wp-uploads/2013/02/multipage_tif_example.tif
STRUCTURE OF TIFF FILE (II): http://www.nightprogrammer.org/wp-uploads/2013/02/multipage_tif_example.tif
 address |    tag                           |      type |    count |   offset | value
  511462 | 0x0100 ImageWidth                |     SHORT |        1 |     1903 | 1903
  511474 | 0x0101 ImageLength               |     SHORT |        1 |      899 | 899
  511486 | 0x0102 BitsPerSample             |     SHORT |        3 |   511670 | 8 8 8
  511498 | 0x0103 Compression               |     SHORT |        1 |        7 | 7
  511510 | 0x0106 PhotometricInterpretation |     SHORT |        1 |        2 | 2
... lots of stuff deleted ...
$ </pre></p>


	<p>I've attached the multi-page sample tiff as it may come in useful when somebody works on this feature.</p></div>
    </div>
  </div>
  
  <div id="change-4409" class="journal has-notes">
    <div id="note-4">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-4" class="journal-link">#4</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="28 Oct 2015 22:33" href="/projects/exiv2/activity?from=2015-10-28">about 6 years</a> ago
      <span id="journal-4409-private_notes" class=""></span>
    </h4>

    <div id="journal-4409-notes" class="wiki"><p>I've found a work around to enable exiv2 to work with multi-page tiffs.  Install libtiff and the samples applications tiffsplit and tiffcp.</p>


	<p><strong>tiffsplit</strong> enables you to split a multi-page tiff into separate (single page) tiffs which exiv2 can process:<pre>658 rmills@rmillsmbp:~/Downloads $ tiffsplit
LIBTIFF, Version 4.0.4
Copyright (c) 1988-1996 Sam Leffler
Copyright (c) 1991-1996 Silicon Graphics, Inc.

usage: tiffsplit input.tif [prefix]
659 rmills@rmillsmbp:~/Downloads $ </pre><strong>tiffcp</strong> has many features including creating a multi-page tiff from separate tiff files:<pre>659 rmills@rmillsmbp:~/Downloads $ tiffcp
LIBTIFF, Version 4.0.4
Copyright (c) 1988-1996 Sam Leffler
Copyright (c) 1991-1996 Silicon Graphics, Inc.

usage: tiffcp [options] input... output
where options are:
 -a              append to output instead of overwriting
 -o offset       set initial directory offset
 -p contig       pack samples contiguously (e.g. RGBRGB...)
 -p separate     store samples separately (e.g. RRR...GGG...BBB...)
 -s              write output in strips
 -t              write output in tiles
 -x              force the merged tiff pages in sequence
 -8              write BigTIFF instead of default ClassicTIFF
 -B              write big-endian instead of native byte order
 -L              write little-endian instead of native byte order
 -M              disable use of memory-mapped files
 -C              disable strip chopping
 -i              ignore read errors
 -b file[,#]     bias (dark) monochrome image to be subtracted from all others
 -,=%            use % rather than , to separate image #'s (per Note below)

 -r #            make each strip have no more than # rows
 -w #            set output tile width (pixels)
 -l #            set output tile length (pixels)

 -f lsb2msb      force lsb-to-msb FillOrder for output
 -f msb2lsb      force msb-to-lsb FillOrder for output

 -c lzw[:opts]   compress output with Lempel-Ziv &#38; Welch encoding
 -c zip[:opts]   compress output with deflate encoding
 -c lzma[:opts]  compress output with LZMA2 encoding
 -c jpeg[:opts]  compress output with JPEG encoding
 -c jbig         compress output with ISO JBIG encoding
 -c packbits     compress output with packbits encoding
 -c g3[:opts]    compress output with CCITT Group 3 encoding
 -c g4           compress output with CCITT Group 4 encoding
 -c sgilog       compress output with SGILOG encoding
 -c none         use no compression algorithm on output

Group 3 options:
 1d              use default CCITT Group 3 1D-encoding
 2d              use optional CCITT Group 3 2D-encoding
 fill            byte-align EOL codes
For example, -c g3:2d:fill to get G3-2D-encoded data with byte-aligned EOLs

JPEG options:
 #               set compression quality level (0-100, default 75)
 r               output color image as RGB rather than YCbCr
For example, -c jpeg:r:50 to get JPEG-encoded RGB data with 50% comp. quality

LZW, Deflate (ZIP) and LZMA2 options:
 #               set predictor value
 p#              set compression level (preset)
For example, -c lzw:2 to get LZW-encoded data with horizontal differencing,
-c zip:3:p9 for Deflate encoding with maximum compression level and floating
point predictor.

Note that input filenames may be of the form filename,x,y,z
where x, y, and z specify image numbers in the filename to copy.
example:  tiffcp -c none -b esp.tif,1 esp.tif,0 test.tif
  subtract 2nd image in esp.tif from 1st yielding uncompressed result test.tif
660 rmills@rmillsmbp:~/Downloads $ </pre>I have also found another couple sources for multi-page tiffs:</p>


	<p><a class="external" href="http://www.openmicroscopy.org/site/support/ome-model/ome-tiff/data.html">http://www.openmicroscopy.org/site/support/ome-model/ome-tiff/data.html</a><br /><a class="external" href="https://bz.apache.org/ooo/show_bug.cgi?id=9193">https://bz.apache.org/ooo/show_bug.cgi?id=9193</a> which references the file:  <a class="external" href="https://bz.apache.org/ooo/attachment.cgi?id=3581">https://bz.apache.org/ooo/attachment.cgi?id=3581</a></p>


	<p>The three multipage tiffs have slightly different use of meta with regard to tags NewSubfileType, SubfileType and PageNumber.  libtiff suffers no pain from this, however should exiv2 embark on multipage tiffs, it may be wise to only support this when libtiff is linked to exiv2.</p>


	<p>To illustrate this, I'll use the referenced apache file listed above.</p>


	<p>Read the metadata in the multi-page tiff:<pre>675 rmills@rmillsmbp:~/Downloads $ exiv2 -pS https://bz.apache.org/ooo/attachment.cgi?id=3581
STRUCTURE OF TIFF FILE (II): https://bz.apache.org/ooo/attachment.cgi?id=3581
 address |    tag                           |      type |    count |   offset | value
   43826 | 0x00fe NewSubfileType            |      LONG |        1 |        0 | 0
   43838 | 0x0100 ImageWidth                |      LONG |        1 |     1728 | 1728
   43850 | 0x0101 ImageLength               |      LONG |        1 |     2266 | 2266
   43862 | 0x0102 BitsPerSample             |     SHORT |        1 |        1 | 1
   43874 | 0x0103 Compression               |     SHORT |        1 |        4 | 4
   43886 | 0x0106 PhotometricInterpretation |     SHORT |        1 |        0 | 0
   43898 | 0x010a FillOrder                 |     SHORT |        1 |        2 | 2
   43910 | 0x010e ImageDescription          |     ASCII |       12 |        8 | Scanned data
   43922 | 0x0111 StripOffsets              |      LONG |        1 |       20 | 20
   43934 | 0x0115 SamplesPerPixel           |     SHORT |        1 |        1 | 1
   43946 | 0x0116 RowsPerStrip              |     SHORT |        1 |     2266 | 2266
   43958 | 0x0117 StripByteCounts           |      LONG |        1 |    43788 | 43788
   43970 | 0x011a XResolution               |  RATIONAL |        1 |    43808 | 43808/0
   43982 | 0x011b YResolution               |  RATIONAL |        1 |    43816 | 43816/0
   43994 | 0x0128 ResolutionUnit            |     SHORT |        1 |        2 | 2
   82636 | 0x00fe NewSubfileType            |      LONG |        1 |        0 | 0
   82648 | 0x0100 ImageWidth                |      LONG |        1 |     1728 | 1728
   82660 | 0x0101 ImageLength               |      LONG |        1 |     2267 | 2267
   82672 | 0x0102 BitsPerSample             |     SHORT |        1 |        1 | 1
   82684 | 0x0103 Compression               |     SHORT |        1 |        4 | 4
   82696 | 0x0106 PhotometricInterpretation |     SHORT |        1 |        0 | 0
   82708 | 0x010a FillOrder                 |     SHORT |        1 |        2 | 2
   82720 | 0x0111 StripOffsets              |      LONG |        1 |    44010 | 44010
   82732 | 0x0115 SamplesPerPixel           |     SHORT |        1 |        1 | 1
   82744 | 0x0116 RowsPerStrip              |     SHORT |        1 |     2267 | 2267
   82756 | 0x0117 StripByteCounts           |      LONG |        1 |    38608 | 38608
   82768 | 0x011a XResolution               |  RATIONAL |        1 |    82618 | 17082/1
   82780 | 0x011b YResolution               |  RATIONAL |        1 |    82626 | 17090/1
   82792 | 0x0128 ResolutionUnit            |     SHORT |        1 |        2 | 2
  111042 | 0x00fe NewSubfileType            |      LONG |        1 |        0 | 0
  111054 | 0x0100 ImageWidth                |      LONG |        1 |     1728 | 1728
  111066 | 0x0101 ImageLength               |      LONG |        1 |     2266 | 2266
  111078 | 0x0102 BitsPerSample             |     SHORT |        1 |        1 | 1
  111090 | 0x0103 Compression               |     SHORT |        1 |        4 | 4
  111102 | 0x0106 PhotometricInterpretation |     SHORT |        1 |        0 | 0
  111114 | 0x010a FillOrder                 |     SHORT |        1 |        2 | 2
  111126 | 0x0111 StripOffsets              |      LONG |        1 |    82808 | 82808
  111138 | 0x0115 SamplesPerPixel           |     SHORT |        1 |        1 | 1
  111150 | 0x0116 RowsPerStrip              |     SHORT |        1 |     2266 | 2266
  111162 | 0x0117 StripByteCounts           |      LONG |        1 |    28216 | 28216
  111174 | 0x011a XResolution               |  RATIONAL |        1 |   111024 | 45488/1
  111186 | 0x011b YResolution               |  RATIONAL |        1 |   111032 | 45496/1
  111198 | 0x0128 ResolutionUnit            |     SHORT |        1 |        2 | 2
  123480 | 0x00fe NewSubfileType            |      LONG |        1 |        0 | 0
  123492 | 0x0100 ImageWidth                |      LONG |        1 |     1728 | 1728
  123504 | 0x0101 ImageLength               |      LONG |        1 |     2265 | 2265
  123516 | 0x0102 BitsPerSample             |     SHORT |        1 |        1 | 1
  123528 | 0x0103 Compression               |     SHORT |        1 |        4 | 4
  123540 | 0x0106 PhotometricInterpretation |     SHORT |        1 |        0 | 0
  123552 | 0x010a FillOrder                 |     SHORT |        1 |        2 | 2
  123564 | 0x0111 StripOffsets              |      LONG |        1 |   111214 | 111214
  123576 | 0x0115 SamplesPerPixel           |     SHORT |        1 |        1 | 1
  123588 | 0x0116 RowsPerStrip              |     SHORT |        1 |     2265 | 2265
  123600 | 0x0117 StripByteCounts           |      LONG |        1 |    12248 | 12248
  123612 | 0x011a XResolution               |  RATIONAL |        1 |   123462 | 57926/1
  123624 | 0x011b YResolution               |  RATIONAL |        1 |   123470 | 57934/1
  123636 | 0x0128 ResolutionUnit            |     SHORT |        1 |        2 | 2
  157122 | 0x00fe NewSubfileType            |      LONG |        1 |        0 | 0
  157134 | 0x0100 ImageWidth                |      LONG |        1 |     1728 | 1728
  157146 | 0x0101 ImageLength               |      LONG |        1 |     2266 | 2266
  157158 | 0x0102 BitsPerSample             |     SHORT |        1 |        1 | 1
  157170 | 0x0103 Compression               |     SHORT |        1 |        4 | 4
  157182 | 0x0106 PhotometricInterpretation |     SHORT |        1 |        0 | 0
  157194 | 0x010a FillOrder                 |     SHORT |        1 |        2 | 2
  157206 | 0x0111 StripOffsets              |      LONG |        1 |   123652 | 123652
  157218 | 0x0115 SamplesPerPixel           |     SHORT |        1 |        1 | 1
  157230 | 0x0116 RowsPerStrip              |     SHORT |        1 |     2266 | 2266
  157242 | 0x0117 StripByteCounts           |      LONG |        1 |    33452 | 33452
  157254 | 0x011a XResolution               |  RATIONAL |        1 |   157104 | 26032/2
  157266 | 0x011b YResolution               |  RATIONAL |        1 |   157112 | 26040/2
  157278 | 0x0128 ResolutionUnit            |     SHORT |        1 |        2 | 2
  189448 | 0x00fe NewSubfileType            |      LONG |        1 |        0 | 0
  189460 | 0x0100 ImageWidth                |      LONG |        1 |     1728 | 1728
  189472 | 0x0101 ImageLength               |      LONG |        1 |     2266 | 2266
  189484 | 0x0102 BitsPerSample             |     SHORT |        1 |        1 | 1
  189496 | 0x0103 Compression               |     SHORT |        1 |        4 | 4
  189508 | 0x0106 PhotometricInterpretation |     SHORT |        1 |        0 | 0
  189520 | 0x010a FillOrder                 |     SHORT |        1 |        2 | 2
  189532 | 0x0111 StripOffsets              |      LONG |        1 |   157294 | 157294
  189544 | 0x0115 SamplesPerPixel           |     SHORT |        1 |        1 | 1
  189556 | 0x0116 RowsPerStrip              |     SHORT |        1 |     2266 | 2266
  189568 | 0x0117 StripByteCounts           |      LONG |        1 |    32136 | 32136
  189580 | 0x011a XResolution               |  RATIONAL |        1 |   189430 | 58358/2
  189592 | 0x011b YResolution               |  RATIONAL |        1 |   189438 | 58366/2
  189604 | 0x0128 ResolutionUnit            |     SHORT |        1 |        2 | 2
  213574 | 0x00fe NewSubfileType            |      LONG |        1 |        0 | 0
  213586 | 0x0100 ImageWidth                |      LONG |        1 |     1728 | 1728
  213598 | 0x0101 ImageLength               |      LONG |        1 |     2258 | 2258
  213610 | 0x0102 BitsPerSample             |     SHORT |        1 |        1 | 1
  213622 | 0x0103 Compression               |     SHORT |        1 |        4 | 4
  213634 | 0x0106 PhotometricInterpretation |     SHORT |        1 |        0 | 0
  213646 | 0x010a FillOrder                 |     SHORT |        1 |        2 | 2
  213658 | 0x0111 StripOffsets              |      LONG |        1 |   189620 | 189620
  213670 | 0x0115 SamplesPerPixel           |     SHORT |        1 |        1 | 1
  213682 | 0x0116 RowsPerStrip              |     SHORT |        1 |     2258 | 2258
  213694 | 0x0117 StripByteCounts           |      LONG |        1 |    23936 | 23936
  213706 | 0x011a XResolution               |  RATIONAL |        1 |   213556 | 16948/3
  213718 | 0x011b YResolution               |  RATIONAL |        1 |   213564 | 16956/3
  213730 | 0x0128 ResolutionUnit            |     SHORT |        1 |        2 | 2
  240228 | 0x00fe NewSubfileType            |      LONG |        1 |        0 | 0
  240240 | 0x0100 ImageWidth                |      LONG |        1 |     1728 | 1728
  240252 | 0x0101 ImageLength               |      LONG |        1 |     2261 | 2261
  240264 | 0x0102 BitsPerSample             |     SHORT |        1 |        1 | 1
  240276 | 0x0103 Compression               |     SHORT |        1 |        4 | 4
  240288 | 0x0106 PhotometricInterpretation |     SHORT |        1 |        0 | 0
  240300 | 0x010a FillOrder                 |     SHORT |        1 |        2 | 2
  240312 | 0x0111 StripOffsets              |      LONG |        1 |   213746 | 213746
  240324 | 0x0115 SamplesPerPixel           |     SHORT |        1 |        1 | 1
  240336 | 0x0116 RowsPerStrip              |     SHORT |        1 |     2261 | 2261
  240348 | 0x0117 StripByteCounts           |      LONG |        1 |    26464 | 26464
  240360 | 0x011a XResolution               |  RATIONAL |        1 |   240210 | 43602/3
  240372 | 0x011b YResolution               |  RATIONAL |        1 |   240218 | 43610/3
  240384 | 0x0128 ResolutionUnit            |     SHORT |        1 |        2 | 2
676 rmills@rmillsmbp:~/Downloads $</pre>Download the referenced file using curl because libtiff doesn't have webready support:<pre>676 rmills@rmillsmbp:~/Downloads $ curl https://bz.apache.org/ooo/attachment.cgi?id=3581 &gt; bug.tiff
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  234k  100  234k    0     0   128k      0  0:00:01  0:00:01 --:--:--  129k
677 rmills@rmillsmbp:~/Downloads $</pre>Split the downloaded file:<pre>677 rmills@rmillsmbp:~/Downloads $ tiffsplit bug.tiff XXX
TIFFFetchNormalTag: Warning, ASCII value for tag "ImageDescription" does not end in null byte.
678 rmills@rmillsmbp:~/Downloads $</pre>List the extracted files:<pre>678 rmills@rmillsmbp:~/Downloads $ dir *.tif
-rw-r--r--+ 1 rmills  staff    43K 28 Oct 22:16 XXXaaa.tif
-rw-r--r--+ 1 rmills  staff    38K 28 Oct 22:16 XXXaab.tif
-rw-r--r--+ 1 rmills  staff    28K 28 Oct 22:16 XXXaac.tif
-rw-r--r--+ 1 rmills  staff    12K 28 Oct 22:16 XXXaad.tif
-rw-r--r--+ 1 rmills  staff    33K 28 Oct 22:16 XXXaae.tif
-rw-r--r--+ 1 rmills  staff    32K 28 Oct 22:16 XXXaaf.tif
-rw-r--r--+ 1 rmills  staff    24K 28 Oct 22:16 XXXaag.tif
-rw-r--r--+ 1 rmills  staff    26K 28 Oct 22:16 XXXaah.tif
679 rmills@rmillsmbp:~/Downloads $</pre>List the metadata in the first image:<pre>679 rmills@rmillsmbp:~/Downloads $ exiv2 -pa XXXaaa.tif 
Exif.Image.NewSubfileType                    Long        1  Primary image
Exif.Image.ImageWidth                        Short       1  1728
Exif.Image.ImageLength                       Short       1  2266
Exif.Image.BitsPerSample                     Short       1  1
Exif.Image.Compression                       Short       1  T6/Group 4 Fax
Exif.Image.PhotometricInterpretation         Short       1  White Is Zero
Exif.Image.FillOrder                         Short       1  2
Exif.Image.ImageDescription                  Ascii      13  Scanned data
Exif.Image.StripOffsets                      Long        1  8
Exif.Image.SamplesPerPixel                   Short       1  1
Exif.Image.RowsPerStrip                      Short       1  2266
Exif.Image.StripByteCounts                   Long        1  43788
Exif.Image.XResolution                       Rational    1  200
Exif.Image.YResolution                       Rational    1  200
Exif.Image.PlanarConfiguration               Short       1  1
Exif.Image.ResolutionUnit                    Short       1  inch
680 rmills@rmillsmbp:~/Downloads $</pre>Update every image using exiv2:<pre>680 rmills@rmillsmbp:~/Downloads $ for i in XXX*.tif; do exiv2 -M"set Exif.Image.ImageDescription Scanned data in file:$i" $i; done
681 rmills@rmillsmbp:~/Downloads $</pre>Check that the timestamps have updated:<pre>681 rmills@rmillsmbp:~/Downloads $ dir *.tiff
-rw-r--r--+ 1 rmills  staff   235K 28 Oct 22:16 bug.tiff
682 rmills@rmillsmbp:~/Downloads $ dir *.tif
-rw-r--r--+ 1 rmills  staff    43K 28 Oct 22:18 XXXaaa.tif
-rw-r--r--+ 1 rmills  staff    38K 28 Oct 22:18 XXXaab.tif
-rw-r--r--+ 1 rmills  staff    28K 28 Oct 22:18 XXXaac.tif
-rw-r--r--+ 1 rmills  staff    12K 28 Oct 22:18 XXXaad.tif
-rw-r--r--+ 1 rmills  staff    33K 28 Oct 22:18 XXXaae.tif
-rw-r--r--+ 1 rmills  staff    32K 28 Oct 22:18 XXXaaf.tif
-rw-r--r--+ 1 rmills  staff    24K 28 Oct 22:18 XXXaag.tif
-rw-r--r--+ 1 rmills  staff    26K 28 Oct 22:18 XXXaah.tif
683 rmills@rmillsmbp:~/Downloads $</pre>Use tiffcp to recreate a multi-page tiff:<pre>683 rmills@rmillsmbp:~/Downloads $ tiffcp XXX*.tif bug-changed.tiff
684 rmills@rmillsmbp:~/Downloads $</pre>And read the metadata with exiv2 -pS:<pre>684 rmills@rmillsmbp:~/Downloads $ exiv2 -pS bug-changed.tiff 
STRUCTURE OF TIFF FILE (II): bug-changed.tiff
 address |    tag                           |      type |    count |   offset | value
   43796 | 0x00fe NewSubfileType            |      LONG |        1 |        0 | 0
   43808 | 0x0100 ImageWidth                |     SHORT |        1 |     1728 | 1728
   43820 | 0x0101 ImageLength               |     SHORT |        1 |     2266 | 2266
   43832 | 0x0102 BitsPerSample             |     SHORT |        1 |        1 | 1
   43844 | 0x0103 Compression               |     SHORT |        1 |        4 | 4
   43856 | 0x0106 PhotometricInterpretation |     SHORT |        1 |        0 | 0
   43868 | 0x010a FillOrder                 |     SHORT |        1 |        2 | 2
   43880 | 0x010e ImageDescription          |     ASCII |       32 |    44020 | Scanned data in file:XXXaaa.tif
   43892 | 0x0111 StripOffsets              |      LONG |        1 |        8 | 8
   43904 | 0x0112 Orientation               |     SHORT |        1 |        1 | 1
   43916 | 0x0115 SamplesPerPixel           |     SHORT |        1 |        1 | 1
   43928 | 0x0116 RowsPerStrip              |     SHORT |        1 |     2266 | 2266
   43940 | 0x0117 StripByteCounts           |      LONG |        1 |    43786 | 43786
   43952 | 0x011a XResolution               |  RATIONAL |        1 |    44004 | 44004/0
   43964 | 0x011b YResolution               |  RATIONAL |        1 |    44012 | 44012/0
   43976 | 0x011c PlanarConfiguration       |     SHORT |        1 |        1 | 1
   43988 | 0x0128 ResolutionUnit            |     SHORT |        1 |        2 | 2
   82660 | 0x00fe NewSubfileType            |      LONG |        1 |        0 | 0
   82672 | 0x0100 ImageWidth                |     SHORT |        1 |     1728 | 1728
   82684 | 0x0101 ImageLength               |     SHORT |        1 |     2267 | 2267
   82696 | 0x0102 BitsPerSample             |     SHORT |        1 |        1 | 1
   82708 | 0x0103 Compression               |     SHORT |        1 |        4 | 4
   82720 | 0x0106 PhotometricInterpretation |     SHORT |        1 |        0 | 0
   82732 | 0x010a FillOrder                 |     SHORT |        1 |        2 | 2
   82744 | 0x010e ImageDescription          |     ASCII |       32 |    82884 | Scanned data in file:XXXaab.tif
   82756 | 0x0111 StripOffsets              |      LONG |        1 |    44052 | 44052
   82768 | 0x0112 Orientation               |     SHORT |        1 |        1 | 1
   82780 | 0x0115 SamplesPerPixel           |     SHORT |        1 |        1 | 1
   82792 | 0x0116 RowsPerStrip              |     SHORT |        1 |     2267 | 2267
   82804 | 0x0117 StripByteCounts           |      LONG |        1 |    38605 | 38605
   82816 | 0x011a XResolution               |  RATIONAL |        1 |    82868 | 17332/1
   82828 | 0x011b YResolution               |  RATIONAL |        1 |    82876 | 17340/1
   82840 | 0x011c PlanarConfiguration       |     SHORT |        1 |        1 | 1
   82852 | 0x0128 ResolutionUnit            |     SHORT |        1 |        2 | 2
  111132 | 0x00fe NewSubfileType            |      LONG |        1 |        0 | 0
  111144 | 0x0100 ImageWidth                |     SHORT |        1 |     1728 | 1728
  111156 | 0x0101 ImageLength               |     SHORT |        1 |     2266 | 2266
  111168 | 0x0102 BitsPerSample             |     SHORT |        1 |        1 | 1
  111180 | 0x0103 Compression               |     SHORT |        1 |        4 | 4
  111192 | 0x0106 PhotometricInterpretation |     SHORT |        1 |        0 | 0
  111204 | 0x010a FillOrder                 |     SHORT |        1 |        2 | 2
  111216 | 0x010e ImageDescription          |     ASCII |       32 |   111356 | Scanned data in file:XXXaac.tif
  111228 | 0x0111 StripOffsets              |      LONG |        1 |    82916 | 82916
  111240 | 0x0112 Orientation               |     SHORT |        1 |        1 | 1
  111252 | 0x0115 SamplesPerPixel           |     SHORT |        1 |        1 | 1
  111264 | 0x0116 RowsPerStrip              |     SHORT |        1 |     2266 | 2266
  111276 | 0x0117 StripByteCounts           |      LONG |        1 |    28214 | 28214
  111288 | 0x011a XResolution               |  RATIONAL |        1 |   111340 | 45804/1
  111300 | 0x011b YResolution               |  RATIONAL |        1 |   111348 | 45812/1
  111312 | 0x011c PlanarConfiguration       |     SHORT |        1 |        1 | 1
  111324 | 0x0128 ResolutionUnit            |     SHORT |        1 |        2 | 2
  123636 | 0x00fe NewSubfileType            |      LONG |        1 |        0 | 0
  123648 | 0x0100 ImageWidth                |     SHORT |        1 |     1728 | 1728
  123660 | 0x0101 ImageLength               |     SHORT |        1 |     2265 | 2265
  123672 | 0x0102 BitsPerSample             |     SHORT |        1 |        1 | 1
  123684 | 0x0103 Compression               |     SHORT |        1 |        4 | 4
  123696 | 0x0106 PhotometricInterpretation |     SHORT |        1 |        0 | 0
  123708 | 0x010a FillOrder                 |     SHORT |        1 |        2 | 2
  123720 | 0x010e ImageDescription          |     ASCII |       32 |   123860 | Scanned data in file:XXXaad.tif
  123732 | 0x0111 StripOffsets              |      LONG |        1 |   111388 | 111388
  123744 | 0x0112 Orientation               |     SHORT |        1 |        1 | 1
  123756 | 0x0115 SamplesPerPixel           |     SHORT |        1 |        1 | 1
  123768 | 0x0116 RowsPerStrip              |     SHORT |        1 |     2265 | 2265
  123780 | 0x0117 StripByteCounts           |      LONG |        1 |    12245 | 12245
  123792 | 0x011a XResolution               |  RATIONAL |        1 |   123844 | 58308/1
  123804 | 0x011b YResolution               |  RATIONAL |        1 |   123852 | 58316/1
  123816 | 0x011c PlanarConfiguration       |     SHORT |        1 |        1 | 1
  123828 | 0x0128 ResolutionUnit            |     SHORT |        1 |        2 | 2
  157344 | 0x00fe NewSubfileType            |      LONG |        1 |        0 | 0
  157356 | 0x0100 ImageWidth                |     SHORT |        1 |     1728 | 1728
  157368 | 0x0101 ImageLength               |     SHORT |        1 |     2266 | 2266
  157380 | 0x0102 BitsPerSample             |     SHORT |        1 |        1 | 1
  157392 | 0x0103 Compression               |     SHORT |        1 |        4 | 4
  157404 | 0x0106 PhotometricInterpretation |     SHORT |        1 |        0 | 0
  157416 | 0x010a FillOrder                 |     SHORT |        1 |        2 | 2
  157428 | 0x010e ImageDescription          |     ASCII |       32 |   157568 | Scanned data in file:XXXaae.tif
  157440 | 0x0111 StripOffsets              |      LONG |        1 |   123892 | 123892
  157452 | 0x0112 Orientation               |     SHORT |        1 |        1 | 1
  157464 | 0x0115 SamplesPerPixel           |     SHORT |        1 |        1 | 1
  157476 | 0x0116 RowsPerStrip              |     SHORT |        1 |     2266 | 2266
  157488 | 0x0117 StripByteCounts           |      LONG |        1 |    33450 | 33450
  157500 | 0x011a XResolution               |  RATIONAL |        1 |   157552 | 26480/2
  157512 | 0x011b YResolution               |  RATIONAL |        1 |   157560 | 26488/2
  157524 | 0x011c PlanarConfiguration       |     SHORT |        1 |        1 | 1
  157536 | 0x0128 ResolutionUnit            |     SHORT |        1 |        2 | 2
  189738 | 0x00fe NewSubfileType            |      LONG |        1 |        0 | 0
  189750 | 0x0100 ImageWidth                |     SHORT |        1 |     1728 | 1728
  189762 | 0x0101 ImageLength               |     SHORT |        1 |     2266 | 2266
  189774 | 0x0102 BitsPerSample             |     SHORT |        1 |        1 | 1
  189786 | 0x0103 Compression               |     SHORT |        1 |        4 | 4
  189798 | 0x0106 PhotometricInterpretation |     SHORT |        1 |        0 | 0
  189810 | 0x010a FillOrder                 |     SHORT |        1 |        2 | 2
  189822 | 0x010e ImageDescription          |     ASCII |       32 |   189962 | Scanned data in file:XXXaaf.tif
  189834 | 0x0111 StripOffsets              |      LONG |        1 |   157600 | 157600
  189846 | 0x0112 Orientation               |     SHORT |        1 |        1 | 1
  189858 | 0x0115 SamplesPerPixel           |     SHORT |        1 |        1 | 1
  189870 | 0x0116 RowsPerStrip              |     SHORT |        1 |     2266 | 2266
  189882 | 0x0117 StripByteCounts           |      LONG |        1 |    32135 | 32135
  189894 | 0x011a XResolution               |  RATIONAL |        1 |   189946 | 58874/2
  189906 | 0x011b YResolution               |  RATIONAL |        1 |   189954 | 58882/2
  189918 | 0x011c PlanarConfiguration       |     SHORT |        1 |        1 | 1
  189930 | 0x0128 ResolutionUnit            |     SHORT |        1 |        2 | 2
  213930 | 0x00fe NewSubfileType            |      LONG |        1 |        0 | 0
  213942 | 0x0100 ImageWidth                |     SHORT |        1 |     1728 | 1728
  213954 | 0x0101 ImageLength               |     SHORT |        1 |     2258 | 2258
  213966 | 0x0102 BitsPerSample             |     SHORT |        1 |        1 | 1
  213978 | 0x0103 Compression               |     SHORT |        1 |        4 | 4
  213990 | 0x0106 PhotometricInterpretation |     SHORT |        1 |        0 | 0
  214002 | 0x010a FillOrder                 |     SHORT |        1 |        2 | 2
  214014 | 0x010e ImageDescription          |     ASCII |       32 |   214154 | Scanned data in file:XXXaag.tif
  214026 | 0x0111 StripOffsets              |      LONG |        1 |   189994 | 189994
  214038 | 0x0112 Orientation               |     SHORT |        1 |        1 | 1
  214050 | 0x0115 SamplesPerPixel           |     SHORT |        1 |        1 | 1
  214062 | 0x0116 RowsPerStrip              |     SHORT |        1 |     2258 | 2258
  214074 | 0x0117 StripByteCounts           |      LONG |        1 |    23934 | 23934
  214086 | 0x011a XResolution               |  RATIONAL |        1 |   214138 | 17530/3
  214098 | 0x011b YResolution               |  RATIONAL |        1 |   214146 | 17538/3
  214110 | 0x011c PlanarConfiguration       |     SHORT |        1 |        1 | 1
  214122 | 0x0128 ResolutionUnit            |     SHORT |        1 |        2 | 2
  240652 | 0x00fe NewSubfileType            |      LONG |        1 |        0 | 0
  240664 | 0x0100 ImageWidth                |     SHORT |        1 |     1728 | 1728
  240676 | 0x0101 ImageLength               |     SHORT |        1 |     2261 | 2261
  240688 | 0x0102 BitsPerSample             |     SHORT |        1 |        1 | 1
  240700 | 0x0103 Compression               |     SHORT |        1 |        4 | 4
  240712 | 0x0106 PhotometricInterpretation |     SHORT |        1 |        0 | 0
  240724 | 0x010a FillOrder                 |     SHORT |        1 |        2 | 2
  240736 | 0x010e ImageDescription          |     ASCII |       32 |   240876 | Scanned data in file:XXXaah.tif
  240748 | 0x0111 StripOffsets              |      LONG |        1 |   214186 | 214186
  240760 | 0x0112 Orientation               |     SHORT |        1 |        1 | 1
  240772 | 0x0115 SamplesPerPixel           |     SHORT |        1 |        1 | 1
  240784 | 0x0116 RowsPerStrip              |     SHORT |        1 |     2261 | 2261
  240796 | 0x0117 StripByteCounts           |      LONG |        1 |    26463 | 26463
  240808 | 0x011a XResolution               |  RATIONAL |        1 |   240860 | 44252/3
  240820 | 0x011b YResolution               |  RATIONAL |        1 |   240868 | 44260/3
  240832 | 0x011c PlanarConfiguration       |     SHORT |        1 |        1 | 1
  240844 | 0x0128 ResolutionUnit            |     SHORT |        1 |        2 | 2
685 rmills@rmillsmbp:~/Downloads $</pre></p></div>
    </div>
  </div>
  
  <div id="change-4411" class="journal has-details">
    <div id="note-5">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-5" class="journal-link">#5</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="29 Oct 2015 09:04" href="/projects/exiv2/activity?from=2015-10-29">about 6 years</a> ago
      <span id="journal-4411-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>File</strong> <a href="/attachments/854">bug.tiff</a> <a class="icon-only icon-download" title="Download" href="/attachments/download/854/bug.tiff">bug.tiff</a> added</li>
    </ul>
    
    </div>
  </div>
  
  <div id="change-5157" class="journal has-details">
    <div id="note-6">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-6" class="journal-link">#6</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="13 Jun 2016 11:46" href="/projects/exiv2/activity?from=2016-06-13">over 5 years</a> ago
      <span id="journal-5157-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>New</i> to <i>Assigned</i></li>
       <li><strong>Assignee</strong> set to <i>Robin Mills</i></li>
       <li><strong>Target version</strong> changed from <i>1.0</i> to <i>0.28</i></li>
    </ul>
    
    </div>
  </div>
  


</div>

<div style="clear: both;"></div>
<div class="contextual">





</div>


<div style="clear: both;"></div>


<p class="other-formats">Also available in:  <span><a class="atom" rel="nofollow" href="/issues/1124.atom">Atom</a></span>
  <span><a class="pdf" rel="nofollow" href="/issues/1124.pdf">PDF</a></span>
</p>





        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
