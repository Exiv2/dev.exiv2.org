<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Support #995: Writing Exif to TIFF-like Hasselblad RAW *.3fr  - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="+8liiGhSdKP/VGIDEzwRGJPtJ3xgSqM1AT9ZADsGuEYZhMlnGii4o6owfQ+s6x0rrH9zBZGpAo/8H8mIeD9fKQ==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
    <link rel="alternate" type="application/atom+xml" title="Exiv2 - Support #995: Writing Exif to TIFF-like Hasselblad RAW *.3fr " href="https://dev.exiv2.org/issues/995.atom" />
<script src="/javascripts/context_menu.js?1550767427"></script><link rel="stylesheet" media="screen" href="/stylesheets/context_menu.css?1550767427" /></head>
<body class="project-exiv2 has-main-menu controller-issues action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="issues" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="issues" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=issues" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=issues">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues selected" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="">
    <div id="sidebar">
          <h3>Issues</h3>

<ul>
<li><a href="/projects/exiv2/issues?set_filter=1">View all issues</a></li>
<li><a href="/projects/exiv2/issues/report">Summary</a></li>

</ul>









        
    </div>

    <div id="content">
        
        <div class="contextual">





</div>


<h2>Support #995</h2>

<div class="issue tracker-3 status-5 priority-4 priority-default closed details">

  <div class="gravatar-with-child">
    
    
  </div>

<div class="subject">
<div><h3>Writing Exif to TIFF-like Hasselblad RAW *.3fr </h3></div>
</div>
        <p class="author">
        Added by <a class="user active" href="/users/3794">Markus Diem</a> <a title="04 Nov 2014 14:48" href="/projects/exiv2/activity?from=2014-11-04">about 7 years</a> ago.
        Updated <a title="21 Jun 2015 16:42" href="/projects/exiv2/activity?from=2015-06-21">over 6 years</a> ago.
        </p>

<div class="attributes">
<div class="splitcontent"><div class="splitcontentleft"><div class="status attribute"><div class="label">Status:</div><div class="value">Closed</div></div><div class="priority attribute"><div class="label">Priority:</div><div class="value">Normal</div></div><div class="assigned-to attribute"><div class="label">Assignee:</div><div class="value"><a class="user active" href="/users/119">Robin Mills</a></div></div><div class="category attribute"><div class="label">Category:</div><div class="value">tiff parser</div></div><div class="fixed-version attribute"><div class="label">Target version:</div><div class="value"><a title="17 May 2015" href="/versions/51">0.25</a></div></div></div><div class="splitcontentleft"><div class="start-date attribute"><div class="label">Start date:</div><div class="value">04 Nov 2014</div></div><div class="due-date attribute"><div class="label">Due date:</div><div class="value"></div></div><div class="progress attribute"><div class="label">% Done:</div><div class="value"><table class="progress progress-100"><tr><td style="width: 100%;" class="closed" title="100%"></td></tr></table><p class="percent">100%</p></div></div><div class="estimated-hours attribute"><div class="label">Estimated time:</div><div class="value"></div></div></div></div>


</div>

<hr />
<div class="description">
  <div class="contextual">
  
  </div>

  <p><strong>Description</strong></p>
  <div class="wiki">
  <p>hi,</p>


	<p>we have tried writing exif data (e.g. orientation) to a TIFF-like RAW file (Hasselblad RAW *.3fr). There seem to be some issues while loading:<br /><code>Warning: Directory SubImage1, entry 0x0111: Strip 0 is outside of the data area; ignored.</code><br />but the metadata is loaded correctly. <br />However, if we try saving some metadata to the file it gets corrupted. The bug can be reproduced with exiv2-0.23 and exiv2-0.24 (Win8 and Ubuntu 14.04). I have provided a sample image here (since it is too large to attach): <a class="external" href="ftp://scruffy.caa.tuwien.ac.at/staff/diem/sample-raw.zip">ftp://scruffy.caa.tuwien.ac.at/staff/diem/sample-raw.zip</a><br />It would be cool if you could have a look at it.</p>


	<p>regards,<br />markus</p>
  </div>
</div>






<hr />
<div id="relations">
<div class="contextual">
</div>

<p><strong>Related issues</strong></p>

<form data-cm-url="/issues/context_menu" action="/issues/995" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="bccxm1+fWHP5jCTVdDwtfqYDCdZK9FxNqcKBYWTtchmPipp0LeWUc6zoO9nL6yFNmZFdr7sX/fdU4hHpJ9SVdg==" />
  <table class="list issues odd-even"><tr id="relation-131" class="issue hascontextmenu issue tracker-2 status-2 priority-4 priority-default"><td class="checkbox"><input type="checkbox" name="ids[]" value="992" /></td><td class="subject" style="width: 50%">Related to Exiv2 - <a class="issue tracker-2 status-2 priority-4 priority-default" href="/issues/992">Feature #992</a>: Better raw file support and test</td><td class="status">Assigned</td><td class="start_date">18 Sep 2014</td><td class="due_date"></td><td class="done_ratio"><table class="progress progress-0"><tr><td style="width: 100%;" class="todo"></td></tr></table><p class="percent"></p></td><td class="buttons"><a title="Actions" class="icon-only icon-actions js-contextmenu" href="#">Actions</a></td></tr></table>
</form>
<form class="new_relation" id="new-relation-form" style="display: none;" action="/issues/995/relations" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" />


<p><select onchange="setPredecessorFieldsVisibility();" name="relation[relation_type]" id="relation_relation_type"><option selected="selected" value="relates">Related to</option>
<option value="duplicates">Is duplicate of</option>
<option value="duplicated">Has duplicate</option>
<option value="blocks">Blocks</option>
<option value="blocked">Blocked by</option>
<option value="precedes">Precedes</option>
<option value="follows">Follows</option>
<option value="copied_to">Copied to</option>
<option value="copied_from">Copied from</option></select>
Issue #<input size="10" type="text" name="relation[issue_to_id]" id="relation_issue_to_id" />
<span id="predecessor_fields" style="display:none;">
Delay: <input size="3" type="text" name="relation[delay]" id="relation_delay" /> days
</span>
<input type="submit" name="commit" value="Add" data-disable-with="Add" />
<a href="#" onclick="$(&quot;#new-relation-form&quot;).hide();; return false;">Cancel</a>
</p>

<script>
//<![CDATA[
observeAutocompleteField('relation_issue_to_id', '/issues/auto_complete?issue_id=995&project_id=exiv2&scope=all')
//]]>
</script>

<script>
//<![CDATA[
setPredecessorFieldsVisibility();
//]]>
</script>

</form>
</div>

</div>




<div id="history">
<h3>History</h3>
  <div id="change-2950" class="journal has-notes has-details">
    <div id="note-1">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-1" class="journal-link">#1</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="04 Nov 2014 23:49" href="/projects/exiv2/activity?from=2014-11-04">about 7 years</a> ago
      <span id="journal-2950-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Tracker</strong> changed from <i>Bug</i> to <i>Support</i></li>
       <li><strong>Category</strong> set to <i>tiff parser</i></li>
       <li><strong>Status</strong> changed from <i>New</i> to <i>Assigned</i></li>
       <li><strong>Assignee</strong> set to <i>Robin Mills</i></li>
       <li><strong>Target version</strong> set to <i>0.25</i></li>
    </ul>
    <div id="journal-2950-notes" class="wiki"><p>From your description, it sounds as though your input file is suspect.  Thanks for the sample file.  I've recovered that without difficulty.  I'm on vacation at the moment, so I'm not promising when I will investigate.  Please let me know if this is urgent.</p>


	<p>Robin</p></div>
    </div>
  </div>
  
  <div id="change-3487" class="journal has-notes has-details">
    <div id="note-2">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-2" class="journal-link">#2</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="25 Apr 2015 12:20" href="/projects/exiv2/activity?from=2015-04-25">over 6 years</a> ago
      <span id="journal-3487-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>Assigned</i> to <i>Resolved</i></li>
    </ul>
    <div id="journal-3487-notes" class="wiki"><p>I've had a look at this.  I'm currently adding a feature -pS to the exiv2 application to print the structure of files (currently implemented for JPEG, PNG and TIFF).  I've had a look at your files:<pre>1262 rmills@rmillsmbp:~/Downloads/sample-raw $ exiv2 -pS some-raw.3FR
STRUCTURE OF TIFF FILE: some-raw.3FR
 address |    tag                      |      type |    count |   offset | value
      10 | 0x00fe NewSubfileType       |      LONG |        1 |        1 | 1
      22 | 0x0100 ImageWidth           |     SHORT |        1 |      218 | 218
      34 | 0x0101 ImageLength          |     SHORT |        1 |      218 | 218
      46 | 0x0102 BitsPerSample        |     SHORT |        3 |      328 | 
      58 | 0x0103 Compression          |     SHORT |        1 |        1 | 1
      70 | 0x0106 PhotometricInterpret |     SHORT |        1 |        2 | 2
      82 | 0x010f Make                 |     ASCII |       11 |      336 | Hasselblad.
      94 | 0x0110 Model                |     ASCII |       21 |      348 | Hasselblad 500 mech..
     106 | 0x0111 StripOffsets         |      LONG |        1 |     2048 | 2048
     118 | 0x0112 Orientation          |     SHORT |        1 |        6 | 6
     130 | 0x0115 SamplesPerPixel      |     SHORT |        1 |        3 | 3
     142 | 0x0116 RowsPerStrip         |      LONG |        1 |      218 | 218
     154 | 0x0117 StripByteCounts      |      LONG |        1 |   142572 | 11500
     166 | 0x011a XResolution          |  RATIONAL |        1 |      372 | 
     178 | 0x011b YResolution          |  RATIONAL |        1 |      380 | 
     190 | 0x011c PlanarConfiguration  |     SHORT |        1 |        1 | 1
     202 | 0x0128 ResolutionUnit       |     SHORT |        1 |        2 | 2
     214 | 0x0131 Software             |     ASCII |       24 |      388 | 196.50.271.41.23.4.1.13.
     226 | 0x0132 DateTime             |     ASCII |       20 |      412 | 2007:06:03 12:22:55.
     238 | 0x014a SubIFDs              |      LONG |        1 |      432 | 432
     250 | 0x02bc XMLPacket            |      BYTE |       48 |      620 | &lt;x:xmpmeta xmlns:x='adobe:ns:met ...
     262 | 0x8769 ExifTag              |      LONG |        1 |      668 | 668
     274 | 0xc614 UniqueCameraModel    |     ASCII |       13 |     1108 | Hasselblad96.
     286 | 0xc621 ColorMatrix1         | SRATIONAL |        9 |     1124 | 
     298 | 0xc628 AsShotNeutral        | SRATIONAL |        3 |     1196 | 
     310 | 0xc65d RawDataUniqueID      |      BYTE |       16 |     1220 | 03F0C73E000002B1
1263 rmills@rmillsmbp:~/Downloads/sample-raw $ exiv2 -pS ~/Downloads/sample-raw/some-raw-after-saving.3FR 
STRUCTURE OF TIFF FILE: /Users/rmills/Downloads/sample-raw/some-raw-after-saving.3FR
 address |    tag                      |      type |    count |   offset | value
      10 | 0x00fe NewSubfileType       |      LONG |        1 |        1 | 1
      22 | 0x0100 ImageWidth           |     SHORT |        1 |      218 | 218
      34 | 0x0101 ImageLength          |     SHORT |        1 |      218 | 218
      46 | 0x0102 BitsPerSample        |     SHORT |        3 |      314 | 
      58 | 0x0103 Compression          |     SHORT |        1 |        1 | 1
      70 | 0x0106 PhotometricInterpret |     SHORT |        1 |        2 | 2
      82 | 0x010f Make                 |     ASCII |       11 |      320 | Hasselblad.
      94 | 0x0110 Model                |     ASCII |       21 |      332 | Hasselblad 500 mech..
     106 | 0x0111 StripOffsets         |      LONG |        1 |     6862 | 6862
     118 | 0x0112 Orientation          |     SHORT |        1 |        3 | 3
     130 | 0x0115 SamplesPerPixel      |     SHORT |        1 |        3 | 3
     142 | 0x0116 RowsPerStrip         |      LONG |        1 |      218 | 218
     154 | 0x0117 StripByteCounts      |      LONG |        1 |   142572 | 11500
     166 | 0x011a XResolution          |  RATIONAL |        1 |      354 | 
     178 | 0x011b YResolution          |  RATIONAL |        1 |      362 | 
     190 | 0x011c PlanarConfiguration  |     SHORT |        1 |        1 | 1
     202 | 0x0128 ResolutionUnit       |     SHORT |        1 |        2 | 2
     214 | 0x0131 Software             |     ASCII |       24 |      370 | 196.50.271.41.23.4.1.13.
     226 | 0x0132 DateTime             |     ASCII |       20 |      394 | 2007:06:03 12:22:55.
     238 | 0x014a SubIFDs              |      LONG |        1 |      540 | 540
     250 | 0x8769 ExifTag              |      LONG |        1 |      722 | 722
     262 | 0xc614 UniqueCameraModel    |     ASCII |       13 |      414 | Hasselblad96.
     274 | 0xc621 ColorMatrix1         | SRATIONAL |        9 |      428 | 
     286 | 0xc628 AsShotNeutral        | SRATIONAL |        3 |      500 | 
     298 | 0xc65d RawDataUniqueID      |      BYTE |       16 |      524 | 03F0C73E000002B1
    1158 | 0x0103 Compression          |     SHORT |        1 |        6 | 6
    1170 | 0x0201 JPEGInterchangeForma |      LONG |        1 |     1198 | 1198
    1182 | 0x0202 JPEGInterchangeForma |      LONG |        1 |     5664 | 5664
1265 rmills@rmillsmbp:~/Downloads/sample-raw $ </pre>I'm going to mark this "resolved" as I there isn't much we can do at this time.  exiv2 is reporting unhappiness with the file, and is having trouble saving the file.</p>


	<p>However your issue isn't being forgotten or ignored because we have an open issue to improve our RAW file support.  I've associated this report with the effort to improve our RAW support and your file will receive additional attention at some time in the future.</p></div>
    </div>
  </div>
  
  <div id="change-3488" class="journal has-details">
    <div id="note-3">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-3" class="journal-link">#3</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="25 Apr 2015 12:22" href="/projects/exiv2/activity?from=2015-04-25">over 6 years</a> ago
      <span id="journal-3488-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Subject</strong> changed from <i>Writing Exif to TIFF-like RAW</i> to <i>Writing Exif to TIFF-like Hasselblad RAW *.3fr </i></li>
    </ul>
    
    </div>
  </div>
  
  <div id="change-3660" class="journal has-details">
    <div id="note-4">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-4" class="journal-link">#4</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="08 May 2015 16:31" href="/projects/exiv2/activity?from=2015-05-08">over 6 years</a> ago
      <span id="journal-3660-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>% Done</strong> changed from <i>0</i> to <i>100</i></li>
    </ul>
    
    </div>
  </div>
  
  <div id="change-3894" class="journal has-details">
    <div id="note-5">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-5" class="journal-link">#5</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="21 Jun 2015 16:41" href="/projects/exiv2/activity?from=2015-06-21">over 6 years</a> ago
      <span id="journal-3894-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>Resolved</i> to <i>Closed</i></li>
    </ul>
    
    </div>
  </div>
  


</div>

<div style="clear: both;"></div>
<div class="contextual">





</div>


<div style="clear: both;"></div>


<p class="other-formats">Also available in:  <span><a class="atom" rel="nofollow" href="/issues/995.atom">Atom</a></span>
  <span><a class="pdf" rel="nofollow" href="/issues/995.pdf">PDF</a></span>
</p>





        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
