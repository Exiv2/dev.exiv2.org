<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Bug #1275: Exiv2 0.26-svn issue with ExifTags class MPF tags UPSTREAM - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="yi3Ny1+XomLiztQLzM33SoD+GATprVamGsMyuwGKwx8oYGYkLe1uYreqywdzGvt5v2xMfRhO9xzn46IzQrMkcA==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
    <link rel="alternate" type="application/atom+xml" title="Exiv2 - Bug #1275: Exiv2 0.26-svn issue with ExifTags class MPF tags UPSTREAM" href="https://dev.exiv2.org/issues/1275.atom" />
<script src="/javascripts/context_menu.js?1550767427"></script><link rel="stylesheet" media="screen" href="/stylesheets/context_menu.css?1550767427" /></head>
<body class="project-exiv2 has-main-menu controller-issues action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="issues" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="issues" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=issues" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=issues">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues selected" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="">
    <div id="sidebar">
          <h3>Issues</h3>

<ul>
<li><a href="/projects/exiv2/issues?set_filter=1">View all issues</a></li>
<li><a href="/projects/exiv2/issues/report">Summary</a></li>

</ul>









        
    </div>

    <div id="content">
        
        <div class="contextual">





</div>


<h2>Bug #1275</h2>

<div class="issue tracker-1 status-5 priority-4 priority-default closed details">

  <div class="gravatar-with-child">
    
    
  </div>

<div class="subject">
<div><h3>Exiv2 0.26-svn issue with ExifTags class MPF tags UPSTREAM</h3></div>
</div>
        <p class="author">
        Added by <a class="user active" href="/users/4748">Wil Cowb</a> <a title="06 Feb 2017 18:03" href="/projects/exiv2/activity?from=2017-02-06">almost 5 years</a> ago.
        Updated <a title="13 Mar 2017 11:38" href="/projects/exiv2/activity?from=2017-03-13">over 4 years</a> ago.
        </p>

<div class="attributes">
<div class="splitcontent"><div class="splitcontentleft"><div class="status attribute"><div class="label">Status:</div><div class="value">Closed</div></div><div class="priority attribute"><div class="label">Priority:</div><div class="value">Normal</div></div><div class="assigned-to attribute"><div class="label">Assignee:</div><div class="value"><a class="user active" href="/users/119">Robin Mills</a></div></div><div class="category attribute"><div class="label">Category:</div><div class="value">api</div></div><div class="fixed-version attribute"><div class="label">Target version:</div><div class="value"><a title="28 Apr 2017" href="/versions/52">0.26</a></div></div></div><div class="splitcontentleft"><div class="start-date attribute"><div class="label">Start date:</div><div class="value">06 Feb 2017</div></div><div class="due-date attribute"><div class="label">Due date:</div><div class="value"></div></div><div class="progress attribute"><div class="label">% Done:</div><div class="value"><table class="progress progress-100"><tr><td style="width: 100%;" class="closed" title="100%"></td></tr></table><p class="percent">100%</p></div></div><div class="estimated-hours attribute"><div class="label">Estimated time:</div><div class="value">5.00 h</div></div></div></div>


</div>

<hr />
<div class="description">
  <div class="contextual">
  
  </div>

  <p><strong>Description</strong></p>
  <div class="wiki">
  <p>Hello,</p>


	<p>digiKam dev team came to the conclusion that exiv2 0.26 can't handle MPF tags well.</p>


	<p>There are more details on the bug here:<br /><a class="external" href="https://bugs.kde.org/show_bug.cgi?id=375809">https://bugs.kde.org/show_bug.cgi?id=375809</a></p>


	<p>Should you have any questions please feel free to contact either myself or Gilles Caulier / Maik Qualmann</p>
  </div>
</div>







</div>

<div id="issue-changesets">
<h3>Associated revisions</h3>
    <div class="changeset">
    <p><a title="Revision 4704" href="/projects/exiv2/repository/exiv2/revisions/4704">Revision 4704</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/4704/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="08 Feb 2017 20:10" href="/projects/exiv2/activity?from=2017-02-08">almost 5 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p><a class="issue tracker-1 status-5 priority-4 priority-default closed" title="Bug: Exiv2 0.26-svn issue with ExifTags class MPF tags UPSTREAM (Closed)" href="/issues/1275">#1275</a> Fix submitted.</p>
    </div>
    </div>
    <div class="changeset">
    <p><a title="Revision 4705" href="/projects/exiv2/repository/exiv2/revisions/4705">Revision 4705</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/4705/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="09 Feb 2017 05:06" href="/projects/exiv2/activity?from=2017-02-09">almost 5 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p><a class="issue tracker-1 status-5 priority-4 priority-default closed" title="Bug: Exiv2 0.26-svn issue with ExifTags class MPF tags UPSTREAM (Closed)" href="/issues/1275">#1275</a> Fix issue with Exiv2::Key.familyName() for key.ifdId_ == mpfId</p>
    </div>
    </div>

</div>



<div id="history">
<h3>History</h3>
  <div id="change-5817" class="journal has-notes has-details">
    <div id="note-1">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-1" class="journal-link">#1</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="06 Feb 2017 18:18" href="/projects/exiv2/activity?from=2017-02-06">almost 5 years</a> ago
      <span id="journal-5817-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>New</i> to <i>Assigned</i></li>
       <li><strong>Assignee</strong> set to <i>Robin Mills</i></li>
       <li><strong>Priority</strong> changed from <i>High</i> to <i>Normal</i></li>
    </ul>
    <div id="journal-5817-notes" class="wiki"><p>Please provide a test file and describe the problem using the exiv2(.exe) sample application and the issue will be investigated.</p></div>
    </div>
  </div>
  
  <div id="change-5819" class="journal has-notes">
    <div id="note-2">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-2" class="journal-link">#2</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/4748">Wil Cowb</a> <a title="08 Feb 2017 16:03" href="/projects/exiv2/activity?from=2017-02-08">almost 5 years</a> ago
      <span id="journal-5819-private_notes" class=""></span>
    </h4>

    <div id="journal-5819-notes" class="wiki"><p>Robin Mills wrote:</p>


<blockquote>

	<p>Please provide a test file and describe the problem using the exiv2(.exe) sample application and the issue will be investigated.</p>


</blockquote>

	<p>Hello Robin,<br />Here is how to reproduce the exception:<br />" <br />The problem come from MPF Tags declared from group at Exiv2::tags.cpp::line 2166.<br />Typically, if i try to resume:<br />Exiv2::ExifKey(Exiv2::ExifData::Internal::mpfTagsList())<br />Generate the exception...<br />" <br />It's possible that the crash cannot be reproduced in Exiv2 CLI tool if method explained above is not used.<br />There is no need of an image to test this crash. In digiKam it happens when code extract all available Exiftags with details, descriptions, etc... for the library database.</p></div>
    </div>
  </div>
  
  <div id="change-5820" class="journal has-notes">
    <div id="note-3">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-3" class="journal-link">#3</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="08 Feb 2017 16:57" href="/projects/exiv2/activity?from=2017-02-08">almost 5 years</a> ago
      <span id="journal-5820-private_notes" class=""></span>
    </h4>

    <div id="journal-5820-notes" class="wiki"><p>I'm not sure I understand what this is about.  No application should ever call anything in the Internal namespace.</p>


	<p>I see that I added mpfTagList() in <a class="changeset" title="r1108 Recursively dump an image (exiv2 -pR file...)" href="/projects/exiv2/repository/exiv2/revisions/4165">r4165</a> in support of <a class="issue tracker-1 status-5 priority-4 priority-default closed" title="Bug: exiv2 output is inconsistent and seemingly random 1% of the time (Closed)" href="/issues/1105">#1105</a> and <a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Recursively dump sub-files of an image (Closed)" href="/issues/1108">#1108</a>, so I'm not denying that I am to blame.  Inspecting the code in src/tags.cpp, I don't see anything significantly different about iopTagList and mpfTagList.</p>


	<p>I don't understand your code <code>Exiv2::ExifKey(Exiv2::ExifData::Internal::mpfTagsList());</code>  What does that mean?  Why would you call that and what do you expect to happen.</p>


	<p>Can you help me to isolate this as I don't know what I'm looking for.</p></div>
    </div>
  </div>
  
  <div id="change-5822" class="journal has-notes has-details">
    <div id="note-4">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-4" class="journal-link">#4</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="08 Feb 2017 17:34" href="/projects/exiv2/activity?from=2017-02-08">almost 5 years</a> ago
      <span id="journal-5822-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Category</strong> set to <i>api</i></li>
       <li><strong>% Done</strong> changed from <i>0</i> to <i>30</i></li>
       <li><strong>Estimated time</strong> set to <i>3.00 h</i></li>
    </ul>
    <div id="journal-5822-notes" class="wiki"><p>I think I know what you're trying to do with: <pre>Exiv2::ExifKey(Exiv2::ExifData::Internal::mpfTagsList());</pre>Are you trying to call the constructor: <pre>Exiv2::ExifKey(const TagInfo&#38;)</pre>The compiler has converted the mpfTagList() pointer into a reference.  However, it's not a reference, it's a "C" array of TagInfo structures.</p></div>
    </div>
  </div>
  
  <div id="change-5824" class="journal has-notes">
    <div id="note-5">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-5" class="journal-link">#5</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/4748">Wil Cowb</a> <a title="08 Feb 2017 17:59" href="/projects/exiv2/activity?from=2017-02-08">almost 5 years</a> ago
      <span id="journal-5824-private_notes" class=""></span>
    </h4>

    <div id="journal-5824-notes" class="wiki"><p>Hello Robin,</p>


	<p>I cannot answer you questions since I am just a digiKam user however I am trying to get Gilles @ digiKam dev team here.<br />I am pretty sure you are correct about the API call but I would wait for Gilles to confirm.<br />Thanks a lot for your patience.</p>


	<p>Cheers,<br />Andrey</p></div>
    </div>
  </div>
  
  <div id="change-5825" class="journal has-notes">
    <div id="note-6">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-6" class="journal-link">#6</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/76">Gilles Caulier</a> <a title="08 Feb 2017 18:26" href="/projects/exiv2/activity?from=2017-02-08">almost 5 years</a> ago
      <span id="journal-5825-private_notes" class=""></span>
    </h4>

    <div id="journal-5825-notes" class="wiki"><p>The method in digiKam where Exiv2 exception is generated is this one :</p>


	<p><a class="external" href="https://cgit.kde.org/digikam.git/tree/libs/dmetadata/metaengine_exif.cpp#n1068">https://cgit.kde.org/digikam.git/tree/libs/dmetadata/metaengine_exif.cpp#n1068</a></p>


	<p>especially in line :</p>


	<p><a class="external" href="https://cgit.kde.org/digikam.git/tree/libs/dmetadata/metaengine_exif.cpp#n1105">https://cgit.kde.org/digikam.git/tree/libs/dmetadata/metaengine_exif.cpp#n1105</a></p>


	<p>The goal of this function is to populate a map of Exif tags recognized by Exiv2 and to fill a list view in GUI to let's user to filter tags to show in Exif tags viewer.</p>


	<p>This code in line 1105 work as expected with all Exif tags, excepted from MPF Exif group. The expected result must be the same for all Exif tags group...</p>


	<p>My patch in digiKam ignore MPF group until Exiv2 is patched.</p>


	<p>Gilles Caulier</p></div>
    </div>
  </div>
  
  <div id="change-5826" class="journal has-notes has-details">
    <div id="note-7">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-7" class="journal-link">#7</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="08 Feb 2017 19:05" href="/projects/exiv2/activity?from=2017-02-08">almost 5 years</a> ago
      <span id="journal-5826-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>% Done</strong> changed from <i>30</i> to <i>50</i></li>
    </ul>
    <div id="journal-5826-notes" class="wiki"><p>This team-work stuff really works.  Well done, everybody.  I know exactly what you're doing and there is something wrong here.  I'm working on it.</p>


	<p>Gilles: Your "band-aid" is sufficient to avoid my crasher, however you won't need it for long.  I hope to fix this within an hour.</p></div>
    </div>
  </div>
  
  <div id="change-5827" class="journal has-notes">
    <div id="note-8">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-8" class="journal-link">#8</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="08 Feb 2017 20:11" href="/projects/exiv2/activity?from=2017-02-08">almost 5 years</a> ago
      <span id="journal-5827-private_notes" class=""></span>
    </h4>

    <div id="journal-5827-notes" class="wiki"><p>Fix submitted <a class="changeset" title="#1275 Fix submitted." href="/projects/exiv2/repository/exiv2/revisions/4704">r4704</a>.  Gilles: Can you confirm that works for you and I'll close this.</p></div>
    </div>
  </div>
  
  <div id="change-5828" class="journal has-notes">
    <div id="note-9">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-9" class="journal-link">#9</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/76">Gilles Caulier</a> <a title="08 Feb 2017 20:33" href="/projects/exiv2/activity?from=2017-02-08">almost 5 years</a> ago
      <span id="journal-5828-private_notes" class=""></span>
    </h4>

    <div id="journal-5828-notes" class="wiki"><p>[gilles@localhost exiv2]$ svn info<br />Path: .<br />Working Copy Root Path: /home/gilles/Devel/exiv2<br />URL: svn://dev.exiv2.org/svn/trunk<br />Relative URL: ^/trunk<br />Repository Root: svn://dev.exiv2.org/svn<br />Repository UUID: b7c8b350-86e7-0310-a4b4-de8f6a8f16a3<br />Revision: 4704<br />Node Kind: directory<br />Schedule: normal<br />Last Changed Author: robinwmills<br />Last Changed Rev: 4704<br />Last Changed Date: 2017-02-08 21:10:01 +0100 (Wed, 08 Feb 2017)</p>


	<p>[gilles@localhost exiv2]$</p>


	<p>Scanning dependencies of target exiv2<br />[ 94%] Building CXX object src/CMakeFiles/exiv2.dir/exiv2.cpp.o<br />[ 95%] Building CXX object src/CMakeFiles/exiv2.dir/actions.cpp.o<br />/home/gilles/Devel/exiv2/src/actions.cpp: In member function ‘int Action::Print::printTag(const Exiv2::ExifData&#38;, Action::Print::EasyAccessFct, const string&#38;) const’:<br />/home/gilles/Devel/exiv2/src/actions.cpp:514:42: error: no matching function for call to ‘Exiv2::Exifdatum::write(std::ostream&#38;, const Exiv2::ExifData&#38;) const’<br />             md->write(std::cout, exifData);<br />                                          ^<br />In file included from /home/gilles/Devel/exiv2/include/exiv2/bmpimage.hpp:34:0,<br />                 from /home/gilles/Devel/exiv2/include/exiv2/exiv2.hpp:36,<br />                 from /home/gilles/Devel/exiv2/src/exiv2app.hpp:34,<br />                 from /home/gilles/Devel/exiv2/src/actions.hpp:40,<br />                 from /home/gilles/Devel/exiv2/src/actions.cpp:35:<br />/home/gilles/Devel/exiv2/include/exiv2/exif.hpp:182:23: note: candidate: virtual std::ostream&#38; Exiv2::Exifdatum::write(std::ostream&#38;, const Exiv2::ExifData*) const<br />         std::ostream&#38; write(std::ostream&#38; os, const ExifData* pMetadata =0) const;<br />                       ^<br />/home/gilles/Devel/exiv2/include/exiv2/exif.hpp:182:23: note:   no known conversion for argument 2 from ‘const Exiv2::ExifData’ to ‘const Exiv2::ExifData*’<br />src/CMakeFiles/exiv2.dir/build.make:86: recipe for target 'src/CMakeFiles/exiv2.dir/actions.cpp.o' failed<br />make<sup><a href="#fn2">2</a></sup>: <b>* [src/CMakeFiles/exiv2.dir/actions.cpp.o] Error 1<br />CMakeFiles/Makefile2:348: recipe for target 'src/CMakeFiles/exiv2.dir/all' failed<br />make<sup><a href="#fn1">1</a></sup>: <strong></b> [src/CMakeFiles/exiv2.dir/all] Error 2<br />Makefile:127: recipe for target 'all' failed<br />make: *</strong>* [all] Error 2</p></div>
    </div>
  </div>
  
  <div id="change-5829" class="journal has-notes has-details">
    <div id="note-10">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-10" class="journal-link">#10</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="08 Feb 2017 20:49" href="/projects/exiv2/activity?from=2017-02-08">almost 5 years</a> ago
      <span id="journal-5829-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>% Done</strong> changed from <i>50</i> to <i>80</i></li>
    </ul>
    <div id="journal-5829-notes" class="wiki"><p>I think you have a header file conflict.  I think you're compiling with the wrong set of include files for the source code.  Maybe you have 0.25 headers in /usr/include (or /usr/local/include) which are being used to compile the v0.26 code.</p></div>
    </div>
  </div>
  
  <div id="change-5830" class="journal has-notes">
    <div id="note-11">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-11" class="journal-link">#11</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/76">Gilles Caulier</a> <a title="08 Feb 2017 20:58" href="/projects/exiv2/activity?from=2017-02-08">almost 5 years</a> ago
      <span id="journal-5830-private_notes" class=""></span>
    </h4>

    <div id="journal-5830-notes" class="wiki"><p>You want mean that /usr/include/ files from older Exiv2 install are used to compile a new one. This must never happen... Only local headers must be used to compile local Exiv2 source code, else it's the hell to manage.</p>


	<p>To have compiled a lots of time eXiv2 since few month, it's the first time that i see this error.</p>


	<p>Gilles</p></div>
    </div>
  </div>
  
  <div id="change-5831" class="journal has-notes">
    <div id="note-12">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-12" class="journal-link">#12</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/76">Gilles Caulier</a> <a title="08 Feb 2017 21:00" href="/projects/exiv2/activity?from=2017-02-08">almost 5 years</a> ago
      <span id="journal-5831-private_notes" class=""></span>
    </h4>

    <div id="journal-5831-notes" class="wiki"><p>problem reproducible with a clean build directory and a re-configure from scratch (cmake)</p>


	<p>Gilles Caulier</p></div>
    </div>
  </div>
  
  <div id="change-5832" class="journal has-notes">
    <div id="note-13">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-13" class="journal-link">#13</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="08 Feb 2017 21:10" href="/projects/exiv2/activity?from=2017-02-08">almost 5 years</a> ago
      <span id="journal-5832-private_notes" class=""></span>
    </h4>

    <div id="journal-5832-notes" class="wiki"><p>I agree that this shouldn't happen.  However that is my diagnosis.  Perhaps you've only been compiling the library.  The message is arriving at the very end of the build when it's compiling/linking the sample applications including the exiv2(.exe) command-line program.</p>


	<p>It is rather odd, the compiler says the header is: <code>/home/gilles/Devel/exiv2/include/exiv2/exif.hpp</code>.  Perhaps you need to rebuild with something like: <pre>make clean ; make</pre></p>


	<p>The code is good.  I rebuild it frequently (with CMake and ./configure) and so does the build server.  I'll build it clean in the next few minutes.</p>


	<p>Can I access your machine with SSH and have a look?</p></div>
    </div>
  </div>
  
  <div id="change-5833" class="journal has-notes">
    <div id="note-14">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-14" class="journal-link">#14</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/76">Gilles Caulier</a> <a title="08 Feb 2017 21:13" href="/projects/exiv2/activity?from=2017-02-08">almost 5 years</a> ago
      <span id="journal-5833-private_notes" class=""></span>
    </h4>

    <div id="journal-5833-notes" class="wiki"><blockquote>

	<p>make clean ; make</p>


</blockquote>

	<p>==> I already cleaned build directory which is typically the best way to be sure that all is done from scratch.</p>


	<p>Gilles</p></div>
    </div>
  </div>
  
  <div id="change-5834" class="journal has-notes">
    <div id="note-15">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-15" class="journal-link">#15</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/76">Gilles Caulier</a> <a title="08 Feb 2017 21:15" href="/projects/exiv2/activity?from=2017-02-08">almost 5 years</a> ago
      <span id="journal-5834-private_notes" class=""></span>
    </h4>

    <div id="journal-5834-notes" class="wiki"><p>No ssh access here. There is a FW where i cannot admin to open a port...</p>


	<p>Gilles</p></div>
    </div>
  </div>
  
  <div id="change-5835" class="journal has-notes">
    <div id="note-16">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-16" class="journal-link">#16</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/76">Gilles Caulier</a> <a title="08 Feb 2017 21:17" href="/projects/exiv2/activity?from=2017-02-08">almost 5 years</a> ago
      <span id="journal-5835-private_notes" class=""></span>
    </h4>

    <div id="journal-5835-notes" class="wiki"><p>I take another VM and build is fine now. I don't know why build is broken on another one.</p>


	<p>Testing now.</p>


	<p>Gilles</p></div>
    </div>
  </div>
  
  <div id="change-5836" class="journal has-notes">
    <div id="note-17">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-17" class="journal-link">#17</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/76">Gilles Caulier</a> <a title="08 Feb 2017 21:21" href="/projects/exiv2/activity?from=2017-02-08">almost 5 years</a> ago
      <span id="journal-5836-private_notes" class=""></span>
    </h4>

    <div id="journal-5836-notes" class="wiki"><p>I just tested with you last patches, and this do not fix the problem :</p>


	<p>digikam.metaengine: Cannot get Exif Tags list using Exiv2   (Error # 23 :  Invalid ifdId 8</p>


	<p>The exception still here...</p>


	<p>Gilles</p></div>
    </div>
  </div>
  
  <div id="change-5837" class="journal has-notes">
    <div id="note-18">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-18" class="journal-link">#18</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="08 Feb 2017 21:38" href="/projects/exiv2/activity?from=2017-02-08">almost 5 years</a> ago
      <span id="journal-5837-private_notes" class=""></span>
    </h4>

    <div id="journal-5837-notes" class="wiki"><p>That's odd.  I added the following code (based on your code) to exiv2.cpp and it runs smoothly with the command <code>$ exiv2 -h </code>.  Here's the code:<pre>// *****************************************************************************
// Main
int main(int argc, char* const argv[])
{
#ifdef EXV_ENABLE_NLS
    setlocale(LC_ALL, "");
    bindtextdomain(EXV_PACKAGE, EXV_LOCALEDIR);
    textdomain(EXV_PACKAGE);
#endif

    const Exiv2::GroupInfo* gi = Exiv2::ExifTags::groupList();
    while (gi-&gt;tagList_ != 0)
    {
        Exiv2::TagListFct tl     = gi-&gt;tagList_;
        const Exiv2::TagInfo* ti = tl();

        while (ti-&gt;tag_ != 0xFFFF)
        {
            std::cout &lt;&lt; ti-&gt;title_ &lt;&lt; std::endl;
            ++ti;
        }
        ++gi;
    }
</pre>And here's the output from my build (done with CMake/Xcode on the Mac):<pre>720 rmills@rmillsmbp:~/gnu/exiv2/trunk/build $ bin/Debug/exiv2 -h | grep MPF
MPFVersion
MPFNumberOfImages
MPFImageList
MPFImageUIDList    
MPFTotalFrames
MPFIndividualNum
MPFPanOrientation
MPFPanOverlapH
MPFPanOverlapV
MPFBaseViewpointNum
MPFConvergenceAngle
MPFBaselineLength
MPFVerticalDivergence
MPFAxisDistanceX
MPFAxisDistanceY
MPFAxisDistanceZ
MPFYawAngle
MPFPitchAngle
MPFRollAngle
721 rmills@rmillsmbp:~/gnu/exiv2/trunk/build $ </pre></p></div>
    </div>
  </div>
  
  <div id="change-5838" class="journal has-notes has-details">
    <div id="note-19">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-19" class="journal-link">#19</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="09 Feb 2017 05:17" href="/projects/exiv2/activity?from=2017-02-09">almost 5 years</a> ago
      <span id="journal-5838-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Estimated time</strong> changed from <i>3.00 h</i> to <i>5.00 h</i></li>
    </ul>
    <div id="journal-5838-notes" class="wiki"><p>I've submitted a fix for this: <a class="changeset" title="#1275 Fix issue with Exiv2::Key.familyName() for key.ifdId_ == mpfId" href="/projects/exiv2/repository/exiv2/revisions/4705">r4705</a></p>


	<p>The modified code in exiv2.cpp <em>(which will not be submitted)</em> is:<pre>// *****************************************************************************
// Main
int main(int argc, char* const argv[])
{
#ifdef EXV_ENABLE_NLS
    setlocale(LC_ALL, "");
    bindtextdomain(EXV_PACKAGE, EXV_LOCALEDIR);
    textdomain(EXV_PACKAGE);
#endif

    // #1275
    const Exiv2::GroupInfo* gi = Exiv2::ExifTags::groupList();
    while (gi-&gt;tagList_ != 0)
    {
        Exiv2::TagListFct tl     = gi-&gt;tagList_;
        const Exiv2::TagInfo* ti = tl();

        while (ti-&gt;tag_ != 0xFFFF)
        {
            Exiv2::ExifKey key(*ti);
            std::cout &lt;&lt; key.familyName() &lt;&lt; "." 
                      &lt;&lt; key.groupName()  &lt;&lt; "." 
                      &lt;&lt; key.tagName()    &lt;&lt; std::endl;
            ++ti;
        }
        ++gi;
    }
    if ( argc == 1 ) exit(0);</pre>And here it's working:<pre>768 rmills@rmillsmbp:~/gnu/exiv2/trunk $ build/bin/Debug/exiv2 | grep MPF
Exif.MpfInfo.MPFVersion
Exif.MpfInfo.MPFNumberOfImages
Exif.MpfInfo.MPFImageList
Exif.MpfInfo.MPFImageUIDList
Exif.MpfInfo.MPFTotalFrames
Exif.MpfInfo.MPFIndividualNum
Exif.MpfInfo.MPFPanOrientation
Exif.MpfInfo.MPFPanOverlapH
Exif.MpfInfo.MPFPanOverlapV
Exif.MpfInfo.MPFBaseViewpointNum
Exif.MpfInfo.MPFConvergenceAngle
Exif.MpfInfo.MPFBaselineLength
Exif.MpfInfo.MPFVerticalDivergence
Exif.MpfInfo.MPFAxisDistanceX
Exif.MpfInfo.MPFAxisDistanceY
Exif.MpfInfo.MPFAxisDistanceZ
Exif.MpfInfo.MPFYawAngle
Exif.MpfInfo.MPFPitchAngle
Exif.MpfInfo.MPFRollAngle
769 rmills@rmillsmbp:~/gnu/exiv2/trunk $ </pre></p></div>
    </div>
  </div>
  
  <div id="change-5839" class="journal has-notes has-details">
    <div id="note-20">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-20" class="journal-link">#20</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/76">Gilles Caulier</a> <a title="09 Feb 2017 16:19" href="/projects/exiv2/activity?from=2017-02-09">almost 5 years</a> ago
      <span id="journal-5839-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>Assigned</i> to <i>Resolved</i></li>
       <li><strong>% Done</strong> changed from <i>80</i> to <i>100</i></li>
    </ul>
    <div id="journal-5839-notes" class="wiki"><p>I recompile all digiKam and i confirm that commit #4705 fix the problem.</p>


	<p>Gilles</p></div>
    </div>
  </div>
  
  <div id="change-5840" class="journal has-notes has-details">
    <div id="note-21">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-21" class="journal-link">#21</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="09 Feb 2017 18:24" href="/projects/exiv2/activity?from=2017-02-09">almost 5 years</a> ago
      <span id="journal-5840-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>Resolved</i> to <i>Closed</i></li>
    </ul>
    <div id="journal-5840-notes" class="wiki"><p>Thanks for letting me know, Gilles.  I'm going to close this issue.</p></div>
    </div>
  </div>
  
  <div id="change-5882" class="journal has-details">
    <div id="note-22">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-22" class="journal-link">#22</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="09 Mar 2017 19:59" href="/projects/exiv2/activity?from=2017-03-09">over 4 years</a> ago
      <span id="journal-5882-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Assignee</strong> changed from <i>Robin Mills</i> to <i>Gilles Caulier</i></li>
    </ul>
    
    </div>
  </div>
  
  <div id="change-5910" class="journal has-details">
    <div id="note-23">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-23" class="journal-link">#23</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="13 Mar 2017 11:38" href="/projects/exiv2/activity?from=2017-03-13">over 4 years</a> ago
      <span id="journal-5910-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Assignee</strong> changed from <i>Gilles Caulier</i> to <i>Robin Mills</i></li>
    </ul>
    
    </div>
  </div>
  


</div>

<div style="clear: both;"></div>
<div class="contextual">





</div>


<div style="clear: both;"></div>


<p class="other-formats">Also available in:  <span><a class="atom" rel="nofollow" href="/issues/1275.atom">Atom</a></span>
  <span><a class="pdf" rel="nofollow" href="/issues/1275.pdf">PDF</a></span>
</p>





        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
