<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Feature #816: Enable detection of Sigma 55-200mm lens - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="7T1cwBzl14yNfrFpwsm/LXObS11CFAzMOY2JwIWrC0QPcPcvbp8bjNgarmV9HrMeTAkfJLP3rXbErRlIxpLsKw==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
    <link rel="alternate" type="application/atom+xml" title="Exiv2 - Feature #816: Enable detection of Sigma 55-200mm lens" href="https://dev.exiv2.org/issues/816.atom" />
<script src="/javascripts/context_menu.js?1550767427"></script><link rel="stylesheet" media="screen" href="/stylesheets/context_menu.css?1550767427" /></head>
<body class="project-exiv2 has-main-menu controller-issues action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="issues" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="issues" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=issues" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=issues">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues selected" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="">
    <div id="sidebar">
          <h3>Issues</h3>

<ul>
<li><a href="/projects/exiv2/issues?set_filter=1">View all issues</a></li>
<li><a href="/projects/exiv2/issues/report">Summary</a></li>

</ul>









        
    </div>

    <div id="content">
        
        <div class="contextual">





</div>


<h2>Feature #816</h2>

<div class="issue tracker-2 status-5 priority-4 priority-default closed details">

  <div class="gravatar-with-child">
    
    
  </div>

<div class="subject">
<div><h3>Enable detection of Sigma 55-200mm lens</h3></div>
</div>
        <p class="author">
        Added by <a class="user active" href="/users/3328">Simon Harhues</a> <a title="18 Mar 2012 15:39" href="/projects/exiv2/activity?from=2012-03-18">over 9 years</a> ago.
        Updated <a title="13 Jan 2016 19:15" href="/projects/exiv2/activity?from=2016-01-13">almost 6 years</a> ago.
        </p>

<div class="attributes">
<div class="splitcontent"><div class="splitcontentleft"><div class="status attribute"><div class="label">Status:</div><div class="value">Closed</div></div><div class="priority attribute"><div class="label">Priority:</div><div class="value">Normal</div></div><div class="assigned-to attribute"><div class="label">Assignee:</div><div class="value"><a class="user active" href="/users/119">Robin Mills</a></div></div><div class="category attribute"><div class="label">Category:</div><div class="value">lens</div></div><div class="fixed-version attribute"><div class="label">Target version:</div><div class="value"><a title="28 Apr 2017" href="/versions/52">0.26</a></div></div></div><div class="splitcontentleft"><div class="start-date attribute"><div class="label">Start date:</div><div class="value">18 Mar 2012</div></div><div class="due-date attribute"><div class="label">Due date:</div><div class="value"></div></div><div class="progress attribute"><div class="label">% Done:</div><div class="value"><table class="progress progress-100"><tr><td style="width: 100%;" class="closed" title="100%"></td></tr></table><p class="percent">100%</p></div></div><div class="estimated-hours attribute"><div class="label">Estimated time:</div><div class="value">17.00 h</div></div></div></div>


</div>

<hr />
<div class="description">
  <div class="contextual">
  
  </div>

  <p><strong>Description</strong></p>
  <div class="wiki">
  <p>exiv2 doesn't detect my Sigma lens right.<br />Following output:</p>


	<p>simon@laptop:~/fotos$ exiv2 -pt 12-03-05_thinkpad_tastatur/IMGP4432.PEF | grep -i lens<br />Exif.Pentax.LensType                         Byte        2  SIGMA<br />Exif.Pentax.LensInfo                         Undefined  36  3 255 0 0 40 148 71 152 80 6 241 65 237 153 88 36 1 76 107 251 255 255 255 0 0 80 6 241 0 0 0 0 0 0 0 0</p>


	<p>simon@laptop:~/fotos$ exiftool 12-03-05_thinkpad_tastatur/IMGP4432.PEF | grep -i lens<br />Lens Type                       : Sigma Lens (3 255)<br />Lens F Stops                    : 8.5<br />Lens ID                         : Sigma 55-200mm F4-5.6 DC</p>


	<p>I'll will attach the raw file if you need more information.</p>
  </div>
</div>
  <hr />
  <p><strong>Files</strong></p>
  <div class="attachments">
<div class="contextual">
  
</div>
<table>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/326">IMGP4432.PEF</a>    <span class="size">(9.96 MB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/326/IMGP4432.PEF">IMGP4432.PEF</a>  </td>
  <td>raw file taken with a Sigma 55-200mm lens</td>
  <td>
      <span class="author">Simon Harhues, 18 Mar 2012 15:39</span>
  </td>
  <td>
  </td>
</tr>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/328">pentaxmn.cpp.diff</a>    <span class="size">(12.1 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/328/pentaxmn.cpp.diff">pentaxmn.cpp.diff</a>  </td>
  <td></td>
  <td>
      <span class="author">Abhinav Badola, 26 Mar 2012 14:19</span>
  </td>
  <td>
  </td>
</tr>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/330">pentaxmn.cpp.diff2</a>    <span class="size">(14.1 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/330/pentaxmn.cpp.diff2">pentaxmn.cpp.diff2</a>  </td>
  <td></td>
  <td>
      <span class="author">Abhinav Badola, 13 Apr 2012 13:17</span>
  </td>
  <td>
  </td>
</tr>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/331">pentaxmn.cpp.diff3</a>    <span class="size">(13.6 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/331/pentaxmn.cpp.diff3">pentaxmn.cpp.diff3</a>  </td>
  <td></td>
  <td>
      <span class="author">Abhinav Badola, 15 Apr 2012 04:21</span>
  </td>
  <td>
  </td>
</tr>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/335">pentaxmn.cpp.diff4</a>    <span class="size">(14.1 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/335/pentaxmn.cpp.diff4">pentaxmn.cpp.diff4</a>  </td>
  <td></td>
  <td>
      <span class="author">Abhinav Badola, 25 Apr 2012 22:14</span>
  </td>
  <td>
  </td>
</tr>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/858">_IGP9032.DNG</a>    <span class="size">(16 MB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/858/_IGP9032.DNG">_IGP9032.DNG</a>  </td>
  <td>DNG K10 Sigma 55-200</td>
  <td>
      <span class="author">Simon Harhues, 12 Nov 2015 22:02</span>
  </td>
  <td>
  </td>
</tr>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/859">_IGP9033.PEF</a>    <span class="size">(11.8 MB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/859/_IGP9033.PEF">_IGP9033.PEF</a>  </td>
  <td>PEF K10 Sigma 55-200</td>
  <td>
      <span class="author">Simon Harhues, 12 Nov 2015 22:02</span>
  </td>
  <td>
  </td>
</tr>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/860">_IGP9034.JPG</a>    <span class="size">(3.09 MB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/860/_IGP9034.JPG">_IGP9034.JPG</a>  </td>
  <td>JPEG K10 Sigma 55-200</td>
  <td>
      <span class="author">Simon Harhues, 12 Nov 2015 22:02</span>
  </td>
  <td>
  </td>
</tr>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/868">IMGP2221.JPG</a>    <span class="size">(9.36 MB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/868/IMGP2221.JPG">IMGP2221.JPG</a>  </td>
  <td>example picture with Pentax K3</td>
  <td>
      <span class="author">Simon Harhues, 20 Dec 2015 20:15</span>
  </td>
  <td>
  </td>
</tr>
</table>
</div>







<hr />
<div id="relations">
<div class="contextual">
</div>

<p><strong>Related issues</strong></p>

<form data-cm-url="/issues/context_menu" action="/issues/816" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="RBRUIyVeRIf/IEwR/IYatGQCN/DTBEmrgYCGk93lXRSmWf/MVySIh6pEUx1DURaHW5BjiSLn6BF8oBYbnty6ew==" />
  <table class="list issues odd-even"><tr id="relation-191" class="issue hascontextmenu issue tracker-1 status-5 priority-4 priority-default closed"><td class="checkbox"><input type="checkbox" name="ids[]" value="1143" /></td><td class="subject" style="width: 50%">Related to Exiv2 - <a class="issue tracker-1 status-5 priority-4 priority-default closed" href="/issues/1143">Bug #1143</a>: Unable to extract embedded preview from jpg for Sony a77</td><td class="status">Closed</td><td class="start_date">24 Dec 2015</td><td class="due_date"></td><td class="done_ratio"><table class="progress progress-100"><tr><td style="width: 100%;" class="closed" title="100%"></td></tr></table><p class="percent"></p></td><td class="buttons"><a title="Actions" class="icon-only icon-actions js-contextmenu" href="#">Actions</a></td></tr><tr id="relation-194" class="issue hascontextmenu issue tracker-2 status-5 priority-4 priority-default closed"><td class="checkbox"><input type="checkbox" name="ids[]" value="1145" /></td><td class="subject" style="width: 50%">Related to Exiv2 - <a class="issue tracker-2 status-5 priority-4 priority-default closed" href="/issues/1145">Feature #1145</a>: Respect Sony/Minolta lenses with shared LensID such as Tamron SP AF 17-50mm F2.8 XR Di II LD</td><td class="status">Closed</td><td class="start_date">27 Dec 2015</td><td class="due_date"></td><td class="done_ratio"><table class="progress progress-100"><tr><td style="width: 100%;" class="closed" title="100%"></td></tr></table><p class="percent"></p></td><td class="buttons"><a title="Actions" class="icon-only icon-actions js-contextmenu" href="#">Actions</a></td></tr></table>
</form>
<form class="new_relation" id="new-relation-form" style="display: none;" action="/issues/816/relations" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" />


<p><select onchange="setPredecessorFieldsVisibility();" name="relation[relation_type]" id="relation_relation_type"><option selected="selected" value="relates">Related to</option>
<option value="duplicates">Is duplicate of</option>
<option value="duplicated">Has duplicate</option>
<option value="blocks">Blocks</option>
<option value="blocked">Blocked by</option>
<option value="precedes">Precedes</option>
<option value="follows">Follows</option>
<option value="copied_to">Copied to</option>
<option value="copied_from">Copied from</option></select>
Issue #<input size="10" type="text" name="relation[issue_to_id]" id="relation_issue_to_id" />
<span id="predecessor_fields" style="display:none;">
Delay: <input size="3" type="text" name="relation[delay]" id="relation_delay" /> days
</span>
<input type="submit" name="commit" value="Add" data-disable-with="Add" />
<a href="#" onclick="$(&quot;#new-relation-form&quot;).hide();; return false;">Cancel</a>
</p>

<script>
//<![CDATA[
observeAutocompleteField('relation_issue_to_id', '/issues/auto_complete?issue_id=816&project_id=exiv2&scope=all')
//]]>
</script>

<script>
//<![CDATA[
setPredecessorFieldsVisibility();
//]]>
</script>

</form>
</div>

</div>

<div id="issue-changesets">
<h3>Associated revisions</h3>
    <div class="changeset">
    <p><a title="Revision 4012" href="/projects/exiv2/repository/exiv2/revisions/4012">Revision 4012</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/4012/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="11 Nov 2015 10:25" href="/projects/exiv2/activity?from=2015-11-11">about 6 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p><a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Enable detection of Sigma 55-200mm lens (Closed)" href="/issues/816">#816</a>.  This is the framework from Abhinav's patch from which we can derive the fix.  Explanation in issue report.</p>
    </div>
    </div>
    <div class="changeset">
    <p><a title="Revision 4013" href="/projects/exiv2/repository/exiv2/revisions/4013">Revision 4013</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/4013/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="11 Nov 2015 20:54" href="/projects/exiv2/activity?from=2015-11-11">about 6 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p><a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Enable detection of Sigma 55-200mm lens (Closed)" href="/issues/816">#816</a>  Added Phil's Perl code PrintLensID (see issue report).  I'll have to convert this into C++ and then report the output.</p>
    </div>
    </div>
    <div class="changeset">
    <p><a title="Revision 4014" href="/projects/exiv2/repository/exiv2/revisions/4014">Revision 4014</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/4014/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="11 Nov 2015 21:11" href="/projects/exiv2/activity?from=2015-11-11">about 6 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p><a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Enable detection of Sigma 55-200mm lens (Closed)" href="/issues/816">#816</a>.  Correction to 4012.  Fix msvc build breaker</p>
    </div>
    </div>
    <div class="changeset">
    <p><a title="Revision 4016" href="/projects/exiv2/repository/exiv2/revisions/4016">Revision 4016</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/4016/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="12 Nov 2015 11:20" href="/projects/exiv2/activity?from=2015-11-12">about 6 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p><a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Enable detection of Sigma 55-200mm lens (Closed)" href="/issues/816">#816</a>.  Fix submitted.  Will ask Simon to test this ask his permission to use his metadata in the test suite.</p>
    </div>
    </div>
    <div class="changeset">
    <p><a title="Revision 4018" href="/projects/exiv2/repository/exiv2/revisions/4018">Revision 4018</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/4018/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="13 Nov 2015 18:43" href="/projects/exiv2/activity?from=2015-11-13">about 6 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p><a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Enable detection of Sigma 55-200mm lens (Closed)" href="/issues/816">#816</a>.  Fix submitted.  Thank you Simon for working with me on this and for providing test files.</p>
    </div>
    </div>
    <div class="changeset">
    <p><a title="Revision 4019" href="/projects/exiv2/repository/exiv2/revisions/4019">Revision 4019</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/4019/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="13 Nov 2015 19:32" href="/projects/exiv2/activity?from=2015-11-13">about 6 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p><a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Enable detection of Sigma 55-200mm lens (Closed)" href="/issues/816">#816</a>  Correction to <a class="changeset" title="#816.  Fix submitted.  Thank you Simon for working with me on this and for providing test files." href="/projects/exiv2/repository/exiv2/revisions/4018">r4018</a> to deal with segmentation fault on test file _IGP9034.JPG</p>
    </div>
    </div>
    <div class="changeset">
    <p><a title="Revision 4135" href="/projects/exiv2/repository/exiv2/revisions/4135">Revision 4135</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/4135/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="20 Dec 2015 21:31" href="/projects/exiv2/activity?from=2015-12-20">almost 6 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p><a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Enable detection of Sigma 55-200mm lens (Closed)" href="/issues/816">#816</a>.  Fix for Pentax K-3 Camera.</p>
    </div>
    </div>
    <div class="changeset">
    <p><a title="Revision 4136" href="/projects/exiv2/repository/exiv2/revisions/4136">Revision 4136</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/4136/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="21 Dec 2015 17:23" href="/projects/exiv2/activity?from=2015-12-21">almost 6 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p><a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Enable detection of Sigma 55-200mm lens (Closed)" href="/issues/816">#816</a>.  Correction to msvc buildbreaker in <a class="changeset" title="#816.  Fix for Pentax K-3 Camera." href="/projects/exiv2/repository/exiv2/revisions/4135">r4135</a></p>
    </div>
    </div>

</div>



<div id="history">
<h3>History</h3>
  <div id="change-2090" class="journal has-details">
    <div id="note-1">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-1" class="journal-link">#1</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="20 Mar 2012 19:28" href="/projects/exiv2/activity?from=2012-03-20">over 9 years</a> ago
      <span id="journal-2090-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Category</strong> set to <i>metadata</i></li>
       <li><strong>Assignee</strong> set to <i>Abhinav Badola</i></li>
       <li><strong>Target version</strong> set to <i>0.23</i></li>
    </ul>
    
    </div>
  </div>
  
  <div id="change-2093" class="journal has-notes has-details">
    <div id="note-2">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-2" class="journal-link">#2</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/3290">Abhinav Badola</a> <a title="26 Mar 2012 14:19" href="/projects/exiv2/activity?from=2012-03-26">over 9 years</a> ago
      <span id="journal-2093-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>File</strong> <a href="/attachments/328">pentaxmn.cpp.diff</a> <a class="icon-only icon-download" title="Download" href="/attachments/download/328/pentaxmn.cpp.diff">pentaxmn.cpp.diff</a> added</li>
    </ul>
    <div id="journal-2093-notes" class="wiki"><p>I tried but was not able to crack the mechanism to detect the proper LensInfo.<br />For now this is a patch in which I have added all the lens listed in the exiftool Pentax information.</p></div>
    </div>
  </div>
  
  <div id="change-2100" class="journal has-notes has-details">
    <div id="note-3">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-3" class="journal-link">#3</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/3290">Abhinav Badola</a> <a title="13 Apr 2012 13:17" href="/projects/exiv2/activity?from=2012-04-13">over 9 years</a> ago
      <span id="journal-2100-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>File</strong> <a href="/attachments/330">pentaxmn.cpp.diff2</a> <a class="icon-only icon-download" title="Download" href="/attachments/download/330/pentaxmn.cpp.diff2">pentaxmn.cpp.diff2</a> added</li>
    </ul>
    <div id="journal-2100-notes" class="wiki"><p>Here is another updated patch to the same issue. I have called a function "printPentaxLensType" for handling, additional lens information. As such the framework is still incomplete, so it still needs some more work to be done later.</p></div>
    </div>
  </div>
  
  <div id="change-2101" class="journal has-notes has-details">
    <div id="note-4">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-4" class="journal-link">#4</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/3290">Abhinav Badola</a> <a title="15 Apr 2012 04:21" href="/projects/exiv2/activity?from=2012-04-15">over 9 years</a> ago
      <span id="journal-2101-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>File</strong> <a href="/attachments/331">pentaxmn.cpp.diff3</a> <a class="icon-only icon-download" title="Download" href="/attachments/download/331/pentaxmn.cpp.diff3">pentaxmn.cpp.diff3</a> added</li>
    </ul>
    <div id="journal-2101-notes" class="wiki"><p>A revised patch.</p></div>
    </div>
  </div>
  
  <div id="change-2103" class="journal has-details">
    <div id="note-5">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-5" class="journal-link">#5</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="20 Apr 2012 20:58" href="/projects/exiv2/activity?from=2012-04-20">over 9 years</a> ago
      <span id="journal-2103-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Target version</strong> deleted (<del><i>0.23</i></del>)</li>
    </ul>
    
    </div>
  </div>
  
  <div id="change-2110" class="journal has-notes has-details">
    <div id="note-6">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-6" class="journal-link">#6</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/3290">Abhinav Badola</a> <a title="25 Apr 2012 22:14" href="/projects/exiv2/activity?from=2012-04-25">over 9 years</a> ago
      <span id="journal-2110-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>File</strong> <a href="/attachments/335">pentaxmn.cpp.diff4</a> <a class="icon-only icon-download" title="Download" href="/attachments/download/335/pentaxmn.cpp.diff4">pentaxmn.cpp.diff4</a> added</li>
    </ul>
    <div id="journal-2110-notes" class="wiki"><p>Added another function resolvePentaxLensType, to print/detect correct lens.</p></div>
    </div>
  </div>
  
  <div id="change-2589" class="journal has-notes has-details">
    <div id="note-7">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-7" class="journal-link">#7</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="24 Jul 2013 16:06" href="/projects/exiv2/activity?from=2013-07-24">over 8 years</a> ago
      <span id="journal-2589-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>New</i> to <i>Assigned</i></li>
       <li><strong>Target version</strong> set to <i>0.25</i></li>
    </ul>
    <div id="journal-2589-notes" class="wiki"><p>Deferred for 0.25</p></div>
    </div>
  </div>
  
  <div id="change-3560" class="journal has-notes">
    <div id="note-8">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-8" class="journal-link">#8</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="28 Apr 2015 13:23" href="/projects/exiv2/activity?from=2015-04-28">over 6 years</a> ago
      <span id="journal-3560-private_notes" class=""></span>
    </h4>

    <div id="journal-3560-notes" class="wiki"><p>Abhinav</p>


	<p>I think you have dealt with this - however the code isn't in the repos.<pre>626 rmills@rmillsmbp:~/gnu/exiv2/trunk/samples $ exiv2 -pa -g Lens ~/Downloads/IMGP4432.PEF 
Exif.Pentax.LensType                         Byte        2  Sigma Lens
Exif.Pentax.LensInfo                         Undefined  36  3 255 0 0 40 ...
627 rmills@rmillsmbp:~/gnu/exiv2/trunk/samples $ </pre>I see you've provided 4 patches.  I'm not sure if they are to be applied one at a time or if the 4th is all that is required.</p>


	<p>Perhaps you could revisit this and submit what's required to the trunk <em>and</em> add a test to test/bugfixes-test.sh  Thanks.</p></div>
    </div>
  </div>
  
  <div id="change-3781" class="journal has-details">
    <div id="note-9">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-9" class="journal-link">#9</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/4035">Alan Pater</a> <a title="02 Jun 2015 23:11" href="/projects/exiv2/activity?from=2015-06-02">over 6 years</a> ago
      <span id="journal-3781-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Category</strong> changed from <i>metadata</i> to <i>lens</i></li>
       <li><strong>Target version</strong> changed from <i>0.25</i> to <i>0.26</i></li>
    </ul>
    
    </div>
  </div>
  
  <div id="change-4444" class="journal has-notes">
    <div id="note-10">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-10" class="journal-link">#10</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/3328">Simon Harhues</a> <a title="10 Nov 2015 10:42" href="/projects/exiv2/activity?from=2015-11-10">about 6 years</a> ago
      <span id="journal-4444-private_notes" class=""></span>
    </h4>

    <div id="journal-4444-notes" class="wiki"><p>Just wanted to ask for the current state as I still use the lens... :)</p></div>
    </div>
  </div>
  
  <div id="change-4445" class="journal has-notes has-details">
    <div id="note-11">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-11" class="journal-link">#11</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="10 Nov 2015 13:18" href="/projects/exiv2/activity?from=2015-11-10">about 6 years</a> ago
      <span id="journal-4445-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Assignee</strong> changed from <i>Abhinav Badola</i> to <i>Robin Mills</i></li>
    </ul>
    <div id="journal-4445-notes" class="wiki"><p>Simon</p>


	<p>I'm very surprised we haven't dealt with this.  It has inexplicably "slipped over the side".  My apologies.  The output from exiv2 is still the same as I reported 7 months ago.  I see exiftool knows about this:<pre>517 rmills@rmillsmbp:~/Downloads $ exiftool IMGP4432.PEF | grep Lens
Lens Type                       : Sigma Lens (3 255)
Lens F Stops                    : 8.5
Lens Focal Length               : 147.5 mm
Lens ID                         : Sigma 55-200mm F4-5.6 DC
518 rmills@rmillsmbp:~/Downloads $ </pre></p>


	<p>Our team member who dealt with makernotes has returned to college and I've agreed to deal with makernotes.  There's quite a learning curve for me, so I ask for your patience while I work on this.</p></div>
    </div>
  </div>
  
  <div id="change-4446" class="journal has-notes">
    <div id="note-12">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-12" class="journal-link">#12</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/3328">Simon Harhues</a> <a title="10 Nov 2015 14:42" href="/projects/exiv2/activity?from=2015-11-10">about 6 years</a> ago
      <span id="journal-4446-private_notes" class=""></span>
    </h4>

    <div id="journal-4446-notes" class="wiki"><p>Robin, Thanks for your kind reply. Looking forward to be able to use it in darktable (automatically) one day.</p></div>
    </div>
  </div>
  
  <div id="change-4447" class="journal has-notes">
    <div id="note-13">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-13" class="journal-link">#13</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="10 Nov 2015 15:04" href="/projects/exiv2/activity?from=2015-11-10">about 6 years</a> ago
      <span id="journal-4447-private_notes" class=""></span>
    </h4>

    <div id="journal-4447-notes" class="wiki"><p>Simon</p>


	<p>I'm working on it right now.  Abhinav provided a patch a couple of years ago for this.  It's totally non-trivial patch.  I'm going to get it to work against the code at that time, then figure out how to drag it into the current code base.</p></div>
    </div>
  </div>
  
  <div id="change-4448" class="journal has-notes">
    <div id="note-14">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-14" class="journal-link">#14</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/3328">Simon Harhues</a> <a title="10 Nov 2015 15:22" href="/projects/exiv2/activity?from=2015-11-10">about 6 years</a> ago
      <span id="journal-4448-private_notes" class=""></span>
    </h4>

    <div id="journal-4448-notes" class="wiki"><p>Thanks for your effort! :)</p></div>
    </div>
  </div>
  
  <div id="change-4449" class="journal has-notes">
    <div id="note-15">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-15" class="journal-link">#15</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="10 Nov 2015 16:38" href="/projects/exiv2/activity?from=2015-11-10">about 6 years</a> ago
      <span id="journal-4449-private_notes" class=""></span>
    </h4>

    <div id="journal-4449-notes" class="wiki"><p>Ungood news.  I've applied the patch to <a class="changeset" title="updating for 0.23" href="/projects/exiv2/repository/exiv2/revisions/2718">r2718</a> (v0.23)  and here's the output:<pre>565 rmills@rmillsmbp:~/gnu/exiv2/trunk.2718 $ exiv2 -V
exiv2 0.23 001700 (64 bit build)
Copyright (C) 2004-2012 Andreas Huggel.

This program is .... deleted ....
Boston, MA 02110-1301 USA
566 rmills@rmillsmbp:~/gnu/exiv2/trunk.2718 $ exiv2 -pa ~/Downloads/IMGP4432.PEF | grep Lens
Exif.Pentax.LensType                         Byte        2  SIGMA
Exif.Pentax.LensInfo                         Undefined  36  3 255 0 0 40 ...
567 rmills@rmillsmbp:~/gnu/exiv2/trunk.2718 $ svn info .
Path: .
Working Copy Root Path: /Users/rmills/gnu/exiv2/trunk.2718
URL: svn://dev.exiv2.org/svn/trunk
Relative URL: ^/trunk
Repository Root: svn://dev.exiv2.org/svn
Repository UUID: b7c8b350-86e7-0310-a4b4-de8f6a8f16a3
Revision: 2718
Node Kind: directory
Schedule: normal
Last Changed Author: robinwmills
Last Changed Rev: 2718
Last Changed Date: 2012-04-22 08:21:02 +0100 (Sun, 22 Apr 2012)
568 rmills@rmillsmbp:~/gnu/exiv2/trunk.2718 $ </pre>For sure, I'm not going to retrofit a 3 year old complex patch with unknown side effects.  I'm going to have to put on my scuba kit, dive in and figure how this code works.  Then I will fix it "properly".</p>


	<p>Oh, how I miss Niels.  He was such a great pair of hands in dealing with MakerNotes.</p>


	<p>The patch calls Abhinav's new function printPentaxLensType().  For sure there's something to debug here.  There's always hope!</p></div>
    </div>
  </div>
  
  <div id="change-4450" class="journal has-notes">
    <div id="note-16">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-16" class="journal-link">#16</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="10 Nov 2015 20:18" href="/projects/exiv2/activity?from=2015-11-10">about 6 years</a> ago
      <span id="journal-4450-private_notes" class=""></span>
    </h4>

    <div id="journal-4450-notes" class="wiki"><p>I've made good progress with this.  The reason for this issue is that there are many lenses which share the same ID (0x03ff) in pentaxmn.cpp#756<pre>        { 0x03ff, "Sigma Lens" },                    //0
        { 0x03ff, "Sigma 18-200mm F3.5-6.3 DC" },            //1
        { 0x03ff, "Sigma DL-II 35-80mm F4-5.6" },            //2
        { 0x03ff, "Sigma DL Zoom 75-300mm F4-5.6" },            //3
        { 0x03ff, "Sigma DF EX Aspherical 28-70mm F2.8" },        //4
        { 0x03ff, "Sigma AF Tele 400mm F5.6 Multi-coated" },        //5
        { 0x03ff, "Sigma 24-60mm F2.8 EX DG" },                //6
        { 0x03ff, "Sigma 70-300mm F4-5.6 Macro" },            //7
        { 0x03ff, "Sigma 55-200mm F4-5.6 DC" },                //8
        { 0x03ff, "Sigma 18-50mm F2.8 EX DC" },                //9
        { 0x03ff, "Sigma 18-50mm F2.8 EX DC Macro" },            //10</pre>To differentiate, the code has to provide a function "resolveLensType".  The default version of that is in the patch, however it's effectively empty and defaults to the first entry with that lensID.  So the code says "Sigma Lens".</p>


	<p>resolveLensType has access to all the metadata in the file which of course includes the information:<pre>0x003f Pentax       LensType                    Byte        2  3 255
0x0207 Pentax       LensInfo                    Undefined  36  3 255 0 0 40 148 ...</pre>So the recipe for the fix is to provide a working "resolveLensType" which would read the key Exif.Pentax.LensInfo.  In there lies the secret.  Regrettably the URL to the maker notes concerning Pentax is no longer valid - so I don't know how to decode the LensInfo record which would enable us to be certain it's your lens!</p>


	<p>from page: <a class="external" href="http://www.exiv2.org/makernote.html">http://www.exiv2.org/makernote.html</a>   Reference 11<br />broken link: <a class="external" href="http://www.gvsoft.homedns.org/exif/makernote-pentax-type3.html">http://www.gvsoft.homedns.org/exif/makernote-pentax-type3.html</a></p>


	<p>There's another minor issue that the code to actually do the printing is a tricky little MACRO that uses a C++ Template.  A little head buster.</p>


	<p>There are a couple of ways in which you could help:<br />1 Can you look at the key Exif.Pentax.LensInfo in lots of images<br />If it's always an array of the 36 integers above, that's fine.  Or is there a subset that's the same in every image?</p>


	<p>2 Can you have a google to see if you can find the current location of the Pentax MakerNote Spec?<br />There might be something on Phil's (he of exiftool fame) web site</p>


	<p>I'm going to give up for today (it's 8:20pm in England).  This is very interesting.  I've learned a lot today about a part of the code in which I've hardly worked.  I'm confident of success - however not tonight. I'd like to acknowledge and thank Abhinav for the work he did on this.  Although he hasn't fixed it, his changes and comments in the code have revealed the road to the fix.</p></div>
    </div>
  </div>
  
  <div id="change-4451" class="journal has-details">
    <div id="note-17">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-17" class="journal-link">#17</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="10 Nov 2015 20:18" href="/projects/exiv2/activity?from=2015-11-10">about 6 years</a> ago
      <span id="journal-4451-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>% Done</strong> changed from <i>0</i> to <i>50</i></li>
       <li><strong>Estimated time</strong> set to <i>12.00 h</i></li>
    </ul>
    
    </div>
  </div>
  
  <div id="change-4452" class="journal has-notes">
    <div id="note-18">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-18" class="journal-link">#18</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="11 Nov 2015 11:18" href="/projects/exiv2/activity?from=2015-11-11">about 6 years</a> ago
      <span id="journal-4452-private_notes" class=""></span>
    </h4>

    <div id="journal-4452-notes" class="wiki"><p>I'm adding Phil to the watchers for this issue.</p>


	<p>Phil:<br />Can you help me please?  I can see on your web-site <a class="external" href="http://www.sno.phy.queensu.ca/~phil/exiftool/TagNames/Pentax.html">http://www.sno.phy.queensu.ca/~phil/exiftool/TagNames/Pentax.html</a> that the lens-ID is listed as:<pre>'3 255.8'    = Sigma 55-200mm F4-5.6 DC</pre>And this aligns perfectly with our code above.</p>


	<p>What is 'Composite LensID tag'?</p></div>
    </div>
  </div>
  
  <div id="change-4453" class="journal has-notes">
    <div id="note-19">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-19" class="journal-link">#19</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/3100">Phil Harvey</a> <a title="11 Nov 2015 12:39" href="/projects/exiv2/activity?from=2015-11-11">about 6 years</a> ago
      <span id="journal-4453-private_notes" class=""></span>
    </h4>

    <div id="journal-4453-notes" class="wiki"><p>The ExifTool Composite tags are derived from the values of other tags, and are documented here: <a class="external" href="http://owl.phy.queensu.ca/~phil/exiftool/TagNames/Composite.html">http://owl.phy.queensu.ca/~phil/exiftool/TagNames/Composite.html</a></p>


	<p>The Composite LensID tag is an attempt to identify the lens using LensType and a number of other tags, specifically FocalLength, MaxAperture, MaxApertureValue, MinFocalLength, MaxFocalLength, LensModel, LensFocalRange, LensSpec, LensType2 and LensFocalLength.</p>


	<p>The actual logic to do this is somewhat convoluted, but may be found at line 3582 here: <a class="external" href="https://sourceforge.net/p/exiftool/code/ci/master/tree/lib/Image/ExifTool/Exif.pm">https://sourceforge.net/p/exiftool/code/ci/master/tree/lib/Image/ExifTool/Exif.pm</a></p></div>
    </div>
  </div>
  
  <div id="change-4454" class="journal has-notes">
    <div id="note-20">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-20" class="journal-link">#20</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="11 Nov 2015 13:12" href="/projects/exiv2/activity?from=2015-11-11">about 6 years</a> ago
      <span id="journal-4454-private_notes" class=""></span>
    </h4>

    <div id="journal-4454-notes" class="wiki"><p>Thank You, Phil.  What a helpful person you are.  If you're visiting England, we'd be honoured by a visit (and we're offering free dinner, bed and breakfast).  We're 40km from Heathrow Airport.  <a class="external" href="http://dev.exiv2.org/projects/exiv2/wiki/_Robin_Mills_">http://dev.exiv2.org/projects/exiv2/wiki/_Robin_Mills_</a></p>


	<p>I was very interested in a comment you made on your website about the undocumented nature of maker notes. It serves everybody's interest to share this information freely.  The success of the internet is, in no small measure, due to its public development and RFCs.  Apache is a miracle in the computer industry which loves competition, confusion, brand-loyalty and other business goals which are not compatible with cooperation.  The camera business is even less interested in sharing.  A huge <em><strong>Vote of Thanks</strong></em> to you for all your work to shine a light into this pit of darkness.</p></div>
    </div>
  </div>
  
  <div id="change-4455" class="journal has-notes">
    <div id="note-21">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-21" class="journal-link">#21</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/3100">Phil Harvey</a> <a title="11 Nov 2015 13:33" href="/projects/exiv2/activity?from=2015-11-11">about 6 years</a> ago
      <span id="journal-4455-private_notes" class=""></span>
    </h4>

    <div id="journal-4455-notes" class="wiki"><p>Glad to help.  Thanks for the offer.</p></div>
    </div>
  </div>
  
  <div id="change-4460" class="journal has-notes has-details">
    <div id="note-22">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-22" class="journal-link">#22</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="12 Nov 2015 11:38" href="/projects/exiv2/activity?from=2015-11-12">about 6 years</a> ago
      <span id="journal-4460-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>% Done</strong> changed from <i>50</i> to <i>80</i></li>
    </ul>
    <div id="journal-4460-notes" class="wiki"><p>Fix submitted: <a class="changeset" title="#816.  Fix submitted.  Will ask Simon to test this ask his permission to use his metadata in the ..." href="/projects/exiv2/repository/exiv2/revisions/4016">r4016</a>.</p>


	<p>Simon:<br />Two questions:<br />1 Can you build and test this on the trunk<br />With wonderful input from Phil, I can now figure out that it's your lens from the data in Exif.Pentax.LensInfo (explanation below).  However, it's a bit of a guess.</p>


	<p>2 May I have your permission to extract the metadata from the test file IMPG4432.PEF into test/data/exiv2-bug816.exf.  I add a regression detector to test/bugfixes-test.sh</p>


	<p><em><strong>About the fix</strong></em><pre>if ( lensID == 0x3ff ) { // lensType Sigma
    unsigned long base   = 1;

    // http://www.sno.phy.queensu.ca/~phil/exiftool/TagNames/Pentax.html#LensData
    const ExifData::const_iterator lensInfo = metadata-&gt;findKey(ExifKey("Exif.Pentax.LensInfo"));
    if ( lensID == 0x3ff &#38;&#38; lensInfo-&gt;count() &gt; 5 ) {
        unsigned int  autoAperture     = lensInfo-&gt;toLong(base+1) &#38; 0x01 ;
        unsigned int  minAperture      = lensInfo-&gt;toLong(base+2) &#38; 0x06 ;
        unsigned int  minFocusDistance = lensInfo-&gt;toLong(base+3) &#38; 0xf8 ;

        if ( autoAperture == 0x0 &#38;&#38; minAperture == 0x0 &#38;&#38; minFocusDistance == 0x28 ) index = 8;
    }
}</pre>Phil's Perl function contains lots of magic for many lens types.  I decided to simplify the whole thing to this test:</p>


	<p>if lensID = 0x3ff and AutoAperture etc are set OK, it's a Sigma 55-200mm which is index +8 in the find(pentaxLensType,0x377) array.</p>


	<p>I can make the test more robust when I have examples of Exif.Pentax.LensInfo for your lens.</p></div>
    </div>
  </div>
  
  <div id="change-4468" class="journal has-notes">
    <div id="note-23">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-23" class="journal-link">#23</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/3328">Simon Harhues</a> <a title="12 Nov 2015 17:07" href="/projects/exiv2/activity?from=2015-11-12">about 6 years</a> ago
      <span id="journal-4468-private_notes" class=""></span>
    </h4>

    <div id="journal-4468-notes" class="wiki"><p>I had a look at the LensInfo at different images, it is indeed different, only the first 8 ints seem to be always the same:<br /><pre>
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8633.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 64 78 128 70 244 65 89 136 88 61 1 64 107 251 255 255 255 0 0 128 70 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8635.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 68 245 128 70 244 65 93 136 88 61 1 66 107 251 255 255 255 0 0 128 70 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8636.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 69 117 128 38 244 65 137 136 88 58 1 68 107 251 255 255 255 0 0 128 38 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8637.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 69 165 128 38 244 65 117 136 88 57 1 67 107 251 255 255 255 0 0 128 38 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8638.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 64 78 128 70 244 65 89 136 88 61 1 64 107 251 255 255 255 0 0 128 70 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8640.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 64 152 80 6 241 65 237 153 88 36 1 76 107 251 255 255 255 0 0 80 6 241 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8641.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 64 152 80 6 241 65 237 153 88 36 1 76 107 251 255 255 255 0 0 80 6 241 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8642.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 64 101 128 6 244 65 153 153 88 58 1 69 107 251 255 255 255 0 0 128 6 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8643.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 64 244 112 6 243 65 197 153 88 35 1 73 107 251 255 255 255 0 0 112 6 243 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8644.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 69 81 128 6 244 65 165 153 88 54 1 71 107 251 255 255 255 0 0 128 6 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8645.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 64 88 48 6 239 65 82 170 88 42 1 80 107 251 255 255 255 0 0 48 6 239 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8646.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 64 88 48 6 239 65 82 170 88 42 1 80 107 251 255 255 255 0 0 48 6 239 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8647.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 64 104 64 6 240 65 74 170 88 42 1 79 107 251 255 255 255 0 0 64 6 240 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8648.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 64 88 48 6 239 65 82 170 88 42 1 80 107 251 255 255 255 0 0 48 6 239 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8649.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 69 78 128 70 244 65 89 136 88 61 1 64 107 251 255 255 255 0 0 128 70 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8650.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 64 152 80 6 241 65 237 153 88 36 1 76 107 251 255 255 255 0 0 80 6 241 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8651.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 69 88 48 6 239 65 82 170 88 42 1 80 107 251 255 255 255 0 0 48 6 239 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8652.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 64 88 48 6 239 65 82 170 88 42 1 80 107 251 255 255 255 0 0 48 6 239 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8653.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 64 124 80 6 240 65 66 170 88 38 1 78 107 251 255 255 255 0 0 80 6 240 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8654.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 65 152 80 6 241 65 237 153 88 36 1 76 107 251 255 255 255 0 0 80 6 241 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8655.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 69 117 128 38 244 65 137 136 88 58 1 68 107 251 255 255 255 0 0 128 38 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8656.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 69 117 128 38 244 65 137 136 88 58 1 68 107 251 255 255 255 0 0 128 38 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8657.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 71 101 128 6 244 65 153 153 88 58 1 69 107 251 255 255 255 0 0 128 6 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8658.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 65 141 128 38 244 65 125 136 88 57 1 68 107 251 255 255 255 0 0 128 38 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8661.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 69 229 128 70 244 65 101 136 88 61 1 66 107 251 255 255 255 0 0 128 70 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8662.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 69 201 128 70 244 65 109 136 88 59 1 67 107 251 255 255 255 0 0 128 70 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8663.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 69 201 128 70 244 65 109 136 88 59 1 67 107 251 255 255 255 0 0 128 70 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8664.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 69 201 128 70 244 65 109 136 88 59 1 67 107 251 255 255 255 0 0 128 70 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8665.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 69 201 128 70 244 65 109 136 88 59 1 67 107 251 255 255 255 0 0 128 70 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8666.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 69 201 128 70 244 65 109 136 88 59 1 67 107 251 255 255 255 0 0 128 70 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8667.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 69 201 128 70 244 65 109 136 88 59 1 67 107 251 255 255 255 0 0 128 70 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8668.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 69 201 128 70 244 65 109 136 88 59 1 67 107 251 255 255 255 0 0 128 70 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8669.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 69 201 128 70 244 65 109 136 88 59 1 67 107 251 255 255 255 0 0 128 70 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8670.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 64 245 128 70 244 65 93 136 88 61 1 66 107 251 255 255 255 0 0 128 70 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8671.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 64 78 128 70 244 65 89 136 88 61 1 64 107 251 255 255 255 0 0 128 70 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8672.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 65 78 128 70 244 65 89 136 88 61 1 64 107 251 255 255 255 0 0 128 70 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8673.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 68 78 128 70 244 65 89 136 88 61 1 64 107 251 255 255 255 0 0 128 70 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8674.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 71 196 96 6 242 65 213 153 88 38 1 75 107 251 255 255 255 0 0 96 6 242 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8675.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 65 152 80 6 241 65 237 153 88 36 1 76 107 251 255 255 255 0 0 80 6 241 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8676.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 64 152 80 6 241 65 237 153 88 36 1 76 107 251 255 255 255 0 0 80 6 241 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:~/fotos/15-10-18_tongeren_antikmarkt$ exiv2 -pt _IGP8677.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 66 244 112 6 243 65 197 153 88 35 1 73 107 251 255 255 255 0 0 112 6 243 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
</pre></p>


	<p>Robin Mills wrote:</p>


<blockquote>

	<p>2 May I have your permission to extract the metadata from the test file IMPG4432.PEF into test/data/exiv2-bug816.exf.  I add a regression detector to test/bugfixes-test.sh</p>


</blockquote>

	<p>Yes, you're welcome to use the meta data from that file for the exiv2 project.</p>


	<p>I'll see if I'm able to build the current trunk to test.</p></div>
    </div>
  </div>
  
  <div id="change-4469" class="journal has-notes">
    <div id="note-24">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-24" class="journal-link">#24</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="12 Nov 2015 17:37" href="/projects/exiv2/activity?from=2015-11-12">about 6 years</a> ago
      <span id="journal-4469-private_notes" class=""></span>
    </h4>

    <div id="journal-4469-notes" class="wiki"><p>Simon</p>


	<p>This seems a little different.  You're operating on a DNG and the LensInfo stuff is coming from the tag Exif.PentaxDng.LensInfo  Can you share one of your DNGs as I think I'll have to fix the code to respect that also.   Here's what I have:<pre>937 rmills@rmillsmbp:~/gnu/gexiv2 $ exiv2 -pa --grep LensInfo ~/Downloads/IMGP4432.PEF 
Exif.Pentax.LensInfo                         Undefined  36  3 255 0 0 40 148 71 152 80 6 241 65 237 153 88 36 1 76 107 251 255 255 255 0 0 80 6 241 0 ...
938 rmills@rmillsmbp:~/gnu/gexiv2 $ </pre>And you're showing:<pre>exiv2 -pt _IGP8677.DNG | grep LensInfo
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 66 244 112 6 243 65 197 153 88 35 1 73 107 251 255 255 255 0 0 112 6 243 0 ...</pre>We're almost there.</p></div>
    </div>
  </div>
  
  <div id="change-4478" class="journal has-notes has-details">
    <div id="note-25">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-25" class="journal-link">#25</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/3328">Simon Harhues</a> <a title="12 Nov 2015 22:02" href="/projects/exiv2/activity?from=2015-11-12">about 6 years</a> ago
      <span id="journal-4478-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>File</strong> <a href="/attachments/858">_IGP9032.DNG</a> <a class="icon-only icon-download" title="Download" href="/attachments/download/858/_IGP9032.DNG">_IGP9032.DNG</a> added</li>
       <li><strong>File</strong> <a href="/attachments/859">_IGP9033.PEF</a> <a class="icon-only icon-download" title="Download" href="/attachments/download/859/_IGP9033.PEF">_IGP9033.PEF</a> added</li>
       <li><strong>File</strong> <a href="/attachments/860">_IGP9034.JPG</a> <a class="icon-only icon-download" title="Download" href="/attachments/download/860/_IGP9034.JPG">_IGP9034.JPG</a> added</li>
    </ul>
    <div id="journal-4478-notes" class="wiki"><p>Oh yeah. Didn't pay attention to it. I did upgrade the body from an ist*DL to a K10. I'll upload one PNG, PEF, and JPEG each, to have files to compare.</p></div>
    </div>
  </div>
  
  <div id="change-4479" class="journal has-notes">
    <div id="note-26">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-26" class="journal-link">#26</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/3328">Simon Harhues</a> <a title="12 Nov 2015 22:08" href="/projects/exiv2/activity?from=2015-11-12">about 6 years</a> ago
      <span id="journal-4479-private_notes" class=""></span>
    </h4>

    <div id="journal-4479-notes" class="wiki"><p>The exiv2 output for the three files:<br /><pre>
simon@laptop:/media/simon/sd16/DCIM/100PENTX$ exiv2 -pt _IGP9032.DNG | grep Lens
Exif.PentaxDng.LensType                      Byte        3  Sigma Lens
Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 68 244 112 6 243 65 197 153 88 35 1 73 107 251 255 255 255 0 0 112 6 243 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:/media/simon/sd16/DCIM/100PENTX$ exiv2 -pt _IGP9033.PEF | grep Lens
Exif.Pentax.LensType                         Byte        3  Sigma Lens
Exif.Pentax.LensInfo                         Undefined  69  131 0 0 255 0 40 148 68 244 112 6 243 65 197 153 88 35 1 73 107 251 255 255 255 0 0 112 6 243 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@laptop:/media/simon/sd16/DCIM/100PENTX$ exiv2 -pt _IGP9034.JPG | grep Lens
Exif.Pentax.LensType                         Byte        3  Sigma Lens
Exif.Pentax.LensInfo                         Undefined  69  131 0 0 255 0 40 148 68 244 112 6 243 65 197 153 88 35 1 73 107 251 255 255 255 0 0 112 6 243 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
</pre></p></div>
    </div>
  </div>
  
  <div id="change-4480" class="journal has-notes">
    <div id="note-27">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-27" class="journal-link">#27</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="12 Nov 2015 22:20" href="/projects/exiv2/activity?from=2015-11-12">about 6 years</a> ago
      <span id="journal-4480-private_notes" class=""></span>
    </h4>

    <div id="journal-4480-notes" class="wiki"><p>Thanks, Simon.  I'll have a look at your files tomorrow (it's 22:18 here, so I'm off to bed).  I'm very confident we'll get this done'n'dusted tomorrow.</p>


	<p>Can you confirm that these images were acquired using the same lens and camera as IMGP4432.PEF ?</p></div>
    </div>
  </div>
  
  <div id="change-4483" class="journal has-notes">
    <div id="note-28">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-28" class="journal-link">#28</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/3328">Simon Harhues</a> <a title="13 Nov 2015 06:10" href="/projects/exiv2/activity?from=2015-11-13">about 6 years</a> ago
      <span id="journal-4483-private_notes" class=""></span>
    </h4>

    <div id="journal-4483-notes" class="wiki"><p>I'm one hour ahead of you. :) So 7am for me now.<br />The three new images were taken with the same lens (Sigma 55-200mm F4-5.6 DC) but with a different body (Pentax K10). The file IMGP4432.PEF was taken with an Pentax ist*DL.</p></div>
    </div>
  </div>
  
  <div id="change-4484" class="journal has-notes">
    <div id="note-29">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-29" class="journal-link">#29</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/3328">Simon Harhues</a> <a title="13 Nov 2015 06:18" href="/projects/exiv2/activity?from=2015-11-13">about 6 years</a> ago
      <span id="journal-4484-private_notes" class=""></span>
    </h4>

    <div id="journal-4484-notes" class="wiki"><p>I just had a quick look in my archive, here is some exiv2 output for images taken with the Pentax Ist*DL and the Sigma 55-200 lens:<br /><pre>
simon@laptop:12-03-24_regenbogen_veste_oberhaus$ exiv2 -pt IMGP4466.PEF | grep Lens
Exif.Pentax.LensType                         Byte        2  Sigma Lens
Exif.Pentax.LensInfo                         Undefined  36  3 255 0 0 40 148 67 78 128 70 244 65 89 136 88 61 1 64 107 251 255 255 255 0 0 128 70 244 0 0 0 0 0 0 0 0
simon@laptop:12-03-24_regenbogen_veste_oberhaus$ exiv2 -pt IMGP4467.PEF | grep Lens
Exif.Pentax.LensType                         Byte        2  Sigma Lens
Exif.Pentax.LensInfo                         Undefined  36  3 255 0 0 40 148 67 201 128 70 244 65 109 136 88 59 1 67 107 251 255 255 255 0 0 128 70 244 0 0 0 0 0 0 0 0
simon@laptop:12-03-24_regenbogen_veste_oberhaus$ exiv2 -pt IMGP4468.PEF | grep Lens
Exif.Pentax.LensType                         Byte        2  Sigma Lens
Exif.Pentax.LensInfo                         Undefined  36  3 255 0 0 40 148 67 78 128 70 244 65 89 136 88 61 1 64 107 251 255 255 255 0 0 128 70 244 0 0 0 0 0 0 0 0
simon@laptop:12-03-24_regenbogen_veste_oberhaus$ exiv2 -pt IMGP4478.PEF | grep Lens
Exif.Pentax.LensType                         Byte        2  Sigma Lens
Exif.Pentax.LensInfo                         Undefined  36  3 255 0 0 40 148 67 88 48 6 239 65 82 170 88 42 1 80 107 251 255 255 255 0 0 48 6 239 0 0 0 0 0 0 0 0
simon@laptop:12-03-24_regenbogen_veste_oberhaus$ exiv2 -pt IMGP4479.PEF | grep Lens
Exif.Pentax.LensType                         Byte        2  Sigma Lens
Exif.Pentax.LensInfo                         Undefined  36  3 255 0 0 40 148 67 78 128 70 244 65 89 136 88 61 1 64 107 251 255 255 255 0 0 128 70 244 0 0 0 0 0 0 0 0
simon@laptop:12-03-24_regenbogen_veste_oberhaus$ exiv2 -pt IMGP4480.PEF | grep Lens
Exif.Pentax.LensType                         Byte        2  Sigma Lens
Exif.Pentax.LensInfo                         Undefined  36  3 255 0 0 40 148 67 117 128 38 244 65 137 136 88 58 1 68 107 251 255 255 255 0 0 128 38 244 0 0 0 0 0 0 0 0
simon@laptop:12-03-24_regenbogen_veste_oberhaus$ exiv2 -pt IMGP4481.PEF | grep Lens
Exif.Pentax.LensType                         Byte        2  Sigma Lens
Exif.Pentax.LensInfo                         Undefined  36  3 255 0 0 40 148 67 88 48 6 239 65 82 170 88 42 1 80 107 251 255 255 255 0 0 48 6 239 0 0 0 0 0 0 0 0
simon@laptop:12-03-24_regenbogen_veste_oberhaus$ exiv2 -pt IMGP4482.PEF | grep Lens
Exif.Pentax.LensType                         Byte        2  Sigma Lens
Exif.Pentax.LensInfo                         Undefined  36  3 255 0 0 40 148 67 117 128 38 244 65 137 136 88 58 1 68 107 251 255 255 255 0 0 128 38 244 0 0 0 0 0 0 0 0
</pre></p></div>
    </div>
  </div>
  
  <div id="change-4487" class="journal has-notes">
    <div id="note-30">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-30" class="journal-link">#30</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="13 Nov 2015 10:21" href="/projects/exiv2/activity?from=2015-11-13">about 6 years</a> ago
      <span id="journal-4487-private_notes" class=""></span>
    </h4>

    <div id="journal-4487-notes" class="wiki"><p>Thanks, Simon.  Thanks for sending the extra files.  The ones from Thursday have 69 bytes in the LensInfo and todays have 36.  Different camera body - that explains that.</p>


	<p>I have to go off to do a few errands today.  I will look at this when I return.  Very optimistic that we will get to closure on this today.</p></div>
    </div>
  </div>
  
  <div id="change-4492" class="journal has-notes">
    <div id="note-31">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-31" class="journal-link">#31</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="13 Nov 2015 19:46" href="/projects/exiv2/activity?from=2015-11-13">about 6 years</a> ago
      <span id="journal-4492-private_notes" class=""></span>
    </h4>

    <div id="journal-4492-notes" class="wiki"><p>Fix submitted.  <a class="changeset" title="#816.  Fix submitted.  Thank you Simon for working with me on this and for providing test files." href="/projects/exiv2/repository/exiv2/revisions/4018">r4018</a> and <a class="changeset" title="#816  Correction to r4018 to deal with segmentation fault on test file _IGP9034.JPG" href="/projects/exiv2/repository/exiv2/revisions/4019">r4019</a>  Thank You, Simon for working with me on this and for providing test data.</p>


	<p>Simon:<br />May I ask you to build the HEAD of trunk (<a class="changeset" title="#816  Correction to r4018 to deal with segmentation fault on test file _IGP9034.JPG" href="/projects/exiv2/repository/exiv2/revisions/4019">r4019</a> or later) and run some tests.</p>


	<p>I doubt if we have seen the last of this issue.  The fix is based on detecting the Sigma Lens then inspecting the LensInfo to say "is this Simon's Lens?".  And we've only used files from two camera bodies using this lens.  Perhaps you know somebody with another model of Pentax camera.</p>


	<p>I understand you want to use this in Darkroom.  If you wish to rebuild the libexiv2 shared object with this fix, you'll probably have to patch an unmodified 0.25 with pentaxmn.cpp/r4019 and rebuild.  The API of libexiv2.so/trunk is not binary compatible with libexiv2.so/0.25.  I don't think simply copying a trunk build of the libexiv2 shared object will work.  I can build the appropriate library on Ubuntu if required.</p>


	<p>You have to replace the copy of libexiv2.so used by Darkroom.  You might need to use a system monitor to inspect Darkroom to determine the path to the libexiv2.so in use.</p></div>
    </div>
  </div>
  
  <div id="change-4493" class="journal has-notes">
    <div id="note-32">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-32" class="journal-link">#32</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="13 Nov 2015 20:56" href="/projects/exiv2/activity?from=2015-11-13">about 6 years</a> ago
      <span id="journal-4493-private_notes" class=""></span>
    </h4>

    <div id="journal-4493-notes" class="wiki"><p>Simon</p>


	<p>I've built a 'vanilla' v0.25 and copied in trunk/src/pentaxmn.cpp.  It builds on the Mac and passes the v0.25 test suite.  Yeah!  <pre>1237 rmills@rmillsmbp:~/gnu/exiv2/0.25 $ exiv2 --verbose --version --grep svn
exiv2 0.25 001900 (64 bit build)
svn=0
1238 rmills@rmillsmbp:~/gnu/exiv2/0.25 $ </pre>svn = 0 is a tar-ball build!  So this fix hasn't introduced any bad side-effects.<pre>1240 rmills@rmillsmbp:~/gnu/exiv2/0.25 $ svn export svn://dev.exiv2.org/svn/tags/0.25/test
....
1241 rmills@rmillsmbp:~/gnu/exiv2/0.25 $ make tests
.....
all testcases passed.</pre>Your test files are working fine on this build.<pre>1237 rmills@rmillsmbp:~/gnu/exiv2/0.25 $ exiv2 -pa --grep Lens ~/Downloads/IMGP4432.PEF 
Exif.Pentax.LensType                         Byte        2  Sigma 55-200mm F4-5.6 DC
Exif.Pentax.LensInfo                         Undefined  36  3 255 0 0 40 148 ...
1239 rmills@rmillsmbp:~/gnu/exiv2/0.25 $ exiv2 -pa --grep Lens ~/Downloads/_*
/Users/rmills/Downloads/_IGP9032.DNG  Exif.PentaxDng.LensType                      Byte        3  Sigma 55-200mm F4-5.6 DC
/Users/rmills/Downloads/_IGP9032.DNG  Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 ...
/Users/rmills/Downloads/_IGP9033.PEF  Exif.Pentax.LensType                         Byte        3  Sigma 55-200mm F4-5.6 DC
/Users/rmills/Downloads/_IGP9033.PEF  Exif.Pentax.LensInfo                         Undefined  69  131 0 0 255 0 40 148 ...
/Users/rmills/Downloads/_IGP9034.JPG  Exif.Pentax.LensType                         Byte        3  Sigma 55-200mm F4-5.6 DC
/Users/rmills/Downloads/_IGP9034.JPG  Exif.Pentax.LensInfo                         Undefined  69  131 0 0 255 0 40 148 ...
1240 rmills@rmillsmbp:~/gnu/exiv2/0.25 $ </pre>I think I'll take the rest of the week off!</p></div>
    </div>
  </div>
  
  <div id="change-4501" class="journal has-notes has-details">
    <div id="note-33">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-33" class="journal-link">#33</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="17 Nov 2015 19:21" href="/projects/exiv2/activity?from=2015-11-17">about 6 years</a> ago
      <span id="journal-4501-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>Assigned</i> to <i>Resolved</i></li>
       <li><strong>% Done</strong> changed from <i>80</i> to <i>100</i></li>
       <li><strong>Estimated time</strong> changed from <i>12.00 h</i> to <i>15.00 h</i></li>
    </ul>
    <div id="journal-4501-notes" class="wiki"><p>As I haven't heard from Simon, I'm going to assume this is resolved.  If nothing further is reported on this matter, I'll close this issue at the end of December.</p></div>
    </div>
  </div>
  
  <div id="change-4502" class="journal has-notes">
    <div id="note-34">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-34" class="journal-link">#34</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/3328">Simon Harhues</a> <a title="17 Nov 2015 22:33" href="/projects/exiv2/activity?from=2015-11-17">about 6 years</a> ago
      <span id="journal-4502-private_notes" class=""></span>
    </h4>

    <div id="journal-4502-notes" class="wiki"><p>Sorry for the late reply. It took me a while to set up a virtual machine and build &#38; install trunk. I now accomplished it and tested a couple of files from the Pentax ist*DL and Pentax K10 successfully.<br />I might be able to get hold of another Pentax body to test the lens around Christmas, but not earlier.<br />For the use with darktable, I'll just wait until it is bundled with a new release of exiv2.<br />Thanks for your support Robin!</p></div>
    </div>
  </div>
  
  <div id="change-4503" class="journal has-notes">
    <div id="note-35">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-35" class="journal-link">#35</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="17 Nov 2015 23:24" href="/projects/exiv2/activity?from=2015-11-17">about 6 years</a> ago
      <span id="journal-4503-private_notes" class=""></span>
    </h4>

    <div id="journal-4503-notes" class="wiki"><p>You're welcome, Simon. I suspect there will be more activity on this issue.  When you find something, please update this issue,  or report a new issue.</p>


	<p>I didn't write Exiv2, however I know the code is robust and reliable.   Like all software, it has a back-log.  The aim of v0.26 is to clear that back-log, and that's how I came to look at your 3-year old issue.  I hope to get our slate clean and keep it that way.  We'll see.</p>


	<p>Let's hope <a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Enable detection of Sigma 55-200mm lens (Closed)" href="/issues/816">#816</a> is history!   Thank You for working with me on this.</p></div>
    </div>
  </div>
  
  <div id="change-4550" class="journal has-notes has-details">
    <div id="note-36">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-36" class="journal-link">#36</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/3328">Simon Harhues</a> <a title="20 Dec 2015 20:15" href="/projects/exiv2/activity?from=2015-12-20">almost 6 years</a> ago
      <span id="journal-4550-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>File</strong> <a href="/attachments/868">IMGP2221.JPG</a> <a class="icon-only icon-download" title="Download" href="/attachments/download/868/IMGP2221.JPG">IMGP2221.JPG</a> added</li>
    </ul>
    <div id="journal-4550-notes" class="wiki"><p>Robin, as promised I just tested the lens with a Pentax K-3 (all at 55mm). It seems there is still some work needed:<br /><pre>
simon@vmubuntu1510:/tmp/fotos/101_2012$ exiv2 -pt IMGP2220.DNG | grep Lens
Exif.PentaxDng.LensType                      Byte        4  Sigma Lens
Exif.PentaxDng.LensInfo                      Undefined 128  0 131 128 0 0 255 1 184 0 0 0 0 0 0 0 0 40 148 71 78 128 70 244 65 89 136 88 61 1 64 107 251 255 255 255 0 0 128 70 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@vmubuntu1510:/tmp/fotos/101_2012$ exiv2 -pt IMGP222 | grep Lens
IMGP2220.DNG  IMGP2221.JPG  IMGP2221.PEF  
simon@vmubuntu1510:/tmp/fotos/101_2012$ exiv2 -pt IMGP2221.PEF | grep Lens
Exif.PentaxDng.LensType                      Byte        4  Sigma Lens
Exif.PentaxDng.LensInfo                      Undefined 128  0 131 128 0 0 255 1 184 0 0 0 0 0 0 0 0 40 148 71 78 128 70 244 65 89 136 88 61 1 64 107 251 255 255 255 0 0 128 70 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@vmubuntu1510:/tmp/fotos/101_2012$ exiv2 -pt IMGP2221.JPG | grep Lens
Exif.PentaxDng.LensType                      Byte        4  Sigma Lens
Exif.PentaxDng.LensInfo                      Undefined 128  0 131 128 0 0 255 1 184 0 0 0 0 0 0 0 0 40 148 71 78 128 70 244 65 89 136 88 61 1 64 107 251 255 255 255 0 0 128 70 244 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
simon@vmubuntu1510:/tmp/fotos/101_2012$
</pre><br />The raw files are too big, but you can download all three at: <a class="external" href="https://www.dropbox.com/sh/93rw7vigr65etxa/AAA6A8wJVHvjg6mDKevjk3Wca?dl=0">https://www.dropbox.com/sh/93rw7vigr65etxa/AAA6A8wJVHvjg6mDKevjk3Wca?dl=0</a><br />As usual, feel free to use the images for the further development of exiv2.</p></div>
    </div>
  </div>
  
  <div id="change-4551" class="journal has-notes has-details">
    <div id="note-37">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-37" class="journal-link">#37</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="20 Dec 2015 21:34" href="/projects/exiv2/activity?from=2015-12-20">almost 6 years</a> ago
      <span id="journal-4551-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>Resolved</i> to <i>Assigned</i></li>
       <li><strong>% Done</strong> changed from <i>100</i> to <i>80</i></li>
    </ul>
    <div id="journal-4551-notes" class="wiki"><p>Thanks Simon.  This is just the news I wanted for Christmas!  Gives me something to do on Friday, I guess.  I've submitted a fix:  <a class="changeset" title="#816.  Fix for Pentax K-3 Camera." href="/projects/exiv2/repository/exiv2/revisions/4135">r4135</a></p>


	<p>I've forgotten exactly what this is about, however I had something similar today with a Canon Camera and Lens.  <a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Canon EF-S 24mm f/2.8 STM (Closed)" href="/issues/1140">#1140</a>.  I see you now have 128 bytes in PentaxDng.LensInfo and LensType now has 4 bytes.  Quickly extracting from the three "kinds" of files: <pre>$ exiv2 -pa --grep lens/i --grep model/i ~/Downloads/*.PEF ~/Downloads/*.DNG
/Users/rmills/Downloads/IMGP4432.PEF  Exif.Image.Model              Ascii      20  PENTAX *ist DL     
/Users/rmills/Downloads/IMGP4432.PEF  Exif.Pentax.ModelID           Long        1  *ist DL
/Users/rmills/Downloads/IMGP4432.PEF  Exif.Pentax.LensType          Byte        2  Sigma 55-200mm F4-5.6 DC                &lt;---   2 bytes
/Users/rmills/Downloads/IMGP4432.PEF  Exif.Pentax.LensInfo          Undefined  36  3 255 0 0 40 148 71 152 80 6 241 65 ... &lt;---  36 bytes
/Users/rmills/Downloads/_IGP9032.DNG  Exif.Image.Model              Ascii      20  PENTAX K10D        
/Users/rmills/Downloads/_IGP9032.DNG  Exif.Image.UniqueCameraModel  Ascii      12  PENTAX K10D
/Users/rmills/Downloads/_IGP9032.DNG  Exif.PentaxDng.ModelID        Long        1  K10D
/Users/rmills/Downloads/_IGP9032.DNG  Exif.PentaxDng.LensType       Byte        3  Sigma 55-200mm F4-5.6 DC                &lt;---   3 bytes
/Users/rmills/Downloads/_IGP9032.DNG  Exif.PentaxDng.LensInfo       Undefined  69  131 0 0 255 0 40 148 68  ...            &lt;---  69 bytes
/Users/rmills/Downloads/IMGP2220.DNG  Exif.Image.Model              Ascii      20  PENTAX K-3         
/Users/rmills/Downloads/IMGP2220.DNG  Exif.Image.UniqueCameraModel  Ascii      11  PENTAX K-3
/Users/rmills/Downloads/IMGP2220.DNG  Exif.PentaxDng.ModelID        Long        1  K-3
/Users/rmills/Downloads/IMGP2220.DNG  Exif.PentaxDng.LensType       Byte        4  Sigma Lens                              &lt;---   4 bytes
/Users/rmills/Downloads/IMGP2220.DNG  Exif.PentaxDng.LensInfo       Undefined 128  0 131 128 0 0 255 1 184 0 0 ...         &lt;--- 128 bytes
$ </pre>So, the "PENTAX *ist DL", "Pentax K10D" and "PENTAX K-3", write 36, 69 and 128 bytes to PentaxDng.LensInfo (and 2/3/4 bytes into Pentax.LensType).</p>


	<p>I've updated pentaxmn.cpp/resolveLensTypeSigma() to respect the 128/4 byte and now I get:<pre>992 rmills@rmillsmbp:~/gnu/exiv2/trunk $ exiv2 -pa --grep Lens ~/Downloads/*.DNG 
/Users/rmills/Downloads/IMGP2220.DNG  Exif.PentaxDng.LensType                      Byte        4  Sigma 55-200mm F4-5.6 DC
/Users/rmills/Downloads/IMGP2220.DNG  Exif.PentaxDng.LensInfo                      Undefined 128  0 131 128 0 0 255 1 184 0 0 ...
/Users/rmills/Downloads/_IGP9032.DNG  Exif.PentaxDng.LensType                      Byte        3  Sigma 55-200mm F4-5.6 DC
/Users/rmills/Downloads/_IGP9032.DNG  Exif.PentaxDng.LensInfo                      Undefined  69  131 0 0 255 0 40 148 68 ... 
$ </pre>Here's the new code:<pre><code class="cpp syntaxhl"><span class="k">if</span> <span class="p">(</span> <span class="n">value</span><span class="p">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">)</span> <span class="p">{</span>
    <span class="c1">// http://dev.exiv2.org/attachments/download/326/IMGP4432.PEF</span>
    <span class="c1">// exiv2 -pv --grep Lens ~/Downloads/IMGP4432.PEF</span>
    <span class="n">NO</span> <span class="n">CHANGE</span>
<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">value</span><span class="p">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">)</span> <span class="p">{</span>
    <span class="c1">// http://dev.exiv2.org/attachments/download/858/_IGP9032.DNG</span>
    <span class="n">NO</span> <span class="n">CHANGE</span>
<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">value</span><span class="p">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">4</span> <span class="p">)</span> <span class="p">{</span>
    <span class="c1">// http://dev.exiv2.org/attachments/download/868/IMGP2220.DNG</span>
    <span class="c1">// 0x0207 PentaxDng    LensInfo  Undefined 128    0 131 128   0 0 255   1 184   0 0 0 0 0</span>
    <span class="c1">//                                                    0   1   2   3 4   5   6</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">lensInfo</span><span class="o">-&gt;</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">128</span> <span class="o">&amp;&amp;</span> <span class="n">lensInfo</span><span class="o">-&gt;</span><span class="n">toLong</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">131</span> <span class="o">&amp;&amp;</span> <span class="n">lensInfo</span><span class="o">-&gt;</span><span class="n">toLong</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">128</span> <span class="p">)</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
<span class="p">}</span></code></pre>Thanks for the test data.  I've extracted the metadata into test/data/exiv2-bug816e.exv and updated the test suite to inspect him as a regression detector.</p>


	<p>Can I ask you to build and run some tests. I've chosen to test the length and bytes 1 and 2 - this could be a wrong guess.  If you find files for which this doesn't work, please post them and I will investigate.</p></div>
    </div>
  </div>
  
  <div id="change-4552" class="journal has-notes">
    <div id="note-38">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-38" class="journal-link">#38</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/3328">Simon Harhues</a> <a title="21 Dec 2015 09:20" href="/projects/exiv2/activity?from=2015-12-21">almost 6 years</a> ago
      <span id="journal-4552-private_notes" class=""></span>
    </h4>

    <div id="journal-4552-notes" class="wiki"><p>Hi I can only recommend to add that lens and a couple of different bodies to your wish list to make sure that you're still busy on Saturday as well. ;) But don't worry.<br />I recompiled and just went through all my photos of the last 14 months and checked them. The Sigma lens now gets always recognized correctly. That's great! I will try to shoot some more with the K3 body to have more test samples and come back to you then.</p>


	<p>Note to myself: <pre>find /tmp/fotos/ -name "*.PEF" -o -name "*.DNG" -exec sh -c 'exiv2 -pt {} | grep "Sigma"' \; -print &gt; ~/raws</pre></p></div>
    </div>
  </div>
  
  <div id="change-4553" class="journal has-notes has-details">
    <div id="note-39">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-39" class="journal-link">#39</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="21 Dec 2015 13:08" href="/projects/exiv2/activity?from=2015-12-21">almost 6 years</a> ago
      <span id="journal-4553-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>Assigned</i> to <i>Resolved</i></li>
       <li><strong>% Done</strong> changed from <i>80</i> to <i>100</i></li>
       <li><strong>Estimated time</strong> changed from <i>15.00 h</i> to <i>17.00 h</i></li>
    </ul>
    <div id="journal-4553-notes" class="wiki"><p>That's great.  I'm going to restore this to "Resolved 100%" until you say otherwise.</p>


	<p>Here's the bill for my help.  I'd like you to visit OpenHub.net and register (it's free).  Give the Exiv2 project a great rating (4 or 5) and give me kudos.</p>


	<p>Exiv2: <a class="external" href="https://www.openhub.net/p/exiv2">https://www.openhub.net/p/exiv2</a><br />Clanmills: <a class="external" href="https://www.openhub.net/p/exiv2/contributors/60065117754297">https://www.openhub.net/p/exiv2/contributors/60065117754297</a></p>


	<p>Happy Holidays.  Always good to hear from you.</p>


	<p>Robin - Build Master and Developer Support Engineer</p>


	<p><img src="http://www.exiv2.org/Exiv2Logo.png" alt="" /></p></div>
    </div>
  </div>
  
  <div id="change-4563" class="journal has-notes">
    <div id="note-40">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-40" class="journal-link">#40</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/3328">Simon Harhues</a> <a title="22 Dec 2015 21:42" href="/projects/exiv2/activity?from=2015-12-22">almost 6 years</a> ago
      <span id="journal-4563-private_notes" class=""></span>
    </h4>

    <div id="journal-4563-notes" class="wiki"><p>Robin, I did a couple of new shots with the K3 body and they all get recognized. Great work, thanks! I believe we can keep it closed (until somebody comes around with a new body).<br />BTW as I was a little afraid that you would get bored on Friday I created the two issues <a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Manual lens does not get recogniced: Pentax macro 100mm (Closed)" href="/issues/1141">#1141</a> and <a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Manual lens does not get recogniced: Beroflex zoom 500mm (Closed)" href="/issues/1142">#1142</a>. ;)</p>


	<p>Happy Holidays and thanks for your great support again!</p></div>
    </div>
  </div>
  
  <div id="change-4566" class="journal has-notes">
    <div id="note-41">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-41" class="journal-link">#41</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="22 Dec 2015 22:02" href="/projects/exiv2/activity?from=2015-12-22">almost 6 years</a> ago
      <span id="journal-4566-private_notes" class=""></span>
    </h4>

    <div id="journal-4566-notes" class="wiki"><p>I haven't closed the bug.  It's marked 100% resolved.  If nothing else surfaces, I'll marked it closed before we ship v0.26.  Not sure I'll look at the new issues this week.  However I will look at them.</p>


	<p>I have never noticed that Simon Harhues is an anagram of "Santa Claus".  Oh, thank you Santa, now I know you are real!</p></div>
    </div>
  </div>
  
  <div id="change-4696" class="journal has-details">
    <div id="note-42">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-42" class="journal-link">#42</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="13 Jan 2016 19:15" href="/projects/exiv2/activity?from=2016-01-13">almost 6 years</a> ago
      <span id="journal-4696-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>Resolved</i> to <i>Closed</i></li>
    </ul>
    
    </div>
  </div>
  


</div>

<div style="clear: both;"></div>
<div class="contextual">





</div>


<div style="clear: both;"></div>


<p class="other-formats">Also available in:  <span><a class="atom" rel="nofollow" href="/issues/816.atom">Atom</a></span>
  <span><a class="pdf" rel="nofollow" href="/issues/816.pdf">PDF</a></span>
</p>





        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
