<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Support #1151: Small raw images size  - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="H/UyUic77XPzmPbQNIjqf2nD03q/ICJgmYctoNQJCK39uJm9VUEhc6b86dyLX+ZMVlGHA07Dg9pkp70olzDvwg==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
    <link rel="alternate" type="application/atom+xml" title="Exiv2 - Support #1151: Small raw images size " href="https://dev.exiv2.org/issues/1151.atom" />
<script src="/javascripts/context_menu.js?1550767427"></script><link rel="stylesheet" media="screen" href="/stylesheets/context_menu.css?1550767427" /></head>
<body class="project-exiv2 has-main-menu controller-issues action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="issues" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="issues" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=issues" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=issues">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues selected" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="">
    <div id="sidebar">
          <h3>Issues</h3>

<ul>
<li><a href="/projects/exiv2/issues?set_filter=1">View all issues</a></li>
<li><a href="/projects/exiv2/issues/report">Summary</a></li>

</ul>









        
    </div>

    <div id="content">
        
        <div class="contextual">





</div>


<h2>Support #1151</h2>

<div class="issue tracker-3 status-5 priority-4 priority-default closed details">

  <div class="gravatar-with-child">
    
    
  </div>

<div class="subject">
<div><h3>Small raw images size </h3></div>
</div>
        <p class="author">
        Added by <a class="user active" href="/users/4599">Wil Hermes</a> <a title="10 Jan 2016 16:17" href="/projects/exiv2/activity?from=2016-01-10">almost 6 years</a> ago.
        Updated <a title="01 Feb 2016 11:43" href="/projects/exiv2/activity?from=2016-02-01">almost 6 years</a> ago.
        </p>

<div class="attributes">
<div class="splitcontent"><div class="splitcontentleft"><div class="status attribute"><div class="label">Status:</div><div class="value">Closed</div></div><div class="priority attribute"><div class="label">Priority:</div><div class="value">Normal</div></div><div class="assigned-to attribute"><div class="label">Assignee:</div><div class="value"><a class="user active" href="/users/119">Robin Mills</a></div></div><div class="category attribute"><div class="label">Category:</div><div class="value">basicio</div></div><div class="fixed-version attribute"><div class="label">Target version:</div><div class="value"><a title="28 Apr 2017" href="/versions/52">0.26</a></div></div></div><div class="splitcontentleft"><div class="start-date attribute"><div class="label">Start date:</div><div class="value">10 Jan 2016</div></div><div class="due-date attribute"><div class="label">Due date:</div><div class="value"></div></div><div class="progress attribute"><div class="label">% Done:</div><div class="value"><table class="progress progress-100"><tr><td style="width: 100%;" class="closed" title="100%"></td></tr></table><p class="percent">100%</p></div></div><div class="estimated-hours attribute"><div class="label">Estimated time:</div><div class="value">4.00 h</div></div></div></div>


</div>

<hr />
<div class="description">
  <div class="contextual">
  
  </div>

  <p><strong>Description</strong></p>
  <div class="wiki">
  <p>Hello,</p>


	<p>I've found that geeqie program is using probably exiv2 and it's detecting and displaying images in wrong (small) size. Every raw image is detected as 160x120(120x160). I was trying to find solution for this, but with no help. I tried different raw formats (pentax, olympus) and result is still the same. i use dng and i can provide some image and command line results here.</p>


	<p>Any help from your site will be appriciated, i have to reboot to windows for displaying new photos i've taken...</p>


	<p>Thank you!</p>
  </div>
</div>
  <hr />
  <p><strong>Files</strong></p>
  <div class="attachments">
<div class="contextual">
  
</div>
<table>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/943">_IGP9859.DNG</a>    <span class="size">(14.2 MB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/943/_IGP9859.DNG">_IGP9859.DNG</a>  </td>
  <td>Sample raw image</td>
  <td>
      <span class="author">Wil Hermes, 14 Jan 2016 21:47</span>
  </td>
  <td>
  </td>
</tr>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/944">screen-raw.png</a>    <span class="size">(190 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/944/screen-raw.png">screen-raw.png</a>  </td>
  <td>Geegie screenshot</td>
  <td>
      <span class="author">Wil Hermes, 14 Jan 2016 21:47</span>
  </td>
  <td>
  </td>
</tr>
</table>
</div>







<hr />
<div id="relations">
<div class="contextual">
</div>

<p><strong>Related issues</strong></p>

<form data-cm-url="/issues/context_menu" action="/issues/1151" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="PR3uUsevTeXhqhwXJw1LItJwYTIygfPtLzfY74aTNp7fUEW9tdWB5bTOAxuY2kcR7eI1S8NiUlfSF0hnxarR8Q==" />
  <table class="list issues odd-even"><tr id="relation-199" class="issue hascontextmenu issue tracker-2 status-5 priority-4 priority-default closed"><td class="checkbox"><input type="checkbox" name="ids[]" value="1153" /></td><td class="subject" style="width: 50%">Related to Exiv2 - <a class="issue tracker-2 status-5 priority-4 priority-default closed" href="/issues/1153">Feature #1153</a>: Sony ILCE-6000 + Sony E 50mm F1.8 OSS .JPG files without lens model.</td><td class="status">Closed</td><td class="start_date">11 Jan 2016</td><td class="due_date"></td><td class="done_ratio"><table class="progress progress-100"><tr><td style="width: 100%;" class="closed" title="100%"></td></tr></table><p class="percent"></p></td><td class="buttons"><a title="Actions" class="icon-only icon-actions js-contextmenu" href="#">Actions</a></td></tr></table>
</form>
<form class="new_relation" id="new-relation-form" style="display: none;" action="/issues/1151/relations" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" />


<p><select onchange="setPredecessorFieldsVisibility();" name="relation[relation_type]" id="relation_relation_type"><option selected="selected" value="relates">Related to</option>
<option value="duplicates">Is duplicate of</option>
<option value="duplicated">Has duplicate</option>
<option value="blocks">Blocks</option>
<option value="blocked">Blocked by</option>
<option value="precedes">Precedes</option>
<option value="follows">Follows</option>
<option value="copied_to">Copied to</option>
<option value="copied_from">Copied from</option></select>
Issue #<input size="10" type="text" name="relation[issue_to_id]" id="relation_issue_to_id" />
<span id="predecessor_fields" style="display:none;">
Delay: <input size="3" type="text" name="relation[delay]" id="relation_delay" /> days
</span>
<input type="submit" name="commit" value="Add" data-disable-with="Add" />
<a href="#" onclick="$(&quot;#new-relation-form&quot;).hide();; return false;">Cancel</a>
</p>

<script>
//<![CDATA[
observeAutocompleteField('relation_issue_to_id', '/issues/auto_complete?issue_id=1151&project_id=exiv2&scope=all')
//]]>
</script>

<script>
//<![CDATA[
setPredecessorFieldsVisibility();
//]]>
</script>

</form>
</div>

</div>




<div id="history">
<h3>History</h3>
  <div id="change-4673" class="journal has-notes has-details">
    <div id="note-1">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-1" class="journal-link">#1</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="10 Jan 2016 16:28" href="/projects/exiv2/activity?from=2016-01-10">almost 6 years</a> ago
      <span id="journal-4673-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Tracker</strong> changed from <i>Bug</i> to <i>Support</i></li>
       <li><strong>Category</strong> set to <i>basicio</i></li>
       <li><strong>Assignee</strong> set to <i>Robin Mills</i></li>
       <li><strong>Target version</strong> set to <i>0.26</i></li>
    </ul>
    <div id="journal-4673-notes" class="wiki"><p>Wil</p>


	<p>Please provide some sample files, and your command-lines and I will investigate.  Please run the command: <pre>$ exiv2 --verbose --version</pre> and paste the output into this issue report.</p></div>
    </div>
  </div>
  
  <div id="change-4681" class="journal has-notes has-details">
    <div id="note-2">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-2" class="journal-link">#2</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="12 Jan 2016 09:03" href="/projects/exiv2/activity?from=2016-01-12">almost 6 years</a> ago
      <span id="journal-4681-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>New</i> to <i>Resolved</i></li>
       <li><strong>% Done</strong> changed from <i>0</i> to <i>50</i></li>
       <li><strong>Estimated time</strong> set to <i>3.00 h</i></li>
    </ul>
    <div id="journal-4681-notes" class="wiki"><p>I had never heard of geeqie.  I thought it was a spelling mistake!  However it was mentioned in <a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Sony ILCE-6000 + Sony E 50mm F1.8 OSS .JPG files without lens model. (Closed)" href="/issues/1153">#1153</a> (which is a Lens identification issue).  I asked Tim (who reported <a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Sony ILCE-6000 + Sony E 50mm F1.8 OSS .JPG files without lens model. (Closed)" href="/issues/1153">#1153</a>) about your issue and he replied:</p>


<blockquote>

	<p>.. not a problem. Geeqie is not a RAW converter and simply displays the JPG thumbnail in RAW files. For my files the cameras .JPGs are 6000x4000 whereas the thumbnails in RAW files get displayed in Geeqie with 1616x1080. Everything working perfect. (exiv2 0.23 + geeqie 1.1 <a class="external" href="http://geeqie.sourceforge.net/">http://geeqie.sourceforge.net/</a>)</p>


</blockquote>

<hr />


	<p>I've installed geequi on ubuntu 15.04 (sudo apt-get install geeqie) and I am running geeqie 1.2 and using exiv2 library (current trunk):<pre>1061 rmills@rmillsmbp-k1504:~ $ lsof | grep exiv2
geeqie    15047                 rmills  mem       REG                8,1    58744    3019683 /usr/share/locale-langpack/en_GB/LC_MESSAGES/exiv2.mo
geeqie    15047                 rmills  mem       REG                8,1  3160704    3017551 /usr/local/lib/libexiv2.so.14.0.0
1062 rmills@rmillsmbp-k1504:~ $ </pre>geeqie appears to be working OK for me.  While this issue may be caused by Exiv2, <em><strong>you should report it to Team Geeqie</strong></em>.  I am not well positioned to identify a bug in an application I have never used.</p>


Can you:
	<ol>
	<li>Update your version of geeqie</li>
		<li>Report this  to geeqie</li>
		<li>Provide more information (platform, version of geeqie , version of libexiv2)</li>
		<li>Provide a more detailed description of the issue, so that I can reproduce it</li>
		<li>Provide test files</li>
	</ol></div>
    </div>
  </div>
  
  <div id="change-4692" class="journal has-notes has-details">
    <div id="note-3">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-3" class="journal-link">#3</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="13 Jan 2016 18:57" href="/projects/exiv2/activity?from=2016-01-13">almost 6 years</a> ago
      <span id="journal-4692-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>% Done</strong> changed from <i>50</i> to <i>100</i></li>
    </ul>
    <div id="journal-4692-notes" class="wiki"><p>I've been successful in building geeqie on MacOS-X using Mac Ports.  I've been able to reproduce the experience of Tim (reported in <a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Sony ILCE-6000 + Sony E 50mm F1.8 OSS .JPG files without lens model. (Closed)" href="/issues/1153">#1153</a>). Mac Ports installs v1.1 and uses /opt/local/lib/libexiv2.13.0.0.dylib (which is exiv2 v0.24).  It has no difficulty display the previews (1600x1000 or something) in Tim's ARW files which are available at svn://dev.exiv2.org/svn/testdata/trunk/1153</p>


	<p>There is insufficient information to pursue this matter further.  I am going to mark this 100% resolved.  This issue will be closed in February if no further information is provided.</p></div>
    </div>
  </div>
  
  <div id="change-4718" class="journal has-notes has-details">
    <div id="note-4">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-4" class="journal-link">#4</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/4599">Wil Hermes</a> <a title="14 Jan 2016 21:47" href="/projects/exiv2/activity?from=2016-01-14">almost 6 years</a> ago
      <span id="journal-4718-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>File</strong> <a href="/attachments/943">_IGP9859.DNG</a> <a class="icon-only icon-download" title="Download" href="/attachments/download/943/_IGP9859.DNG">_IGP9859.DNG</a> added</li>
       <li><strong>File</strong> <a href="/attachments/944">screen-raw.png</a> <a class="icon-only icon-download" title="Download" href="/attachments/download/944/screen-raw.png">screen-raw.png</a> added</li>
    </ul>
    <div id="journal-4718-notes" class="wiki"><p>Robin Mills wrote:</p>


<blockquote>

	<p>I've been successful in building geeqie on MacOS-X using Mac Ports.  I've been able to reproduce the experience of Tim (reported in <a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Sony ILCE-6000 + Sony E 50mm F1.8 OSS .JPG files without lens model. (Closed)" href="/issues/1153">#1153</a>). Mac Ports installs v1.1 and uses /opt/local/lib/libexiv2.13.0.0.dylib (which is exiv2 v0.24).  It has no difficulty display the previews (1600x1000 or something) in Tim's ARW files which are available at svn://dev.exiv2.org/svn/testdata/trunk/1153</p>


	<p>There is insufficient information to pursue this matter further.  I am going to mark this 100% resolved.  This issue will be closed in February if no further information is provided.</p>


</blockquote>

	<p>Thank you for reply!</p>


	<p>problem is not related just to geeqie, but it is wron displayed even with gthumb and other image viewers.</p>


	<p>platform: linux Gnome Ubuntu 15.10<br />$ apt-cache show exiv2 | grep Version<br />Version: 0.25-1ubuntu1</p>


	<p>$  exiv2 --verbose --version<br />exiv2 0.25 001900 (64 bit build)<br />Copyright (C) 2004-2015 Andreas Huggel.</p>


	<p>This program is free software; you can redistribute it and/or<br />modify it under the terms of the GNU General Public License<br />as published by the Free Software Foundation; either version 2<br />of the License, or (at your option) any later version.</p>


	<p>This program is distributed in the hope that it will be useful,<br />but WITHOUT ANY WARRANTY; without even the implied warranty of<br />MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the<br />GNU General Public License for more details.</p>


	<p>You should have received a copy of the GNU General Public<br />License along with this program; if not, write to the Free<br />Software Foundation, Inc., 51 Franklin Street, Fifth Floor,<br />Boston, MA 02110-1301 USA<br />exiv2=0.25.0<br />platform=linux<br />compiler=G++<br />bits=64<br />dll=1<br />debug=0<br />version=5.2.1 20150729<br />date=Aug  5 2015<br />time=15:26:19<br />svn=0<br />ssh=0<br />curl=0<br />id=$Id: version.cpp 3800 2015-05-08 22:26:36Z robinwmills $<br />executable=/usr/bin/exiv2<br />library=/usr/lib/x86_64-linux-gnu/libexiv2.so.14<br />library=/usr/lib/x86_64-linux-gnu/libstdc++.so.6<br />library=/lib/x86_64-linux-gnu/libgcc_s.so.1<br />library=/lib/x86_64-linux-gnu/libc.so.6<br />library=/lib/x86_64-linux-gnu/libz.so.1<br />library=/lib/x86_64-linux-gnu/libexpat.so.1<br />library=/lib/x86_64-linux-gnu/libdl.so.2<br />library=/lib/x86_64-linux-gnu/libm.so.6<br />library=/lib64/ld-linux-x86-64.so.2<br />have_regex=1<br />have_strerror_r=1<br />have_gmtime_r=1<br />have_inttypes=1<br />have_libintl=1<br />have_lensdata=1<br />have_iconv=1<br />have_memory=1<br />have_memset=1<br />have_lstat=1<br />have_stdbool=1<br />have_stdint=1<br />have_stdlib=1<br />have_strlib=0<br />have_strchr=1<br />have_strerror=1<br />have_strerror_r=1<br />have_strings_h=0<br />have_strtol=1<br />have_mmap=1<br />have_munmap=1<br />have_sys_stat=1<br />have_timegm=1<br />have_unistd_h=0<br />have_sys_mman=1<br />have_libz=0<br />have_xmptoolkit=1<br />have_bool=1<br />have_strings=1<br />have_sys_types=1<br />have_unistd=1<br />have_unicode_path=0<br />enable_video=0<br />enable_webready=0</p>


	<p>screenshot and sample file is attached</p>


	<p>Thank you!</p></div>
    </div>
  </div>
  
  <div id="change-4721" class="journal has-notes has-details">
    <div id="note-5">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-5" class="journal-link">#5</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="14 Jan 2016 22:57" href="/projects/exiv2/activity?from=2016-01-14">almost 6 years</a> ago
      <span id="journal-4721-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>% Done</strong> changed from <i>100</i> to <i>70</i></li>
    </ul>
    <div id="journal-4721-notes" class="wiki"><p>Thanks, Wil.  I'll look at this tomorrow.  It's 22:56 in England.  Time for bed.</p></div>
    </div>
  </div>
  
  <div id="change-4731" class="journal has-notes has-details">
    <div id="note-6">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-6" class="journal-link">#6</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="15 Jan 2016 11:19" href="/projects/exiv2/activity?from=2016-01-15">almost 6 years</a> ago
      <span id="journal-4731-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>% Done</strong> changed from <i>70</i> to <i>80</i></li>
       <li><strong>Estimated time</strong> changed from <i>3.00 h</i> to <i>4.00 h</i></li>
    </ul>
    <div id="journal-4731-notes" class="wiki"><p>Wil</p>


	<p>I don't think Exiv2 is causing this.  There are multiple preview images embedded in your file:  <pre>$ exiv2 -pp ~/Downloads/_IGP9859.DNG 
Preview 1: image/tiff, 160x120 pixels, 57600 bytes
Preview 2: image/jpeg, 640x480 pixels, 33940 bytes
Preview 3: image/tiff, 4928x3264 pixels, 1181017 bytes
$ </pre>Unfortunately, I can't find the command to remove a preview, although I thought that was in the code.  If we can find a way to remove the small preview (or resequence the previews) presumably that would fix things.</p></div>
    </div>
  </div>
  
  <div id="change-4732" class="journal has-notes">
    <div id="note-7">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-7" class="journal-link">#7</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="15 Jan 2016 12:04" href="/projects/exiv2/activity?from=2016-01-15">almost 6 years</a> ago
      <span id="journal-4732-private_notes" class=""></span>
    </h4>

    <div id="journal-4732-notes" class="wiki"><p>I've thought of a quick way to fix this!  Sort the preview images in the opposite order, then the apps will use the largest preview! <pre>$ exiv2 -pp ~/Downloads/_IGP9859.DNG 
Preview 1: image/tiff, 4928x3264 pixels, 1181017 bytes
Preview 2: image/jpeg, 640x480 pixels, 33940 bytes
Preview 3: image/tiff, 160x120 pixels, 57600 bytes
$ </pre>The fix is in src/preview.cpp:<pre>$ svn diff src/preview.cpp 
Index: src/preview.cpp
===================================================================
--- src/preview.cpp    (revision 4181)
+++ src/preview.cpp    (working copy)
@@ -61,7 +61,7 @@
         uint32_t l = lhs.width_ * lhs.height_;
         uint32_t r = rhs.width_ * rhs.height_;

-        return l &lt; r;
+        return l &gt; r;
     }

     /*!
$ </pre>I not going to submit this code.  I'd like you to build and try it.  Let's see if this fixes things.</p>


	<p>I didn't write exiv2.  I'm the project build engineer.  I've had a look at the preview code.  We don't have any code to erase previews.  And, as I've never looked at that part of the code, I don't know how much effort is required to implement that.  I already have a lot of work to finish v0.26, so adding this capability probably cannot be undertaken at the moment.</p></div>
    </div>
  </div>
  
  <div id="change-4755" class="journal has-notes">
    <div id="note-8">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-8" class="journal-link">#8</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/4599">Wil Hermes</a> <a title="19 Jan 2016 18:44" href="/projects/exiv2/activity?from=2016-01-19">almost 6 years</a> ago
      <span id="journal-4755-private_notes" class=""></span>
    </h4>

    <div id="journal-4755-notes" class="wiki"><p>Thank you, Robin! I don't think that erase of preview is something that is really necessary, but just "skiping" of it might be enough, if it is possible..</p>


	<p>Wil</p>


	<p>Robin Mills wrote:</p>


<blockquote>

	<p>I've thought of a quick way to fix this!  Sort the preview images in the opposite order, then the apps will use the largest preview! [...]The fix is in src/preview.cpp:[...]I not going to submit this code.  I'd like you to build and try it.  Let's see if this fixes things.</p>


	<p>I didn't write exiv2.  I'm the project build engineer.  I've had a look at the preview code.  We don't have any code to erase previews.  And, as I've never looked at that part of the code, I don't know how much effort is required to implement that.  I already have a lot of work to finish v0.26, so adding this capability probably cannot be undertaken at the moment.</p>


</blockquote></div>
    </div>
  </div>
  
  <div id="change-4779" class="journal has-notes has-details">
    <div id="note-9">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-9" class="journal-link">#9</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="01 Feb 2016 11:43" href="/projects/exiv2/activity?from=2016-02-01">almost 6 years</a> ago
      <span id="journal-4779-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>Resolved</i> to <i>Closed</i></li>
       <li><strong>% Done</strong> changed from <i>80</i> to <i>100</i></li>
    </ul>
    <div id="journal-4779-notes" class="wiki"><p>I'm closing this issue to help me focus on other matters.  I don't know if my suggestion worked.  Change src/preview.cpp from:<pre><code class="cplusplus syntaxhl">   <span class="kt">bool</span> <span class="nf">cmpPreviewProperties</span><span class="p">(</span>
        <span class="k">const</span> <span class="n">PreviewProperties</span><span class="o">&amp;</span> <span class="n">lhs</span><span class="p">,</span>
        <span class="k">const</span> <span class="n">PreviewProperties</span><span class="o">&amp;</span> <span class="n">rhs</span>
    <span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">uint32_t</span> <span class="n">l</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">.</span><span class="n">width_</span> <span class="o">*</span> <span class="n">lhs</span><span class="p">.</span><span class="n">height_</span><span class="p">;</span>
        <span class="kt">uint32_t</span> <span class="n">r</span> <span class="o">=</span> <span class="n">rhs</span><span class="p">.</span><span class="n">width_</span> <span class="o">*</span> <span class="n">rhs</span><span class="p">.</span><span class="n">height_</span><span class="p">;</span>

        <span class="k">return</span> <span class="n">l</span> <span class="o">&lt;</span> <span class="n">r</span><span class="p">;</span>
    <span class="p">}</span>
</code></pre>to:<pre><code class="cplusplus syntaxhl">   <span class="kt">bool</span> <span class="nf">cmpPreviewProperties</span><span class="p">(</span>
        <span class="k">const</span> <span class="n">PreviewProperties</span><span class="o">&amp;</span> <span class="n">lhs</span><span class="p">,</span>
        <span class="k">const</span> <span class="n">PreviewProperties</span><span class="o">&amp;</span> <span class="n">rhs</span>
    <span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">uint32_t</span> <span class="n">l</span> <span class="o">=</span> <span class="n">lhs</span><span class="p">.</span><span class="n">width_</span> <span class="o">*</span> <span class="n">lhs</span><span class="p">.</span><span class="n">height_</span><span class="p">;</span>
        <span class="kt">uint32_t</span> <span class="n">r</span> <span class="o">=</span> <span class="n">rhs</span><span class="p">.</span><span class="n">width_</span> <span class="o">*</span> <span class="n">rhs</span><span class="p">.</span><span class="n">height_</span><span class="p">;</span>

        <span class="k">return</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="n">r</span><span class="p">;</span>
    <span class="p">}</span>
</code></pre>Wil:  If you wish to discuss this further, please update and I'll reopen this issue.</p></div>
    </div>
  </div>
  


</div>

<div style="clear: both;"></div>
<div class="contextual">





</div>


<div style="clear: both;"></div>


<p class="other-formats">Also available in:  <span><a class="atom" rel="nofollow" href="/issues/1151.atom">Atom</a></span>
  <span><a class="pdf" rel="nofollow" href="/issues/1151.pdf">PDF</a></span>
</p>





        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
