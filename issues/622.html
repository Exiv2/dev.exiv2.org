<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Bug #622: Exiv2 doesn&#39;t parse MicrosoftPhoto schema prefix correctly. - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="kvQcA3GKgsVQwWXFWv1VgJKT57l9olzDxFYXuAFgaoBwubfsA/BOxQWlesnlKlmzrQGzwIxB/Xk5docwQlmN7w==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
    <link rel="alternate" type="application/atom+xml" title="Exiv2 - Bug #622: Exiv2 doesn&#39;t parse MicrosoftPhoto schema prefix correctly." href="https://dev.exiv2.org/issues/622.atom" />
<script src="/javascripts/context_menu.js?1550767427"></script><link rel="stylesheet" media="screen" href="/stylesheets/context_menu.css?1550767427" /></head>
<body class="project-exiv2 has-main-menu controller-issues action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="issues" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="issues" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=issues" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=issues">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues selected" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="">
    <div id="sidebar">
          <h3>Issues</h3>

<ul>
<li><a href="/projects/exiv2/issues?set_filter=1">View all issues</a></li>
<li><a href="/projects/exiv2/issues/report">Summary</a></li>

</ul>









        
    </div>

    <div id="content">
        
        <div class="contextual">





</div>


<h2>Bug #622</h2>

<div class="issue tracker-1 status-5 priority-4 priority-default closed details">

  <div class="gravatar-with-child">
    
    
  </div>

<div class="subject">
<div><h3>Exiv2 doesn&#39;t parse MicrosoftPhoto schema prefix correctly.</h3></div>
</div>
        <p class="author">
        Added by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="18 Mar 2009 23:34" href="/projects/exiv2/activity?from=2009-03-18">over 12 years</a> ago.
        Updated <a title="30 Mar 2009 06:12" href="/projects/exiv2/activity?from=2009-03-30">over 12 years</a> ago.
        </p>

<div class="attributes">
<div class="splitcontent"><div class="splitcontentleft"><div class="status attribute"><div class="label">Status:</div><div class="value">Closed</div></div><div class="priority attribute"><div class="label">Priority:</div><div class="value">Normal</div></div><div class="assigned-to attribute"><div class="label">Assignee:</div><div class="value">-</div></div><div class="category attribute"><div class="label">Category:</div><div class="value">xmp</div></div><div class="fixed-version attribute"><div class="label">Target version:</div><div class="value"><a title="02 Apr 2009" href="/versions/42">0.18.1</a></div></div></div><div class="splitcontentleft"><div class="start-date attribute"><div class="label">Start date:</div><div class="value">18 Mar 2009</div></div><div class="due-date attribute"><div class="label">Due date:</div><div class="value"></div></div><div class="progress attribute"><div class="label">% Done:</div><div class="value"><table class="progress progress-100"><tr><td style="width: 100%;" class="closed" title="100%"></td></tr></table><p class="percent">100%</p></div></div><div class="estimated-hours attribute"><div class="label">Estimated time:</div><div class="value"></div></div></div></div>


</div>

<hr />
<div class="description">
  <div class="contextual">
  
  </div>

  <p><strong>Description</strong></p>
  <div class="wiki">
  <p>Exiv2 does not correctly parse the MicrosoftPhoto schema prefix from an XMP packet created with with Nikon Capture NX2, which uses "Public XMP Toolkit Core 3.5".<br />Exiv2 changes <code>MicrosoftPhoto</code> to <code>MicrosoftPhoto_1_</code> and even <code>MicrosoftPhoto_1__1_</code>.</p>


	<p>However, if the XMP packet is created from scratch with Exiv2, all is fine.</p>


	<p>(Reported by Gilles Caulier / Sylvain CROUZILLAT)</p>


<pre>
ahuggel@kelana&gt; ./exiv2 -px 2stars.jpg 
Xmp.xmp.Rating                               XmpText     1  2
Xmp.MicrosoftPhoto_1_.Rating                 XmpText     2  25
Xmp.dc.description                           LangAlt     1  lang="x-default" (c) Sylvain.CROUZILLAT@CROUCROU.COM 
Xmp.dc.subject                               XmpBag      1  Mariage
Xmp.photoshop.DateCreated                    XmpText    10  2008-12-12

ahuggel@kelana&gt; ./exiv2 -ex 2stars.jpg 

ahuggel@kelana&gt; cat 2stars.exv # output slightly edited
&lt;?xpacket begin="﻿" id="W5M0MpCehiHzreSzNTczkc9d"?&gt;
&lt;x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="XMP Core 4.1.1-Exiv2"&gt;
 &lt;rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"&gt;
  &lt;rdf:Description rdf:about="" 
    xmlns:xap="http://ns.adobe.com/xap/1.0/" 
    xmlns:MicrosoftPhoto_1__1_="http://ns.microsoft.com/photo/1.0/" 
    xmlns:dc="http://purl.org/dc/elements/1.1/" 
    xmlns:photoshop="http://ns.adobe.com/photoshop/1.0/" 
   xap:Rating="2" 
   MicrosoftPhoto_1__1_:Rating="25" 
   photoshop:DateCreated="2008-12-12"&gt;
   &lt;dc:description&gt;
    &lt;rdf:Alt&gt;
     &lt;rdf:li xml:lang="x-default"&gt;(c) Sylvain.CROUZILLAT@CROUCROU.COM &lt;/rdf:li&gt;
    &lt;/rdf:Alt&gt;
   &lt;/dc:description&gt;
   &lt;dc:subject&gt;
    &lt;rdf:Bag&gt;
     &lt;rdf:li&gt;Mariage&lt;/rdf:li&gt;
    &lt;/rdf:Bag&gt;
   &lt;/dc:subject&gt;
  &lt;/rdf:Description&gt;
 &lt;/rdf:RDF&gt;
&lt;/x:xmpmeta&gt;
&lt;?xpacket end="w"?&gt;

ahuggel@kelana&gt; xmpdump 2starts.jpg

ahuggel@kelana&gt; cat 2starts.jpg.xml
&lt;?xpacket begin="ï»¿" id="W5M0MpCehiHzreSzNTczkc9d"?&gt;
&lt;x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="Public XMP Toolkit Core 3.5"&gt;
   &lt;rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"&gt;
      &lt;rdf:Description rdf:about="" 
            xmlns:xap="http://ns.adobe.com/xap/1.0/"&gt;
         &lt;xap:Rating&gt;2&lt;/xap:Rating&gt;
      &lt;/rdf:Description&gt;
      &lt;rdf:Description rdf:about="" 
            xmlns:MicrosoftPhoto="http://ns.microsoft.com/photo/1.0"&gt;
         &lt;MicrosoftPhoto:Rating&gt;25&lt;/MicrosoftPhoto:Rating&gt;
      &lt;/rdf:Description&gt;
      &lt;rdf:Description rdf:about="" 
            xmlns:dc="http://purl.org/dc/elements/1.1/"&gt;
         &lt;dc:description&gt;
            &lt;rdf:Alt&gt;
               &lt;rdf:li xml:lang="x-default"&gt;(c) Sylvain.CROUZILLAT@CROUCROU.COM &lt;/rdf:li&gt;
            &lt;/rdf:Alt&gt;
         &lt;/dc:description&gt;
         &lt;dc:subject&gt;
            &lt;rdf:Bag&gt;
               &lt;rdf:li&gt;Mariage&lt;/rdf:li&gt;
            &lt;/rdf:Bag&gt;
         &lt;/dc:subject&gt;
      &lt;/rdf:Description&gt;
      &lt;rdf:Description rdf:about="" 
            xmlns:photoshop="http://ns.adobe.com/photoshop/1.0/"&gt;
         &lt;photoshop:DateCreated&gt;2008-12-12&lt;/photoshop:DateCreated&gt;
      &lt;/rdf:Description&gt;
   &lt;/rdf:RDF&gt;
&lt;/x:xmpmeta&gt;
&lt;?xpacket end="w"?&gt;
</pre>

	<p>If the XMP packet is created with Exiv2, all is fine:</p>


<pre>
ahuggel@kelana&gt; cat e.cmd
set Xmp.xmp.Rating 2
set Xmp.MicrosoftPhoto.Rating 25
set Xmp.dc.description lang="x-default" (c) Sylvain.CROUZILLAT@CROUCROU.COM 
set Xmp.dc.subject Mariage
set Xmp.photoshop.DateCreated 2008-12-12

ahuggel@kelana&gt; ./exiv2 -v -m e.cmd e.jpg 
File 1/1: e.jpg
Set Xmp.xmp.Rating "2" (XmpText)
Set Xmp.MicrosoftPhoto.Rating "25" (XmpText)
Set Xmp.dc.description "lang="x-default" (c) Sylvain.CROUZILLAT@CROUCROU.COM" (LangAlt)
Set Xmp.dc.subject "Mariage" (XmpBag)
Set Xmp.photoshop.DateCreated "2008-12-12" (XmpText)

ahuggel@kelana&gt; ./exiv2 -px e.jpg
Xmp.xmp.Rating                               XmpText     1  2
Xmp.MicrosoftPhoto.Rating                    XmpText     2  25
Xmp.photoshop.DateCreated                    XmpText    10  2008-12-12
Xmp.dc.description                           LangAlt     1  lang="x-default" (c) Sylvain.CROUZILLAT@CROUCROU.COM
Xmp.dc.subject                               XmpBag      1  Mariage

ahuggel@kelana&gt; xmpdump e.jpg

ahuggel@kelana&gt; cat e.jpg.xml 
&lt;?xpacket begin="﻿" id="W5M0MpCehiHzreSzNTczkc9d"?&gt;
&lt;x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="XMP Core 4.1.1-Exiv2"&gt;
 &lt;rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"&gt;
  &lt;rdf:Description rdf:about="" 
    xmlns:xap="http://ns.adobe.com/xap/1.0/" 
    xmlns:MicrosoftPhoto="http://ns.microsoft.com/Photo/1.0/" 
    xmlns:dc="http://purl.org/dc/elements/1.1/" 
    xmlns:photoshop="http://ns.adobe.com/photoshop/1.0/" 
   xap:Rating="2" 
   MicrosoftPhoto:Rating="25" 
   photoshop:DateCreated="2008-12-12"&gt;
   &lt;dc:description&gt;
    &lt;rdf:Alt&gt;
     &lt;rdf:li xml:lang="x-default"&gt;(c) Sylvain.CROUZILLAT@CROUCROU.COM&lt;/rdf:li&gt;
    &lt;/rdf:Alt&gt;
   &lt;/dc:description&gt;
   &lt;dc:subject&gt;
    &lt;rdf:Bag&gt;
     &lt;rdf:li&gt;Mariage&lt;/rdf:li&gt;
    &lt;/rdf:Bag&gt;
   &lt;/dc:subject&gt;
  &lt;/rdf:Description&gt;
 &lt;/rdf:RDF&gt;
&lt;/x:xmpmeta&gt;&lt;?xpacket end="w"?&gt;
</pre>
  </div>
</div>







</div>

<div id="issue-changesets">
<h3>Associated revisions</h3>
    <div class="changeset">
    <p><a title="Revision 1769" href="/projects/exiv2/repository/exiv2/revisions/1769">Revision 1769</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/1769/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="20 Mar 2009 08:30" href="/projects/exiv2/activity?from=2009-03-20">over 12 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p><a class="issue tracker-1 status-5 priority-4 priority-default closed" title="Bug: Exiv2 doesn&#39;t parse MicrosoftPhoto schema prefix correctly. (Closed)" href="/issues/622">#622</a>: Fixed MicrosoftPhoto URI in call to RegisterNamespace.</p>
    </div>
    </div>
    <div class="changeset">
    <p><a title="Revision 1770" href="/projects/exiv2/repository/exiv2/revisions/1770">Revision 1770</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/1770/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="21 Mar 2009 01:40" href="/projects/exiv2/activity?from=2009-03-21">over 12 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p><a class="issue tracker-1 status-5 priority-4 priority-default closed" title="Bug: Exiv2 doesn&#39;t parse MicrosoftPhoto schema prefix correctly. (Closed)" href="/issues/622">#622</a>: Fixed the same typo in the doc too.</p>
    </div>
    </div>

</div>



<div id="history">
<h3>History</h3>
  <div id="change-1195" class="journal has-notes">
    <div id="note-1">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-1" class="journal-link">#1</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="18 Mar 2009 23:56" href="/projects/exiv2/activity?from=2009-03-18">over 12 years</a> ago
      <span id="journal-1195-private_notes" class=""></span>
    </h4>

    <div id="journal-1195-notes" class="wiki"><p>This seems to be an incompatibility between "Public XMP Toolkit Core 3.5" used by Nikon Capture NX2 and the XMPSDK used by Exiv2. It looks like something is going wrong deep inside XMPSDK.</p>


Next steps:
	<ul>
	<li>Check if the problem can be reproduced with XMPSDK alone</li>
		<li>If so, check if the latest version of XMPSDK fixes the problem, if it doesn't, report as a bug for XMPSDK (Adobe)</li>
	</ul></div>
    </div>
  </div>
  
  <div id="change-1196" class="journal has-notes">
    <div id="note-2">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-2" class="journal-link">#2</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="19 Mar 2009 01:53" href="/projects/exiv2/activity?from=2009-03-19">over 12 years</a> ago
      <span id="journal-1196-private_notes" class=""></span>
    </h4>

    <div id="journal-1196-notes" class="wiki"><p>Gilles,</p>


	<p>The problem is very simple. Look at the namespace URIs: Nikon Capture NX2 uses <a class="external" href="http://ns.microsoft.com/photo/1.0">http://ns.microsoft.com/photo/1.0</a> (*p*hoto), but Exiv2 has <a class="external" href="http://ns.microsoft.com/Photo/1.0/">http://ns.microsoft.com/Photo/1.0/</a> (*P*hoto). If I make it lowercase in Exiv2, it works with the samples. But which URI is correct??</p>


	<p>Andreas</p></div>
    </div>
  </div>
  
  <div id="change-1197" class="journal has-notes">
    <div id="note-3">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-3" class="journal-link">#3</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/76">Gilles Caulier</a> <a title="19 Mar 2009 02:04" href="/projects/exiv2/activity?from=2009-03-19">over 12 years</a> ago
      <span id="journal-1197-private_notes" class=""></span>
    </h4>

    <div id="journal-1197-notes" class="wiki"><p>Andreas Huggel wrote:</p>


<blockquote>

	<p>Gilles,</p>


	<p>The problem is very simple. Look at the namespace URIs: Nikon Capture NX2 uses <a class="external" href="http://ns.microsoft.com/photo/1.0">http://ns.microsoft.com/photo/1.0</a> (*p*hoto), but Exiv2 has <a class="external" href="http://ns.microsoft.com/Photo/1.0/">http://ns.microsoft.com/Photo/1.0/</a> (*P*hoto). If I make it lowercase in Exiv2, it works with the samples. But which URI is correct??</p>


	<p>Andreas</p>


</blockquote>

	<p>Andreas,</p>


	<p>In last Exiftool, Microsoft XMP namespaces are :</p>
	<pre><code>MicrosoftPhoto =&gt; 'http://ns.microsoft.com/photo/1.0',<br />    MP             =&gt; 'http://ns.microsoft.com/photo/1.2/',<br />    MPRI           =&gt; 'http://ns.microsoft.com/photo/1.2/t/RegionInfo#',<br />    MPReg          =&gt; 'http://ns.microsoft.com/photo/1.2/t/Region#',</code></pre>


	<p>For NX i cannot any reference...</p>


	<p>Gilles Caulier</p></div>
    </div>
  </div>
  
  <div id="change-1198" class="journal has-notes has-details">
    <div id="note-4">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-4" class="journal-link">#4</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="20 Mar 2009 08:31" href="/projects/exiv2/activity?from=2009-03-20">over 12 years</a> ago
      <span id="journal-1198-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>New</i> to <i>Resolved</i></li>
       <li><strong>Target version</strong> set to <i>0.18.1</i></li>
       <li><strong>% Done</strong> changed from <i>0</i> to <i>100</i></li>
    </ul>
    <div id="journal-1198-notes" class="wiki"><p><a class="changeset" title="fix typo in M$ XMP namespace" href="/projects/exiv2/repository/exiv2/revisions/1768">r1768</a>, <a class="changeset" title="#622: Fixed MicrosoftPhoto URI in call to RegisterNamespace." href="/projects/exiv2/repository/exiv2/revisions/1769">r1769</a></p></div>
    </div>
  </div>
  
  <div id="change-1203" class="journal has-details">
    <div id="note-5">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-5" class="journal-link">#5</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="30 Mar 2009 06:12" href="/projects/exiv2/activity?from=2009-03-30">over 12 years</a> ago
      <span id="journal-1203-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>Resolved</i> to <i>Closed</i></li>
    </ul>
    
    </div>
  </div>
  


</div>

<div style="clear: both;"></div>
<div class="contextual">





</div>


<div style="clear: both;"></div>


<p class="other-formats">Also available in:  <span><a class="atom" rel="nofollow" href="/issues/622.atom">Atom</a></span>
  <span><a class="pdf" rel="nofollow" href="/issues/622.pdf">PDF</a></span>
</p>





        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
