<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Bug #1133: &quot; **(process:29414): WARNING: No namespace info available for xmp prefix &#39;lr&#39;&quot; - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="PrA9kMRHgctaFlBHigC4UfjfrXPiiDXf3I+YbB8I4sPc/ZZ/tj1Nyw9yT0s117Rix035ChNrlGUhrwjkXDEFrA==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
    <link rel="alternate" type="application/atom+xml" title="Exiv2 - Bug #1133: &quot; **(process:29414): WARNING: No namespace info available for xmp prefix &#39;lr&#39;&quot;" href="https://dev.exiv2.org/issues/1133.atom" />
<script src="/javascripts/context_menu.js?1550767427"></script><link rel="stylesheet" media="screen" href="/stylesheets/context_menu.css?1550767427" /></head>
<body class="project-exiv2 has-main-menu controller-issues action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="issues" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="issues" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=issues" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=issues">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues selected" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="">
    <div id="sidebar">
          <h3>Issues</h3>

<ul>
<li><a href="/projects/exiv2/issues?set_filter=1">View all issues</a></li>
<li><a href="/projects/exiv2/issues/report">Summary</a></li>

</ul>









        
    </div>

    <div id="content">
        
        <div class="contextual">





</div>


<h2>Bug #1133</h2>

<div class="issue tracker-1 status-5 priority-4 priority-default closed details">

  <div class="gravatar-with-child">
    
    
  </div>

<div class="subject">
<div><h3>&quot; **(process:29414): WARNING: No namespace info available for xmp prefix &#39;lr&#39;&quot;</h3></div>
</div>
        <p class="author">
        Added by <a class="user active" href="/users/4544">Vey Zimba</a> <a title="31 Oct 2015 18:39" href="/projects/exiv2/activity?from=2015-10-31">about 6 years</a> ago.
        Updated <a title="13 Jan 2016 19:03" href="/projects/exiv2/activity?from=2016-01-13">almost 6 years</a> ago.
        </p>

<div class="attributes">
<div class="splitcontent"><div class="splitcontentleft"><div class="status attribute"><div class="label">Status:</div><div class="value">Closed</div></div><div class="priority attribute"><div class="label">Priority:</div><div class="value">Normal</div></div><div class="assigned-to attribute"><div class="label">Assignee:</div><div class="value"><a class="user active" href="/users/4035">Alan Pater</a></div></div><div class="category attribute"><div class="label">Category:</div><div class="value">xmp</div></div><div class="fixed-version attribute"><div class="label">Target version:</div><div class="value"><a title="28 Apr 2017" href="/versions/52">0.26</a></div></div></div><div class="splitcontentleft"><div class="start-date attribute"><div class="label">Start date:</div><div class="value">31 Oct 2015</div></div><div class="due-date attribute"><div class="label">Due date:</div><div class="value"></div></div><div class="progress attribute"><div class="label">% Done:</div><div class="value"><table class="progress progress-100"><tr><td style="width: 100%;" class="closed" title="100%"></td></tr></table><p class="percent">100%</p></div></div><div class="estimated-hours attribute"><div class="label">Estimated time:</div><div class="value">2.00 h</div></div></div></div>


</div>

<hr />
<div class="description">
  <div class="contextual">
  
  </div>

  <p><strong>Description</strong></p>
  <div class="wiki">
  <p>Error msg:<br />" **(process:29414): WARNING: No namespace info available for xmp prefix 'lr'"</p>


	<p>Sometimes I can't seem to add strings under hierarchicalSubject or privateRTKInfo (only some <abbr title="s">DNG</abbr>). I can add strings to these <abbr title="s">DNG</abbr> only by first editing the files in Adobe Lightroom and adding the strings there. Working on Python here, using the wrapper GExiv2.</p>
  </div>
</div>







</div>




<div id="history">
<h3>History</h3>
  <div id="change-4420" class="journal has-notes has-details">
    <div id="note-1">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-1" class="journal-link">#1</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="31 Oct 2015 19:11" href="/projects/exiv2/activity?from=2015-10-31">about 6 years</a> ago
      <span id="journal-4420-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Category</strong> set to <i>xmp</i></li>
       <li><strong>Status</strong> changed from <i>New</i> to <i>Assigned</i></li>
       <li><strong>Assignee</strong> set to <i>Robin Mills</i></li>
       <li><strong>Target version</strong> set to <i>0.26</i></li>
    </ul>
    <div id="journal-4420-notes" class="wiki"><p>I'll help you with this, however you'll have to help me a little more.  "Sometimes" is a vague term.  I've never figured out how to build and use the Gexiv2 wrapper.</p>


	<p>Can I ask you to find a way to reliably reproduce this with the command-line tool exiv2(.exe) and give me the appropriate commands and test files.</p>


	<p>I'm not sure I've understood what you are saying about adding strings in Lightroom.  If it's working in Lightroom, what does that have to do with Exiv2?</p></div>
    </div>
  </div>
  
  <div id="change-4421" class="journal has-notes">
    <div id="note-2">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-2" class="journal-link">#2</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/4544">Vey Zimba</a> <a title="31 Oct 2015 19:36" href="/projects/exiv2/activity?from=2015-10-31">about 6 years</a> ago
      <span id="journal-4421-private_notes" class=""></span>
    </h4>

    <div id="journal-4421-notes" class="wiki"><p>Sorry, I meant some DNG files. The interesting part here is that the "No namespace" error stops if I add text to the DNG files in Lightroom. So I'm assuming that Lightroom creates the "space". I'll do as you've told me asap. Thanks!</p></div>
    </div>
  </div>
  
  <div id="change-4422" class="journal has-notes">
    <div id="note-3">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-3" class="journal-link">#3</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/4035">Alan Pater</a> <a title="31 Oct 2015 23:25" href="/projects/exiv2/activity?from=2015-10-31">about 6 years</a> ago
      <span id="journal-4422-private_notes" class=""></span>
    </h4>

    <div id="journal-4422-notes" class="wiki"><p>What version of exiv2 and gexiv2 are you using?</p>


	<p>The "lr" namespace was added to exiv2 starting with version 0.25.</p>


	<p>If you need to do this with a previous version of exiv2, you would need to register the "lr" namespace before trying to add text to those properties.</p></div>
    </div>
  </div>
  
  <div id="change-4423" class="journal has-notes">
    <div id="note-4">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-4" class="journal-link">#4</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="01 Nov 2015 00:00" href="/projects/exiv2/activity?from=2015-11-01">about 6 years</a> ago
      <span id="journal-4423-private_notes" class=""></span>
    </h4>

    <div id="journal-4423-notes" class="wiki"><p>Alan's right.  'lr' was only added quite recently.<pre>510 rmills@rmillsmbp:~/clanmills $ exiv2 --verbose --version --grep lr
exiv2 0.25 001900 (64 bit build)
xmlns=lr:http://ns.adobe.com/lightroom/1.0/
511 rmills@rmillsmbp:~/clanmills $ </pre>Dump the xmp before/after adding something in LightRoom.  Something like this:<pre>515 rmills@rmillsmbp:~/temp $ exiv2 -pX S.jpg | xmllint -pretty 2 - | grep xmlns
    xmlns:x="adobe:ns:meta/" 
      xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" 
        xmlns:xmp="http://ns.adobe.com/xap/1.0/" 
        xmlns:dc="http://purl.org/dc/elements/1.1/" 
516 rmills@rmillsmbp:~/temp $ </pre></p>


	<p>I'm going to use exiv2 to add some LR data, I think this is what you're doing in LightRoom.  I do two things:</p>


	<p>1) I use reg to register the namespace<br />2) I use the namespace<pre>516 rmills@rmillsmbp:~/temp $ exiv2 -M"reg lr http://ns.adobe.com/lightroom/1.0" -M"set Xmp.lr.rmills engineer" S.jpg</pre>And now, the namespace is in the XMP.<pre>517 rmills@rmillsmbp:~/temp $ exiv2 -pX S.jpg | xmllint -pretty 2 - | grep xmlns
    xmlns:x="adobe:ns:meta/" 
      xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" 
        xmlns:xmp="http://ns.adobe.com/xap/1.0/" 
        xmlns:dc="http://purl.org/dc/elements/1.1/" 
        xmlns:lr="http://ns.adobe.com/lightroom/1.0/" 
518 rmills@rmillsmbp:~/temp $</pre>You will need exiv2 version v0.25 to obtain the -pX feature.</p>


	<p>You don't need to use the "-Mreg lr <a class="external" href="http://.">http://.</a>.." command with exiv2 v.025.  You will need it for v0.24 and earlier.</p></div>
    </div>
  </div>
  
  <div id="change-4426" class="journal has-notes has-details">
    <div id="note-5">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-5" class="journal-link">#5</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="01 Nov 2015 19:35" href="/projects/exiv2/activity?from=2015-11-01">about 6 years</a> ago
      <span id="journal-4426-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>Assigned</i> to <i>Resolved</i></li>
       <li><strong>Assignee</strong> changed from <i>Robin Mills</i> to <i>Alan Pater</i></li>
       <li><strong>% Done</strong> changed from <i>0</i> to <i>100</i></li>
       <li><strong>Estimated time</strong> set to <i>2.00 h</i></li>
    </ul>
    <div id="journal-4426-notes" class="wiki"><p>I'm going to set the status of this to Resolved/100% and assign the solution to Alan.</p>


	<p>Vey:  If you have further information about this matter, the issue will remain open for a while and you are welcome to share further discoveries.  The issue will be closed before we ship v0.26 (currently scheduled for Spring 2016).</p></div>
    </div>
  </div>
  
  <div id="change-4457" class="journal has-notes">
    <div id="note-6">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-6" class="journal-link">#6</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/4544">Vey Zimba</a> <a title="12 Nov 2015 03:11" href="/projects/exiv2/activity?from=2015-11-12">about 6 years</a> ago
      <span id="journal-4457-private_notes" class=""></span>
    </h4>

    <div id="journal-4457-notes" class="wiki"><p>I got it to work somewhat by first registering the xmp namespace 'lr' before trying to add a value. The only remaining issue is that the 'hierarchicalSubject' sets to 'XmpText' instead of 'XmpBag', so it keeps replacing my old value with the new value when I try to add to 'hierarchicalSubject'. I'm still using GExiv2, so if anyone knows a work-around to this issue please let me know. Thanks for all the help so far.</p></div>
    </div>
  </div>
  
  <div id="change-4458" class="journal has-notes">
    <div id="note-7">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-7" class="journal-link">#7</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/4035">Alan Pater</a> <a title="12 Nov 2015 11:08" href="/projects/exiv2/activity?from=2015-11-12">about 6 years</a> ago
      <span id="journal-4458-private_notes" class=""></span>
    </h4>

    <div id="journal-4458-notes" class="wiki"><p>You need to also specify the property type, in this case XmpBag.</p>


	<p>This is automatic with exiv2 0.25 and greater as these XMP properties are pre-registered. With previous version, you need to specify the type as well as registering the lr namespace.</p></div>
    </div>
  </div>
  
  <div id="change-4459" class="journal has-notes">
    <div id="note-8">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-8" class="journal-link">#8</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/4544">Vey Zimba</a> <a title="12 Nov 2015 11:16" href="/projects/exiv2/activity?from=2015-11-12">about 6 years</a> ago
      <span id="journal-4459-private_notes" class=""></span>
    </h4>

    <div id="journal-4459-notes" class="wiki"><p>I've tried but failed to specify the type, set_tag_struct and set_xmp_tag_struct don't seem to work in GExiv2('Metadata' object has no attribute 'set_tag_struct'/'set_xmp_tag_struct').</p>


	<p>Seems to be something wrong in the python wrapper GExiv2?</p></div>
    </div>
  </div>
  
  <div id="change-4461" class="journal has-notes">
    <div id="note-9">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-9" class="journal-link">#9</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="12 Nov 2015 11:41" href="/projects/exiv2/activity?from=2015-11-12">about 6 years</a> ago
      <span id="journal-4461-private_notes" class=""></span>
    </h4>

    <div id="journal-4461-notes" class="wiki"><p>Regrettably, Team Exiv2 cannot support GExiv2.  In fact, I haven't been able to build GExiv2 on my Mac.</p></div>
    </div>
  </div>
  
  <div id="change-4462" class="journal has-notes">
    <div id="note-10">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-10" class="journal-link">#10</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/4544">Vey Zimba</a> <a title="12 Nov 2015 11:46" href="/projects/exiv2/activity?from=2015-11-12">about 6 years</a> ago
      <span id="journal-4462-private_notes" class=""></span>
    </h4>

    <div id="journal-4462-notes" class="wiki"><p>I see! I'm asking here since I saw you posting in this thread:<br /><a class="external" href="https://bugzilla.gnome.org/show_bug.cgi?id=712477">https://bugzilla.gnome.org/show_bug.cgi?id=712477</a></p>


	<p>I don't understand where to place the "work-around" solution in comment6.</p></div>
    </div>
  </div>
  
  <div id="change-4463" class="journal has-notes">
    <div id="note-11">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-11" class="journal-link">#11</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/4035">Alan Pater</a> <a title="12 Nov 2015 12:41" href="/projects/exiv2/activity?from=2015-11-12">about 6 years</a> ago
      <span id="journal-4463-private_notes" class=""></span>
    </h4>

    <div id="journal-4463-notes" class="wiki"><p>Well, it works if you use gexiv2 with exiv2 0.25. I don't know how to get it working on previous versions.</p></div>
    </div>
  </div>
  
  <div id="change-4464" class="journal has-notes">
    <div id="note-12">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-12" class="journal-link">#12</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/4544">Vey Zimba</a> <a title="12 Nov 2015 12:42" href="/projects/exiv2/activity?from=2015-11-12">about 6 years</a> ago
      <span id="journal-4464-private_notes" class=""></span>
    </h4>

    <div id="journal-4464-notes" class="wiki"><p>That's what I'm using. I just don't understand what/where to place the code from comment6.</p></div>
    </div>
  </div>
  
  <div id="change-4465" class="journal has-notes">
    <div id="note-13">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-13" class="journal-link">#13</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="12 Nov 2015 12:51" href="/projects/exiv2/activity?from=2015-11-12">about 6 years</a> ago
      <span id="journal-4465-private_notes" class=""></span>
    </h4>

    <div id="journal-4465-notes" class="wiki"><p>Vey:</p>


	<p>Without building and running this stuff, I can't follow what's being discussed.  I'll try to build this on Linux this evening and maybe that will work.  On the Mac, it doesn't build the python binding:<pre>847 rmills@rmillsmbp:~/gnu/gexiv2 $ ./configure --enable-introspection
... rattle roll ...
GExiv2 will be built with prefix /usr/local for x86_64-apple-darwin15.0.0 (cross-compiling: no).

Options:
    Introspection:      yes
    Python2 binding:    no
    Python3 binding:    no
    Tests and utils:    no

849 rmills@rmillsmbp:~/gnu/gexiv2 $ </pre>It hasn't done this because there's something missing in python. ./configure is running this code:<pre>enable_python2="no (introspection disabled)" 
enable_python3="no (introspection disabled)" 
if test "x$enable_introspection" = "xyes"; then
    # Used to determine where Python wants the .gi file to be installed ...
    # if Python is not installed, PYTHON2 and PYTHON3 will be empty
    PYTHON="import gi; print(gi._overridesdir)" 
    PYTHON2_GIDIR=$(python2 -c "$PYTHON")
    { $as_echo "$as_me:${as_lineno-$LINENO}: result: Python2 GObject Introspection directory: $PYTHON2_GIDIR" &gt;&#38;5
$as_echo "Python2 GObject Introspection directory: $PYTHON2_GIDIR" &gt;&amp;6; }
    PYTHON3_GIDIR=$(python3 -c "$PYTHON")
    { $as_echo "$as_me:${as_lineno-$LINENO}: result: Python3 GObject Introspection directory: $PYTHON3_GIDIR" &gt;&#38;5
$as_echo "Python3 GObject Introspection directory: $PYTHON3_GIDIR" &gt;&amp;6; }
    if test "x$PYTHON2_GIDIR" != "x"; then
        enable_python2=yes
    else
        enable_python2=no
    fi
    if test "x$PYTHON3_GIDIR" != "x"; then
        enable_python3=yes
    else
        enable_python3=no
    fi
</pre>So module gi is present, however it doesn't have go._overridesdir.  I haven't dug deeper.  <pre>850 rmills@rmillsmbp:~/gnu/gexiv2 $ python
Python 2.7.10 (default, Aug 22 2015, 20:33:39) 
[GCC 4.2.1 Compatible Apple LLVM 7.0.0 (clang-700.0.59.1)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; import gi
&gt;&gt;&gt; print(gi._overridesdir)
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
AttributeError: 'module' object has no attribute '_overridesdir'
&gt;&gt;&gt; </pre>If you know how to get this built, I might be able to help you.</p></div>
    </div>
  </div>
  
  <div id="change-4466" class="journal has-notes">
    <div id="note-14">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-14" class="journal-link">#14</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="12 Nov 2015 13:37" href="/projects/exiv2/activity?from=2015-11-12">about 6 years</a> ago
      <span id="journal-4466-private_notes" class=""></span>
    </h4>

    <div id="journal-4466-notes" class="wiki"><p>I'll have a look at this tonight on Linux.  I want to work in the garden this afternoon.  There's a big storm heading for England tonight and I want to deal with some stuff outside before "a hard-rain's a gonna fall"  (and 100km/hour winds).</p></div>
    </div>
  </div>
  
  <div id="change-4467" class="journal has-notes">
    <div id="note-15">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-15" class="journal-link">#15</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="12 Nov 2015 16:57" href="/projects/exiv2/activity?from=2015-11-12">about 6 years</a> ago
      <span id="journal-4467-private_notes" class=""></span>
    </h4>

    <div id="journal-4467-notes" class="wiki"><p>Vey:</p>


	<p>I have gexiv2 built and working on Linux.  It's using libexiv2 v0.25.  I've lost the plot.  What's the question here?</p></div>
    </div>
  </div>
  
  <div id="change-4471" class="journal has-notes">
    <div id="note-16">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-16" class="journal-link">#16</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/4035">Alan Pater</a> <a title="12 Nov 2015 19:30" href="/projects/exiv2/activity?from=2015-11-12">about 6 years</a> ago
      <span id="journal-4471-private_notes" class=""></span>
    </h4>

    <div id="journal-4471-notes" class="wiki"><p>Vey, what version of exiv2 are you using?</p></div>
    </div>
  </div>
  
  <div id="change-4473" class="journal has-notes">
    <div id="note-17">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-17" class="journal-link">#17</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/4035">Alan Pater</a> <a title="12 Nov 2015 19:39" href="/projects/exiv2/activity?from=2015-11-12">about 6 years</a> ago
      <span id="journal-4473-private_notes" class=""></span>
    </h4>

    <div id="journal-4473-notes" class="wiki"><p>Vey, so you are asking how to adapt the script sample from <a class="external" href="https://bugzilla.gnome.org/show_bug.cgi?id=712477#c6">https://bugzilla.gnome.org/show_bug.cgi?id=712477#c6</a> to your situation? I can't be much help, I just borrowed and adapted that script from elsewhere. It assumes exiv2 0.25 with the lr namespace and properties already registered. If you have 0.25 and it does not work, perhaps you have multiple exiv2 library versions installed and are getting conflicts.</p>


<pre>
#!/usr/bin/python3

from sys import argv, exit

try:
    from gi.repository import GExiv2
except ImportError:
    exit('You need to install gexiv2 first.')

if len(argv) &lt; 2:
    exit('Please specify an image on the commandline.')

# Note, these are equivalent:
metadata = GExiv2.Metadata()
metadata.open_path(argv[-1])
# metadata = GExiv2.Metadata(argv[-1])

tags = '1st|3rd|4th'
metadata['Xmp.lr.hierarchicalSubject'] = tags
if metadata['Xmp.lr.hierarchicalSubject.'] == tags:
    print('I just set the LR tags to %s.' % tags)
else:
    print('There was a problem setting the LR tags.')

# If you wanted to save your changes, call save_file:
metadata.save_file()
</pre>

	<p>You mentioned some DNG files. Have you tested that you can write XMP to those files from the exiv2 command line? It maybe that your DNG's are not yet writeable.</p></div>
    </div>
  </div>
  
  <div id="change-4474" class="journal has-notes">
    <div id="note-18">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-18" class="journal-link">#18</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/4544">Vey Zimba</a> <a title="12 Nov 2015 19:44" href="/projects/exiv2/activity?from=2015-11-12">about 6 years</a> ago
      <span id="journal-4474-private_notes" class=""></span>
    </h4>

    <div id="journal-4474-notes" class="wiki"><p>I'm using Exiv2 v0.25 as well. The problem is when I register 'lr' in Python (GExiv2) it registers hierarchicalSubject as XmpText instead of XmpBag.<br />pic.register_xmp_namespace('http://ns.adobe.com/lightroom/1.0/', 'lr')</p></div>
    </div>
  </div>
  
  <div id="change-4475" class="journal has-notes">
    <div id="note-19">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-19" class="journal-link">#19</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="12 Nov 2015 20:22" href="/projects/exiv2/activity?from=2015-11-12">about 6 years</a> ago
      <span id="journal-4475-private_notes" class=""></span>
    </h4>

    <div id="journal-4475-notes" class="wiki"><p>This seems to be working OK for me.  Here's what I see.</p>


	<p>I started with an image I took at Stonehenge in July.  It has Iptc,XMP and GPS data:<pre>rmills@rmillsmbp-k1504:~/gnu/exiv2/trunk$ cp /Home/Pictures/2015/Stonehenge/DSC_7146.jpg IMG_1234.JPG
rmills@rmillsmbp-k1504:~/gnu/exiv2/trunk$ exiv2 -pa --grep GPS --grep Iptc IMG_1234.JPG 
Exif.Image.GPSTag                            Long        1  4060
Exif.GPSInfo.GPSVersionID                    Byte        4  2.3.0.0
Exif.GPSInfo.GPSLatitudeRef                  Ascii       2  North
Exif.GPSInfo.GPSLatitude                     Rational    3  51deg 10.74120' 
Exif.GPSInfo.GPSLongitudeRef                 Ascii       2  West
Exif.GPSInfo.GPSLongitude                    Rational    3  1deg 49.58650' 
Exif.GPSInfo.GPSAltitudeRef                  Byte        1  Above sea level
Exif.GPSInfo.GPSAltitude                     Rational    1  97 m
Exif.GPSInfo.GPSTimeStamp                    Rational    3  14:34:09.2
Exif.GPSInfo.GPSSatellites                   Ascii       3  08
Exif.GPSInfo.GPSMapDatum                     Ascii      17  WGS-84          
Exif.GPSInfo.GPSDateStamp                    Ascii      11  2015:07:16
Iptc.Envelope.ModelVersion                   Short       1  4
Iptc.Envelope.CharacterSet                   String      3  
Iptc.Application2.RecordVersion              Short       1  4
Iptc.Application2.Caption                    String     18  Blackbird on Guard</pre>I've used the code here <a class="external" href="https://wiki.gnome.org/Projects/gexiv2/PythonSupport">https://wiki.gnome.org/Projects/gexiv2/PythonSupport</a> and put it in the file GnomeTest.py which operates on the file IMG_1234.JPG<pre>rmills@rmillsmbp-k1504:~/gnu/exiv2/trunk$ python GnomeTest.py 
rmills@rmillsmbp-k1504:~/gnu/exiv2/trunk$ exiv2 -pa --grep GPS --grep Iptc IMG_1234.JPG 
Exif.Image.GPSTag                            Long        1  4096
Exif.GPSInfo.GPSVersionID                    Byte        4  2.0.0.0
Exif.GPSInfo.GPSLatitudeRef                  Ascii       2  North
Exif.GPSInfo.GPSLatitude                     Rational    3  43deg 37' 46.221" 
Exif.GPSInfo.GPSLongitudeRef                 Ascii       2  West
Exif.GPSInfo.GPSLongitude                    Rational    3  79deg 23' 49.093" 
Exif.GPSInfo.GPSAltitudeRef                  Byte        1  Above sea level
Exif.GPSInfo.GPSAltitude                     Rational    1  76.0 m
Exif.GPSInfo.GPSMapDatum                     Ascii       7  WGS-84
Iptc.Envelope.ModelVersion                   Short       1  4
Iptc.Envelope.CharacterSet                   String      3  
Iptc.Application2.RecordVersion              Short       1  4
Iptc.Application2.Caption                    String     18  Blackbird on Guard
Iptc.Application2.City                       String      7  Toronto
Iptc.Application2.ProvinceState              String      7  Ontario
Iptc.Application2.CountryName                String      6  Canada</pre>Stonehenge has been instantly moved to Canada!.</p>


	<p>Then I modified Alan's code to operate on the file IMG_1234.py as follow:<pre>#!/usr/bin/python3

from sys import argv, exit

try:
    from gi.repository import GExiv2
except ImportError:
    exit('You need to install gexiv2 first.')

metadata = GExiv2.Metadata()
metadata.open_path('IMG_1234.JPG')

tags = '1st|3rd|4th'
metadata['Xmp.lr.hierarchicalSubject'] = tags
if metadata['Xmp.lr.hierarchicalSubject'] == tags:
    print('I just set the LR tags to %s.' % tags)
else:
    print('There was a problem setting the LR tags.')

# If you wanted to save your changes, call save_file:
metadata.save_file()</pre>Run Alan's code and dump the XMP:<pre>rmills@rmillsmbp-k1504:~/gnu/exiv2/trunk$ python AlanTest.py 
I just set the LR tags to 1st|3rd|4th.
rmills@rmillsmbp-k1504:~/gnu/exiv2/trunk$ exiv2 -pX IMG_1234.JPG | xmllint --pretty 2 -
&lt;?xml version="1.0"?&gt;
&lt;?xpacket
begin="" id="W5M0MpCehiHzreSzNTczkc9d"?&gt;
&lt;x:xmpmeta
    xmlns:x="adobe:ns:meta/" 
    x:xmptk="XMP Core 4.4.0-Exiv2" 
  &gt; &lt;rdf:RDF
      xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" 
    &gt; &lt;rdf:Description
        xmlns:xmp="http://ns.adobe.com/xap/1.0/" 
        xmlns:dc="http://purl.org/dc/elements/1.1/" 
        xmlns:lr="http://ns.adobe.com/lightroom/1.0/" 
        rdf:about="" 
        xmp:Rating="0" 
        xmp:ModifyDate="2015-07-16T20:24:52+01:00" 
      &gt; &lt;dc:description
        &gt; &lt;rdf:Alt
          &gt; &lt;rdf:li
              xml:lang="x-default" 
            &gt;Blackbird on Guard&lt;/rdf:li
          &gt; &lt;/rdf:Alt
        &gt; &lt;/dc:description
      &gt; &lt;lr:hierarchicalSubject
        &gt; &lt;rdf:Bag
          &gt; &lt;rdf:li
            &gt;1st|3rd|4th&lt;/rdf:li
          &gt; &lt;/rdf:Bag
        &gt; &lt;/lr:hierarchicalSubject
      &gt; &lt;/rdf:Description
    &gt; &lt;/rdf:RDF
  &gt; &lt;/x:xmpmeta
&gt;
&lt;?xpacket
end="w"?&gt;
rmills@rmillsmbp-k1504:~/gnu/exiv2/trunk$</pre>HierarcharchicalSubject is in a Bag.</p>


	<p>Does this look correct to you guys?</p></div>
    </div>
  </div>
  
  <div id="change-4695" class="journal has-details">
    <div id="note-20">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-20" class="journal-link">#20</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="13 Jan 2016 19:03" href="/projects/exiv2/activity?from=2016-01-13">almost 6 years</a> ago
      <span id="journal-4695-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>Resolved</i> to <i>Closed</i></li>
    </ul>
    
    </div>
  </div>
  


</div>

<div style="clear: both;"></div>
<div class="contextual">





</div>


<div style="clear: both;"></div>


<p class="other-formats">Also available in:  <span><a class="atom" rel="nofollow" href="/issues/1133.atom">Atom</a></span>
  <span><a class="pdf" rel="nofollow" href="/issues/1133.pdf">PDF</a></span>
</p>





        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
