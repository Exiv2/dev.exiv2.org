<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Feature #858: SVN repository download size - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="Em8auEB3beRJf4qRapvTz2YEFOriI2NFKRHq1hSDDK3wIrFXMg2h5BwblZ3VTN/8WZZAkxPAwv/UMXpeV7rrwg==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
    <link rel="alternate" type="application/atom+xml" title="Exiv2 - Feature #858: SVN repository download size" href="https://dev.exiv2.org/issues/858.atom" />
<script src="/javascripts/context_menu.js?1550767427"></script><link rel="stylesheet" media="screen" href="/stylesheets/context_menu.css?1550767427" /></head>
<body class="project-exiv2 has-main-menu controller-issues action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="issues" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="issues" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=issues" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=issues">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues selected" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="">
    <div id="sidebar">
          <h3>Issues</h3>

<ul>
<li><a href="/projects/exiv2/issues?set_filter=1">View all issues</a></li>
<li><a href="/projects/exiv2/issues/report">Summary</a></li>

</ul>









        
    </div>

    <div id="content">
        
        <div class="contextual">





</div>


<h2>Feature #858</h2>

<div class="issue tracker-2 status-5 priority-4 priority-default closed details">

  <div class="gravatar-with-child">
    
    
  </div>

<div class="subject">
<div><h3>SVN repository download size</h3></div>
</div>
        <p class="author">
        Added by <a class="user active" href="/users/2456">Daniel Kaneider</a> <a title="11 Oct 2012 05:16" href="/projects/exiv2/activity?from=2012-10-11">about 9 years</a> ago.
        Updated <a title="21 Jun 2015 16:42" href="/projects/exiv2/activity?from=2015-06-21">over 6 years</a> ago.
        </p>

<div class="attributes">
<div class="splitcontent"><div class="splitcontentleft"><div class="status attribute"><div class="label">Status:</div><div class="value">Closed</div></div><div class="priority attribute"><div class="label">Priority:</div><div class="value">Normal</div></div><div class="assigned-to attribute"><div class="label">Assignee:</div><div class="value"><a class="user active" href="/users/119">Robin Mills</a></div></div><div class="category attribute"><div class="label">Category:</div><div class="value">miscellaneous</div></div><div class="fixed-version attribute"><div class="label">Target version:</div><div class="value"><a title="17 May 2015" href="/versions/51">0.25</a></div></div></div><div class="splitcontentleft"><div class="start-date attribute"><div class="label">Start date:</div><div class="value">11 Oct 2012</div></div><div class="due-date attribute"><div class="label">Due date:</div><div class="value"></div></div><div class="progress attribute"><div class="label">% Done:</div><div class="value"><table class="progress progress-100"><tr><td style="width: 100%;" class="closed" title="100%"></td></tr></table><p class="percent">100%</p></div></div><div class="estimated-hours attribute"><div class="label">Estimated time:</div><div class="value">12.00 h</div></div></div></div>


</div>

<hr />
<div class="description">
  <div class="contextual">
  
  </div>

  <p><strong>Description</strong></p>
  <div class="wiki">
  <p>Hi,</p>


	<p>in every project where features are continuously added, extensive testing is pretty much important. It is also understandable that exiv2 needs a lot of input images, in order to achieve useful testing. But do you really need nearly 80MB of test data? <br />Checking out the svn repository takes ages. And since I prefer (fixed) svn versions for building, building time goes up. I observed that many images are tried to keep small, but the recently added videos alone take nearly 50MB!!!</p>


	<p>Therefore I suggest:</p>


	<ol>
	<li>Reduce the size of the test videos! IMHO they don't need to be 2 minutes long. Also reducing them in size could help a lot. Moreover I'm not sure if you are allowed to include a Vanilla Sky sequence in your repo (video-matroska.mkv). But again, I don't see a big benefit with those, which couldn't have achieved with smaller test videos.</li>
	</ol>


	<ol>
	<li>Split the repo up. Keeping your repo all together is important, I agree. Providing a possibility to exclude the test data can be important, too. Since you are using a subversion repository, you should have a look on svn:externals. <br />In this way you could define the test data external to the main repository. If users simply do checkout/updates they get those test data included by default. Then doing a checkout using <code>svn co --ignore-externals</code>, is a way to reduce the download size.</li>
	</ol>


	<p>Best,<br />Daniel</p>
  </div>
</div>







</div>

<div id="issue-changesets">
<h3>Associated revisions</h3>
    <div class="changeset">
    <p><a title="Revision 2918" href="/projects/exiv2/repository/exiv2/revisions/2918">Revision 2918</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/2918/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="19 Oct 2012 21:13" href="/projects/exiv2/activity?from=2012-10-19">about 9 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p>Fix: <a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: SVN repository download size (Closed)" href="/issues/858">#858</a>.  Download video data on demand.  More discussion in issue report.</p>
    </div>
    </div>

</div>



<div id="history">
<h3>History</h3>
  <div id="change-2264" class="journal has-notes has-details">
    <div id="note-1">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-1" class="journal-link">#1</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="11 Oct 2012 10:00" href="/projects/exiv2/activity?from=2012-10-11">about 9 years</a> ago
      <span id="journal-2264-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Assignee</strong> set to <i>Robin Mills</i></li>
       <li><strong>Target version</strong> set to <i>0.24</i></li>
       <li><strong>Estimated time</strong> set to <i>12.00 h</i></li>
    </ul>
    <div id="journal-2264-notes" class="wiki"><p>Daniel</p>


	<p>I think I'm in agreement about this.  I'd quite like to keep the test data in a different branch and the test scripts can get the test files on demand.  In that way, the user doesn't need to know about 'svn co --ignore-externals' and a regular 'svn checkout' is sufficient.  The data will be checked out once of course.</p>


	<p>I hear your comments about the video test data.  Our video code engineer is a student and developed this as a Google Summer of Code Project.  He's back at college and has many other matters on his mind.  So while I'm sure the video data could be reviewed and put on a diet, I'm not optimistic about having that done any time soon.  We're not a business, so we cannot prioritize/assign tasks to team members and then hold them accountable in their annual review!</p>


	<p>I'll assign this issue to myself and do something about having the test data downloaded (once) on demand.  This should decrease the size of our build tree from 93 to 16mb - a worthwhile improvement for all users.</p></div>
    </div>
  </div>
  
  <div id="change-2265" class="journal has-notes">
    <div id="note-2">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-2" class="journal-link">#2</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/2456">Daniel Kaneider</a> <a title="11 Oct 2012 10:56" href="/projects/exiv2/activity?from=2012-10-11">about 9 years</a> ago
      <span id="journal-2265-private_notes" class=""></span>
    </h4>

    <div id="journal-2265-notes" class="wiki"><p>In the case of a splitted repo, the size of the test data becomes less important. <br />Btw. this download process could also be done inside CMake using an option. If you split the repo up, I can provide you a patch.</p></div>
    </div>
  </div>
  
  <div id="change-2273" class="journal has-notes has-details">
    <div id="note-3">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-3" class="journal-link">#3</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="13 Oct 2012 23:25" href="/projects/exiv2/activity?from=2012-10-13">about 9 years</a> ago
      <span id="journal-2273-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>New</i> to <i>Assigned</i></li>
       <li><strong>% Done</strong> changed from <i>0</i> to <i>20</i></li>
    </ul>
    <div id="journal-2273-notes" class="wiki"><p>Daniel</p>


	<p>Thanks for you offer for a patch.  I've set up a new branch in our repository to hold test data.  My intention is to pull down the test files on demand from test/Makefile and avoid involving CMake (or CTest) in this.</p>


	<p>Our friend Shawn in China is working on Issue <a class="issue tracker-1 status-5 priority-4 priority-default closed" title="Bug: test harness does not run on CMake builds (Closed)" href="/issues/850">#850</a> which to make the test suite run correctly from CMake.  Shawn and I have been talking about using CTest, and adding code to CMakeLists.txt to run the tests from CMake.  However Shawn I don't want to complicate Shawn's work at this time.  I believe that pulling down the tests in test/Makefile is a simple way forward.</p></div>
    </div>
  </div>
  
  <div id="change-2284" class="journal has-notes has-details">
    <div id="note-4">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-4" class="journal-link">#4</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="19 Oct 2012 21:37" href="/projects/exiv2/activity?from=2012-10-19">about 9 years</a> ago
      <span id="journal-2284-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>% Done</strong> changed from <i>20</i> to <i>60</i></li>
    </ul>
    <div id="journal-2284-notes" class="wiki"><p>Stage 1 fix submitted: SVN: 2918.</p>


	<p>I've moved the video test files to a different location in our repository and they are downloaded on demand by the test suite.  This is removes 45mb of video data.  When we make our 0.24 release (expected late November), I'll move the eps data (24mb).  I can't remove that at present because it will break the published test notes on our web site at:  <a class="external" href="http://www.exiv2.org/download.html">http://www.exiv2.org/download.html</a></p>


	<p>I have retained all other tests for convenience.  With 0.24, the total size of a clean export of the trunk will be just over 20mb.</p>


	<p>Additionally, I've subdivided the tests into:</p>


	<p>make tests - runs the 'basic' tests<br />make teste - runs eps tests<br />make testv - runs video tests</p></div>
    </div>
  </div>
  
  <div id="change-2288" class="journal has-notes">
    <div id="note-5">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-5" class="journal-link">#5</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/2456">Daniel Kaneider</a> <a title="20 Oct 2012 05:46" href="/projects/exiv2/activity?from=2012-10-20">about 9 years</a> ago
      <span id="journal-2288-private_notes" class=""></span>
    </h4>

    <div id="journal-2288-notes" class="wiki"><p>Thank you Robin. Even though I consider downloading the test branch in CMake the better solution, your solution is fine for me. I'll see forward for the 0.24 release!</p></div>
    </div>
  </div>
  
  <div id="change-2289" class="journal has-notes">
    <div id="note-6">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-6" class="journal-link">#6</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="20 Oct 2012 06:06" href="/projects/exiv2/activity?from=2012-10-20">about 9 years</a> ago
      <span id="journal-2289-private_notes" class=""></span>
    </h4>

    <div id="journal-2289-notes" class="wiki"><p>Daniel</p>


	<p>I know I'd like to learn more about CMake from you, so I'm interested to know how to achieve this with CMake.  However we're not ready yet to abandon ./configure build and test.  As you know, changing config/configure.ac is seldom enjoyable.</p>


	<p>However good ideas are gold.  If you want to share, I'm happy to learn.  On the other hand, I know you're busy and I don't want to burden you with another task.</p>


	<p>Robin</p></div>
    </div>
  </div>
  
  <div id="change-2290" class="journal has-notes">
    <div id="note-7">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-7" class="journal-link">#7</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/2456">Daniel Kaneider</a> <a title="20 Oct 2012 08:58" href="/projects/exiv2/activity?from=2012-10-20">about 9 years</a> ago
      <span id="journal-2290-private_notes" class=""></span>
    </h4>

    <div id="journal-2290-notes" class="wiki"><p>Well, downloading the repo in CMake is quite easy with<br /><code>FIND_PACKAGE(Subversion)</code><br />Even for windows it's easy, since the program path can be passed to CMake on the command line, if the defaults don't work. I would say you would need around 5 lines of code to checkout the repo in CMake. However this shouldn't replace all the work which is currently done in config/configure, and this definitely requires much more effort. But if you do a <code>svn co</code> in configure or in CMake is more or less the same effort to do, except the fact the CMake could replace the makefiles somedays...</p></div>
    </div>
  </div>
  
  <div id="change-2291" class="journal has-notes">
    <div id="note-8">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-8" class="journal-link">#8</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="20 Oct 2012 09:18" href="/projects/exiv2/activity?from=2012-10-20">about 9 years</a> ago
      <span id="journal-2291-private_notes" class=""></span>
    </h4>

    <div id="journal-2291-notes" class="wiki"><p>Daniel</p>


	<p>Thank you for those suggestions.  I'm hoping that we'll be able to dump Makefile/.vcproj/.sln/.ac files by the end of next year.  I hope to say in the 0.24 release notes (Nov 2012) that 0.25 (May 2013) will be the final release in which msvc/msvc64/config directories will be be provided. When we have a CMake only build, we'll use CTest/CDash to drive the tests.  However between now and then, what's been done is sufficient and works on all our platforms.</p>


	<p>Robin</p></div>
    </div>
  </div>
  
  <div id="change-2583" class="journal has-notes has-details">
    <div id="note-9">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-9" class="journal-link">#9</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="24 Jul 2013 16:01" href="/projects/exiv2/activity?from=2013-07-24">over 8 years</a> ago
      <span id="journal-2583-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Target version</strong> changed from <i>0.24</i> to <i>0.25</i></li>
    </ul>
    <div id="journal-2583-notes" class="wiki"><p>The video code have been moved in 0.24.  The EPS test files will be moved in 0.25.</p></div>
    </div>
  </div>
  
  <div id="change-3028" class="journal has-notes has-details">
    <div id="note-10">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-10" class="journal-link">#10</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="27 Dec 2014 11:57" href="/projects/exiv2/activity?from=2014-12-27">almost 7 years</a> ago
      <span id="journal-3028-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>Assigned</i> to <i>Resolved</i></li>
    </ul>
    <div id="journal-3028-notes" class="wiki"><p>eps files have been moved to testdata/trunk and make teste downloads files on demand.</p>


	<p>The data copied using svn export svn://dev.exiv2.org/svn/trunk has been decreased from 52 to 29mb  <pre>$ rm -rf trunk; svn export svn://dev.exiv2.org/svn/trunk --revision 3200 &gt;/dev/null ;du -m trunk | tail -1 
52    trunk
$ rm -rf trunk; svn export svn://dev.exiv2.org/svn/trunk --revision HEAD &gt;/dev/null ;du -m trunk | tail -1 
29    trunk</pre> This has reduced a "compressed" trunk from 12 to 7mb.  <pre>$ tar czf t.tar.gz t 
$ ls -alt t.tar.gz
-rw-r--r--  1 rmills  staff  7350265 27 Dec 11:42 t.tar.gz</pre></p></div>
    </div>
  </div>
  
  <div id="change-3671" class="journal has-details">
    <div id="note-11">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-11" class="journal-link">#11</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="08 May 2015 16:38" href="/projects/exiv2/activity?from=2015-05-08">over 6 years</a> ago
      <span id="journal-3671-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>% Done</strong> changed from <i>60</i> to <i>100</i></li>
    </ul>
    
    </div>
  </div>
  
  <div id="change-3914" class="journal has-details">
    <div id="note-12">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-12" class="journal-link">#12</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="21 Jun 2015 16:42" href="/projects/exiv2/activity?from=2015-06-21">over 6 years</a> ago
      <span id="journal-3914-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>Resolved</i> to <i>Closed</i></li>
    </ul>
    
    </div>
  </div>
  


</div>

<div style="clear: both;"></div>
<div class="contextual">





</div>


<div style="clear: both;"></div>


<p class="other-formats">Also available in:  <span><a class="atom" rel="nofollow" href="/issues/858.atom">Atom</a></span>
  <span><a class="pdf" rel="nofollow" href="/issues/858.pdf">PDF</a></span>
</p>





        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
