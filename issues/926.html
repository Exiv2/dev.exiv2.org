<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Bug #926: Lens matching on Canon - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="7VF0v4vbNL6r8dqA9oT54GRNXTwNDwHoZnPIDvpo1TcPHN9Q+aH4vv6VxYxJU/XTW98JRfzsoFKbU1iGuVEyWA==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
    <link rel="alternate" type="application/atom+xml" title="Exiv2 - Bug #926: Lens matching on Canon" href="https://dev.exiv2.org/issues/926.atom" />
<script src="/javascripts/context_menu.js?1550767427"></script><link rel="stylesheet" media="screen" href="/stylesheets/context_menu.css?1550767427" /></head>
<body class="project-exiv2 has-main-menu controller-issues action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="issues" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="issues" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=issues" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=issues">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues selected" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="">
    <div id="sidebar">
          <h3>Issues</h3>

<ul>
<li><a href="/projects/exiv2/issues?set_filter=1">View all issues</a></li>
<li><a href="/projects/exiv2/issues/report">Summary</a></li>

</ul>









        
    </div>

    <div id="content">
        
        <div class="contextual">





</div>


<h2>Bug #926</h2>

<div class="issue tracker-1 status-5 priority-4 priority-default closed details">

  <div class="gravatar-with-child">
    
    
  </div>

<div class="subject">
<div><h3>Lens matching on Canon</h3></div>
</div>
        <p class="author">
        Added by <a class="user active" href="/users/3970">Steve Fosdick</a> <a title="13 Oct 2013 17:14" href="/projects/exiv2/activity?from=2013-10-13">about 8 years</a> ago.
        Updated <a title="21 Jun 2015 16:42" href="/projects/exiv2/activity?from=2015-06-21">over 6 years</a> ago.
        </p>

<div class="attributes">
<div class="splitcontent"><div class="splitcontentleft"><div class="status attribute"><div class="label">Status:</div><div class="value">Closed</div></div><div class="priority attribute"><div class="label">Priority:</div><div class="value">Normal</div></div><div class="assigned-to attribute"><div class="label">Assignee:</div><div class="value"><a class="user active" href="/users/134">Niels Kristian Bech Jensen</a></div></div><div class="category attribute"><div class="label">Category:</div><div class="value">metadata</div></div><div class="fixed-version attribute"><div class="label">Target version:</div><div class="value"><a title="17 May 2015" href="/versions/51">0.25</a></div></div></div><div class="splitcontentleft"><div class="start-date attribute"><div class="label">Start date:</div><div class="value">13 Oct 2013</div></div><div class="due-date attribute"><div class="label">Due date:</div><div class="value">31 Aug 2014</div></div><div class="progress attribute"><div class="label">% Done:</div><div class="value"><table class="progress progress-100"><tr><td style="width: 100%;" class="closed" title="100%"></td></tr></table><p class="percent">100%</p></div></div><div class="estimated-hours attribute"><div class="label">Estimated time:</div><div class="value"></div></div></div></div>


</div>

<hr />
<div class="description">
  <div class="contextual">
  
  </div>

  <p><strong>Description</strong></p>
  <div class="wiki">
  <p>I am currently having trouble with the recognition of a Sigma 150-500mm f/5-6.3 lens on Canon. This lens gives a lens ID of 174 and I recently submitted a patch (issue 921) to include this lens in the list embedded in canonmn.cpp. This works for some pictures and not others.</p>


	<p>Eviv2 was changed recently to take the maximum aperture of a lens into account for some ID numbers and looking at those pictures where the lens is recognised correctly versus those where it is not what I believe is happening is that the lens reports the maximum aperture for the focal length it is currently set to whereas the code in canonmn.cpp assumes the lens will report the maximum aperture at any focal length. Thus depending on the focal length for that picture the maximum aperture value either matches or doesn't.</p>


	<p>Any idea how to resolve this?</p>


	<p>BTW I have reported this as a separate issue because I suspect it will affect more than just this lens, i.e. any case where a variable aperture zoom appears in an ID conflict.</p>
  </div>
</div>
  <hr />
  <p><strong>Files</strong></p>
  <div class="attachments">
<div class="contextual">
  
</div>
<table>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/560">20131014_163513_1136.jpg</a>    <span class="size">(528 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/560/20131014_163513_1136.jpg">20131014_163513_1136.jpg</a>  </td>
  <td>Test picture at 150mm, max aperture F5, lens reported correctly</td>
  <td>
      <span class="author">Steve Fosdick, 14 Oct 2013 08:51</span>
  </td>
  <td>
  </td>
</tr>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/561">20131014_163522_1137.jpg</a>    <span class="size">(502 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/561/20131014_163522_1137.jpg">20131014_163522_1137.jpg</a>  </td>
  <td>Test picture at 174mm, max aperture F5.7, lens not recognised</td>
  <td>
      <span class="author">Steve Fosdick, 14 Oct 2013 08:51</span>
  </td>
  <td>
  </td>
</tr>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/562">20131014_163556_1142.jpg</a>    <span class="size">(499 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/562/20131014_163556_1142.jpg">20131014_163556_1142.jpg</a>  </td>
  <td>Test picture at 313mm, max aperture F6.2, lens not recognised</td>
  <td>
      <span class="author">Steve Fosdick, 14 Oct 2013 08:51</span>
  </td>
  <td>
  </td>
</tr>
</table>
</div>







<hr />
<div id="relations">
<div class="contextual">
</div>

<p><strong>Related issues</strong></p>

<form data-cm-url="/issues/context_menu" action="/issues/926" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="65mH/NSVa1Q9IDMh4LNgeRHxZYUIJK5K0gY0BVP7txYJ1CwTpu+nVGhELC1fZGxKLmMx/PnHD/AvJqSNEMJQeQ==" />
  <table class="list issues odd-even"><tr id="relation-105" class="issue hascontextmenu issue tracker-1 status-5 priority-4 priority-default closed"><td class="checkbox"><input type="checkbox" name="ids[]" value="927" /></td><td class="subject" style="width: 50%">Related to Exiv2 - <a class="issue tracker-1 status-5 priority-4 priority-default closed" href="/issues/927">Bug #927</a>: Sigma Lens Not detected</td><td class="status">Closed</td><td class="start_date">18 Oct 2013</td><td class="due_date">31 Aug 2014</td><td class="done_ratio"><table class="progress progress-100"><tr><td style="width: 100%;" class="closed" title="100%"></td></tr></table><p class="percent"></p></td><td class="buttons"><a title="Actions" class="icon-only icon-actions js-contextmenu" href="#">Actions</a></td></tr><tr id="relation-106" class="issue hascontextmenu issue tracker-1 status-5 priority-4 priority-default closed"><td class="checkbox"><input type="checkbox" name="ids[]" value="938" /></td><td class="subject" style="width: 50%">Related to Exiv2 - <a class="issue tracker-1 status-5 priority-4 priority-default closed" href="/issues/938">Bug #938</a>: Tamron 18-270 is not detected anymore</td><td class="status">Closed</td><td class="start_date">18 Dec 2013</td><td class="due_date">31 Aug 2014</td><td class="done_ratio"><table class="progress progress-100"><tr><td style="width: 100%;" class="closed" title="100%"></td></tr></table><p class="percent"></p></td><td class="buttons"><a title="Actions" class="icon-only icon-actions js-contextmenu" href="#">Actions</a></td></tr><tr id="relation-110" class="issue hascontextmenu issue tracker-4 status-5 priority-4 priority-default closed"><td class="checkbox"><input type="checkbox" name="ids[]" value="982" /></td><td class="subject" style="width: 50%">Related to Exiv2 - <a class="issue tracker-4 status-5 priority-4 priority-default closed" href="/issues/982">Patch #982</a>: Improve detection of Canon lenses sharing the same IDs</td><td class="status">Closed</td><td class="start_date">15 Aug 2014</td><td class="due_date">31 Aug 2014</td><td class="done_ratio"><table class="progress progress-100"><tr><td style="width: 100%;" class="closed" title="100%"></td></tr></table><p class="percent"></p></td><td class="buttons"><a title="Actions" class="icon-only icon-actions js-contextmenu" href="#">Actions</a></td></tr></table>
</form>
<form class="new_relation" id="new-relation-form" style="display: none;" action="/issues/926/relations" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" />


<p><select onchange="setPredecessorFieldsVisibility();" name="relation[relation_type]" id="relation_relation_type"><option selected="selected" value="relates">Related to</option>
<option value="duplicates">Is duplicate of</option>
<option value="duplicated">Has duplicate</option>
<option value="blocks">Blocks</option>
<option value="blocked">Blocked by</option>
<option value="precedes">Precedes</option>
<option value="follows">Follows</option>
<option value="copied_to">Copied to</option>
<option value="copied_from">Copied from</option></select>
Issue #<input size="10" type="text" name="relation[issue_to_id]" id="relation_issue_to_id" />
<span id="predecessor_fields" style="display:none;">
Delay: <input size="3" type="text" name="relation[delay]" id="relation_delay" /> days
</span>
<input type="submit" name="commit" value="Add" data-disable-with="Add" />
<a href="#" onclick="$(&quot;#new-relation-form&quot;).hide();; return false;">Cancel</a>
</p>

<script>
//<![CDATA[
observeAutocompleteField('relation_issue_to_id', '/issues/auto_complete?issue_id=926&project_id=exiv2&scope=all')
//]]>
</script>

<script>
//<![CDATA[
setPredecessorFieldsVisibility();
//]]>
</script>

</form>
</div>

</div>

<div id="issue-changesets">
<h3>Associated revisions</h3>
    <div class="changeset">
    <p><a title="Revision 3340" href="/projects/exiv2/repository/exiv2/revisions/3340">Revision 3340</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/3340/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/134">Niels Kristian Bech Jensen</a> <a title="30 Aug 2014 21:00" href="/projects/exiv2/activity?from=2014-08-30">about 7 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p>Fix issue <a class="issue tracker-4 status-5 priority-4 priority-default closed" title="Patch: Improve detection of Canon lenses sharing the same IDs (Closed)" href="/issues/982">#982</a>: Improve detection of Canon lenses sharing the same IDs. Also fixes issues <a class="issue tracker-1 status-5 priority-4 priority-default closed" title="Bug: Lens matching on Canon (Closed)" href="/issues/926">#926</a>, <a class="issue tracker-1 status-5 priority-4 priority-default closed" title="Bug: Sigma Lens Not detected (Closed)" href="/issues/927">#927</a>, and <a class="issue tracker-1 status-5 priority-4 priority-default closed" title="Bug: Tamron 18-270 is not detected anymore (Closed)" href="/issues/938">#938</a>. Thanks goes to Alexander Steffen for the patch.</p>
    </div>
    </div>

</div>



<div id="history">
<h3>History</h3>
  <div id="change-2636" class="journal has-notes has-details">
    <div id="note-1">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-1" class="journal-link">#1</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/134">Niels Kristian Bech Jensen</a> <a title="14 Oct 2013 06:34" href="/projects/exiv2/activity?from=2013-10-14">about 8 years</a> ago
      <span id="journal-2636-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Category</strong> set to <i>metadata</i></li>
       <li><strong>Assignee</strong> set to <i>Niels Kristian Bech Jensen</i></li>
       <li><strong>Target version</strong> set to <i>0.25</i></li>
    </ul>
    <div id="journal-2636-notes" class="wiki"><p>Hi Steve.</p>


	<p>Would it be possible for you to attach some test images to this report? I would like some images where the lens is detected correctly and some where it is not detected. Small JPEGs with full EXIF data are fine.</p>


	<p>Best regards,<br />Niels Kristian Bech Jensen</p></div>
    </div>
  </div>
  
  <div id="change-2637" class="journal has-notes has-details">
    <div id="note-2">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-2" class="journal-link">#2</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/3970">Steve Fosdick</a> <a title="14 Oct 2013 08:51" href="/projects/exiv2/activity?from=2013-10-14">about 8 years</a> ago
      <span id="journal-2637-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>File</strong> <a href="/attachments/560">20131014_163513_1136.jpg</a> <a class="icon-only icon-download" title="Download" href="/attachments/download/560/20131014_163513_1136.jpg">20131014_163513_1136.jpg</a> added</li>
       <li><strong>File</strong> <a href="/attachments/561">20131014_163522_1137.jpg</a> <a class="icon-only icon-download" title="Download" href="/attachments/download/561/20131014_163522_1137.jpg">20131014_163522_1137.jpg</a> added</li>
       <li><strong>File</strong> <a href="/attachments/562">20131014_163556_1142.jpg</a> <a class="icon-only icon-download" title="Download" href="/attachments/download/562/20131014_163556_1142.jpg">20131014_163556_1142.jpg</a> added</li>
    </ul>
    <div id="journal-2637-notes" class="wiki"><p>Here are some pictures going through the zoom range.  There are more pictures in the set but here I have included one picture for each distinct maximum aperture reported by the lens and only the one where the maximum aperture is reported as F5 works correctly.</p></div>
    </div>
  </div>
  
  <div id="change-2638" class="journal has-details">
    <div id="note-3">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-3" class="journal-link">#3</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/134">Niels Kristian Bech Jensen</a> <a title="15 Oct 2013 04:55" href="/projects/exiv2/activity?from=2013-10-15">about 8 years</a> ago
      <span id="journal-2638-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>New</i> to <i>Assigned</i></li>
    </ul>
    
    </div>
  </div>
  
  <div id="change-2860" class="journal has-notes has-details">
    <div id="note-4">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-4" class="journal-link">#4</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/134">Niels Kristian Bech Jensen</a> <a title="30 Aug 2014 21:11" href="/projects/exiv2/activity?from=2014-08-30">about 7 years</a> ago
      <span id="journal-2860-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Due date</strong> set to <i>31 Aug 2014</i></li>
       <li><strong>Status</strong> changed from <i>Assigned</i> to <i>Resolved</i></li>
    </ul>
    <div id="journal-2860-notes" class="wiki"><p>Fixed by <a class="changeset" title="Fix issue #982: Improve detection of Canon lenses sharing the same IDs. Also fixes issues #926, #..." href="/projects/exiv2/repository/exiv2/revisions/3340">r3340</a>.</p>


	<p>Best regards,<br />Niels Kristian Bech Jensen</p></div>
    </div>
  </div>
  
  <div id="change-2861" class="journal has-details">
    <div id="note-5">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-5" class="journal-link">#5</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/134">Niels Kristian Bech Jensen</a> <a title="30 Aug 2014 21:11" href="/projects/exiv2/activity?from=2014-08-30">about 7 years</a> ago
      <span id="journal-2861-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>% Done</strong> changed from <i>0</i> to <i>100</i></li>
    </ul>
    
    </div>
  </div>
  
  <div id="change-3927" class="journal has-details">
    <div id="note-6">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-6" class="journal-link">#6</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="21 Jun 2015 16:42" href="/projects/exiv2/activity?from=2015-06-21">over 6 years</a> ago
      <span id="journal-3927-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Status</strong> changed from <i>Resolved</i> to <i>Closed</i></li>
    </ul>
    
    </div>
  </div>
  


</div>

<div style="clear: both;"></div>
<div class="contextual">





</div>


<div style="clear: both;"></div>


<p class="other-formats">Also available in:  <span><a class="atom" rel="nofollow" href="/issues/926.atom">Atom</a></span>
  <span><a class="pdf" rel="nofollow" href="/issues/926.pdf">PDF</a></span>
</p>





        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
