<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Bug #1206: In specific Canon makernote tags, certain values are meant to be ignored - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="JC1s5DySbzMjGxSoQzi1dntdwaUxyik2QwyjPvP9A2vGYMcLTuijM3Z/C6T877lFRM+V3MApiIy+LDO2sMTkBA==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
    <link rel="alternate" type="application/atom+xml" title="Exiv2 - Bug #1206: In specific Canon makernote tags, certain values are meant to be ignored" href="https://dev.exiv2.org/issues/1206.atom" />
<script src="/javascripts/context_menu.js?1550767427"></script><link rel="stylesheet" media="screen" href="/stylesheets/context_menu.css?1550767427" /></head>
<body class="project-exiv2 has-main-menu controller-issues action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="issues" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="issues" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=issues" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=issues">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues selected" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="">
    <div id="sidebar">
          <h3>Issues</h3>

<ul>
<li><a href="/projects/exiv2/issues?set_filter=1">View all issues</a></li>
<li><a href="/projects/exiv2/issues/report">Summary</a></li>

</ul>









        
    </div>

    <div id="content">
        
        <div class="contextual">





</div>


<h2>Bug #1206</h2>

<div class="issue tracker-1 status-2 priority-4 priority-default details">
    <div class="next-prev-links contextual">
      <a title="#1219" accesskey="p" href="/issues/1219">« Previous</a> |
        <span class="position">
          <a href="/issues?f%5B%5D=status_id&amp;op%5Bstatus_id%5D=o&amp;page=2&amp;per_page=25&amp;set_filter=1&amp;sort=updated_on%3Adesc%2Cid%3Adesc&amp;v%5Bstatus_id%5D%5B%5D=">43 of 78</a>
        </span> |
      <a title="#1205" accesskey="n" href="/issues/1205">Next »</a>
    </div>

  <div class="gravatar-with-child">
    
    
  </div>

<div class="subject">
<div><h3>In specific Canon makernote tags, certain values are meant to be ignored</h3></div>
</div>
        <p class="author">
        Added by <a class="user active" href="/users/4728">Sridhar Boovaraghavan</a> <a title="13 Aug 2016 09:55" href="/projects/exiv2/activity?from=2016-08-13">over 5 years</a> ago.
        Updated <a title="31 Aug 2016 15:11" href="/projects/exiv2/activity?from=2016-08-31">about 5 years</a> ago.
        </p>

<div class="attributes">
<div class="splitcontent"><div class="splitcontentleft"><div class="status attribute"><div class="label">Status:</div><div class="value">Assigned</div></div><div class="priority attribute"><div class="label">Priority:</div><div class="value">Normal</div></div><div class="assigned-to attribute"><div class="label">Assignee:</div><div class="value"><a class="user active" href="/users/4728">Sridhar Boovaraghavan</a></div></div><div class="category attribute"><div class="label">Category:</div><div class="value">metadata</div></div><div class="fixed-version attribute"><div class="label">Target version:</div><div class="value"><a title="31 Dec 2020" href="/versions/54">0.28</a></div></div></div><div class="splitcontentleft"><div class="start-date attribute"><div class="label">Start date:</div><div class="value">13 Aug 2016</div></div><div class="due-date attribute"><div class="label">Due date:</div><div class="value"></div></div><div class="progress attribute"><div class="label">% Done:</div><div class="value"><table class="progress progress-0"><tr><td style="width: 100%;" class="todo"></td></tr></table><p class="percent">0%</p></div></div><div class="estimated-hours attribute"><div class="label">Estimated time:</div><div class="value"></div></div></div></div>


</div>

<hr />
<div class="description">
  <div class="contextual">
  
  </div>

  <p><strong>Description</strong></p>
  <div class="wiki">
  <p>We already saw in Issue <a class="issue tracker-1 status-2 priority-4 priority-default" title="Bug: Exif.CanonCs.FocusContinuous reported as Short (Assigned)" href="/issues/1203">#1203</a> that certain canon makernote tags were returning values of incorrect type.</p>


	<p>Further investigation (basically, a comparison with exiftool, see notes attached to Issue <a class="issue tracker-1 status-2 priority-4 priority-default" title="Bug: Exif.CanonCs.FocusContinuous reported as Short (Assigned)" href="/issues/1203">#1203</a>) make it clear that some of the returned values are defaults that are meant to be ignored.</p>


	<p>A selection of these are listed below. The table contains the tag name and the value which if it has, should be ignored.</p>


	<p>There are other tag values that need to be ignored as well, but those are in the form of values needing to be >0 etc.</p>


	<p>A good start would be to implement a filter type function that defines for each tag what an ignorable value means. If this function returns true, then we return ed.end() when the user calls findMetadatum.</p>


	<p>Exif.CanonCs.RecordMode -1<br />Exif.CanonCs.Contrast 0x7fff<br />Exif.CanonCs.Saturation 0x7fff<br />Exif.CanonCs.Sharpness 0x7fff<br />Exif.CanonCs.CameraISO 0x7fff<br />Exif.CanonCs.AFPoint 0<br />Exif.CanonCs.FlashActivity -1<br />Exif.CanonCs.FocusContinuous -1<br />Exif.CanonCs.AESetting -1<br />Exif.CanonCs.ImageStabilization -1<br />Exif.CanonCs.SpotMeteringMode -1<br />Exif.CanonCs.PhotoEffect -1<br />Exif.CanonCs.ColorTone 0x7fff<br />Exif.CanonCs.SRAWQuality -1<br />Exif.CanonSi.FlashGuideNumber -1<br />Exif.CanonSi.AFPointsInFocus 0<br />Exif.CanonMi.FrameRate 65535<br />Exif.CanonMi.FrameCount 65535<br />Exif.CanonFi.FilterEffect -1<br />Exif.CanonFi.ToningEffect -1</p>
  </div>
</div>






<hr />
<div id="relations">
<div class="contextual">
</div>

<p><strong>Related issues</strong></p>

<form data-cm-url="/issues/context_menu" action="/issues/1206" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="h/87tKcbPvDt9dQ5ubZRSEAGX+l21RYbT3OEk00puF1lspBb1WHy8LiRyzUGYV17f5QLkIc2t6GyUxQbDhBfMg==" />
  <table class="list issues odd-even"><tr id="relation-236" class="issue hascontextmenu issue tracker-1 status-2 priority-4 priority-default"><td class="checkbox"><input type="checkbox" name="ids[]" value="1203" /></td><td class="subject" style="width: 50%">Related to Exiv2 - <a class="issue tracker-1 status-2 priority-4 priority-default" href="/issues/1203">Bug #1203</a>: Exif.CanonCs.FocusContinuous reported as Short</td><td class="status">Assigned</td><td class="start_date">11 Aug 2016</td><td class="due_date"></td><td class="done_ratio"><table class="progress progress-0"><tr><td style="width: 100%;" class="todo"></td></tr></table><p class="percent"></p></td><td class="buttons"><a title="Actions" class="icon-only icon-actions js-contextmenu" href="#">Actions</a></td></tr><tr id="relation-241" class="issue hascontextmenu issue tracker-2 status-2 priority-4 priority-default"><td class="checkbox"><input type="checkbox" name="ids[]" value="1219" /></td><td class="subject" style="width: 50%">Related to Exiv2 - <a class="issue tracker-2 status-2 priority-4 priority-default" href="/issues/1219">Feature #1219</a>: Adding Camera Temperature</td><td class="status">Assigned</td><td class="start_date">31 Aug 2016</td><td class="due_date"></td><td class="done_ratio"><table class="progress progress-30"><tr><td style="width: 30%;" class="closed" title="30%"></td><td style="width: 70%;" class="todo"></td></tr></table><p class="percent"></p></td><td class="buttons"><a title="Actions" class="icon-only icon-actions js-contextmenu" href="#">Actions</a></td></tr></table>
</form>
<form class="new_relation" id="new-relation-form" style="display: none;" action="/issues/1206/relations" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" />


<p><select onchange="setPredecessorFieldsVisibility();" name="relation[relation_type]" id="relation_relation_type"><option selected="selected" value="relates">Related to</option>
<option value="duplicates">Is duplicate of</option>
<option value="duplicated">Has duplicate</option>
<option value="blocks">Blocks</option>
<option value="blocked">Blocked by</option>
<option value="precedes">Precedes</option>
<option value="follows">Follows</option>
<option value="copied_to">Copied to</option>
<option value="copied_from">Copied from</option></select>
Issue #<input size="10" type="text" name="relation[issue_to_id]" id="relation_issue_to_id" />
<span id="predecessor_fields" style="display:none;">
Delay: <input size="3" type="text" name="relation[delay]" id="relation_delay" /> days
</span>
<input type="submit" name="commit" value="Add" data-disable-with="Add" />
<a href="#" onclick="$(&quot;#new-relation-form&quot;).hide();; return false;">Cancel</a>
</p>

<script>
//<![CDATA[
observeAutocompleteField('relation_issue_to_id', '/issues/auto_complete?issue_id=1206&project_id=exiv2&scope=all')
//]]>
</script>

<script>
//<![CDATA[
setPredecessorFieldsVisibility();
//]]>
</script>

</form>
</div>

</div>

<div id="issue-changesets">
<h3>Associated revisions</h3>
    <div class="changeset">
    <p><a title="Revision 4438" href="/projects/exiv2/repository/exiv2/revisions/4438">Revision 4438</a>
        (<a href="/projects/exiv2/repository/exiv2/revisions/4438/diff">diff</a>)
        <br />
        <span class="author">Added by <a class="user active" href="/users/4728">Sridhar Boovaraghavan</a> <a title="26 Aug 2016 05:36" href="/projects/exiv2/activity?from=2016-08-26">about 5 years</a> ago</span></p>
    <div class="wiki changeset-comments">
        <p>This is mainly a fix for <a class="issue tracker-1 status-2 priority-4 priority-default" title="Bug: In specific Canon makernote tags, certain values are meant to be ignored (Assigned)" href="/issues/1206">#1206</a>, but also interprets missing Canon Exif<br />Tags in exiv2 with the help of Phil Harvey's exiftool (see<br /><a class="external" href="http://www.sno.phy.queensu.ca/~phil/exiftool/TagNames/Canon.html">http://www.sno.phy.queensu.ca/~phil/exiftool/TagNames/Canon.html</a>).</p>


	<p>Even with these changes (toward <a class="issue tracker-1 status-2 priority-4 priority-default" title="Bug: Add missing detail to canonCsEasyMode in canonmn.cpp (Assigned)" href="/issues/1204">#1204</a> and <a class="issue tracker-1 status-2 priority-4 priority-default" title="Bug: For Sharpness use Exif.CanonPr.Sharpness instead of Exif.CanonCs.Sharpness in easyaccess.cpp (Assigned)" href="/issues/1205">#1205</a>), exiv2 lags behind<br />exiftool in some areas of interpretation of Canon tags. Ideally, a<br />catch-up effort to bring the code in source: canonmn.cpp in line with<br />lib/Image/ExifTool/Canon.pm. v10.25 of exiftool was used as reference<br />for this change.</p>


	<p><a class="issue tracker-1 status-2 priority-4 priority-default" title="Bug: In specific Canon makernote tags, certain values are meant to be ignored (Assigned)" href="/issues/1206">#1206</a> seeks to address the fact that when Canon does not have data for<br />certain tags, they use specific default values in those fields. These<br />default values need to be ignored and not displayed. This change<br />brings this feature to exiv2, something that already exiftool does.</p>


	<p>With regards to implementation, the struct TagInfo in source: tags.hpp<br />is extended with four new fields.</p>


	<p>The first field is a bool that if set to true (default false), denotes<br />that this field has ignorable default values.</p>


	<p>The second field is the default value that needs to be ignored. This<br />can be of four types (String, Long, Float, Rational). These four types<br />were chosen as they had conversion functions in the Value class.</p>


	<p>The third field is the comparison type (default equal_to). There are<br />six comparison types possible (equal_to, not_equal_to, less,<br />less_equal, greater, greater_equal). This is the comparison applied to<br />the value stored in the tag's field and the default value specified<br />above. For e.g. if the value in the tag Exif.CanonCs.RecordMode is -1,<br />then it needs to be ignored.</p>


	<p>The fourth field is the data type (default Long). This could have been<br />guessed from the type of the second field, but that would necessitate<br />making this structure into a template calling for changes in multitude<br />of files.</p>


	<p>Usage: In source: canonmn.cpp, several exif tags now have ignorable<br />default properties. I will list a few examples.</p>


	<p>1. Exif.CanonCs.FocusMode:        TagInfo(0x0007, "FocusMode", N_("Focus Mode"), N_("Focus mode setting"), canonCsId, makerTags, signedShort, 1, EXV_PRINT_TAG(canonCsFocusMode)),</p>


	<p>There are no changes - i.e. this is an example of how the TagInfo<br />structure was being populated.</p>


	<p>2. Exif.CanonCs.RecordMode:        TagInfo(0x0009, "RecordMode", N_("Record Mode"), N_("Record mode setting"), canonCsId, makerTags, signedShort, 1, EXV_PRINT_TAG(canonCsRecordMode), true, s_1_),</p>


	<p>Take a look at the two new arguments. The first one (true) specifies<br />that there is a default value that can be ignored. The second one s_1_<br />specifies the value (-1, in this case) to be ignored.</p>
	<pre><code>const UShortValue CanonMakerNote::s_1_(65535, unsignedShort); // Till bug is resolved</code></pre>


	<p>Note s_1_ is temporarily having the value 65535 till <a class="issue tracker-1 status-2 priority-4 priority-default" title="Bug: Exif.CanonCs.FocusContinuous reported as Short (Assigned)" href="/issues/1203">#1203</a> that causes<br />signedShorts to be interpreted as unsignedShorts is resolved.</p>


	<p>3. Exif.CanonSi.TargetAperture:         TagInfo(0x0004, "TargetAperture", N_("Target Aperture"), N_("Target Aperture"), canonSiId, makerTags, unsignedShort, 1, printSi0x0015, true, us0_, TagInfo::less_equal),</p>


	<p>Note the third argument TagInfo::less_equal. This combined with the<br />second argument us0_ (the number 0) signifies that any values in this<br />tag that are less than or equal (<=) to 0 should be ignored.</p>


	<p>4.         TagInfo(0x0028, "ImageUniqueID", N_("Image Unique ID"), N_("Image Unique ID"), canonId, makerTags, asciiString, -1, printValue, true, s0x16_, TagInfo::equal_to, TagInfo::String),</p>


	<p>The previous examples have all been of Long type. This shows a case<br />where the default value is a string.</p>
	<pre><code>const AsciiValue CanonMakerNote::s0x16_("0000000000000000");</code></pre>


	<p>Once these tag values have been defined, the actual mechanics of<br />ignoring these default values happens in Image::exifData().</p>


	<p>Before the exifData is returned, we loop through the data, ask the<br />data whether it needs to be ignored (which in turn checks its<br />underlying tagInfo and compares it with the default value, if<br />specified) and if so, deletes that element.</p>


	<p>A compile-time switch called EXV_DONT_IGNORE_UNDEFINED which when set<br />to a non-zero value will cause the behavior to revert back to the<br />original where all values are reported irregardless of the fact that<br />they need to be ignored.</p>
    </div>
    </div>

</div>



<div id="history">
<h3>History</h3>
  <div id="change-5313" class="journal has-details">
    <div id="note-1">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-1" class="journal-link">#1</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/4728">Sridhar Boovaraghavan</a> <a title="13 Aug 2016 10:02" href="/projects/exiv2/activity?from=2016-08-13">over 5 years</a> ago
      <span id="journal-5313-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Priority</strong> changed from <i>Normal</i> to <i>High</i></li>
    </ul>
    
    </div>
  </div>
  
  <div id="change-5314" class="journal has-notes has-details">
    <div id="note-2">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-2" class="journal-link">#2</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="13 Aug 2016 10:21" href="/projects/exiv2/activity?from=2016-08-13">over 5 years</a> ago
      <span id="journal-5314-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Category</strong> set to <i>metadata</i></li>
       <li><strong>Status</strong> changed from <i>New</i> to <i>Assigned</i></li>
       <li><strong>Assignee</strong> set to <i>Sridhar Boovaraghavan</i></li>
       <li><strong>Priority</strong> changed from <i>High</i> to <i>Normal</i></li>
       <li><strong>Target version</strong> set to <i>0.26</i></li>
    </ul>
    <div id="journal-5314-notes" class="wiki"><p>Are these keys to be always ignored, or only when they have those default values?  Should we report those values if the user provides the --verbose option on the command-line?</p></div>
    </div>
  </div>
  
  <div id="change-5318" class="journal has-notes">
    <div id="note-3">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-3" class="journal-link">#3</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/4728">Sridhar Boovaraghavan</a> <a title="13 Aug 2016 11:37" href="/projects/exiv2/activity?from=2016-08-13">over 5 years</a> ago
      <span id="journal-5318-private_notes" class=""></span>
    </h4>

    <div id="journal-5318-notes" class="wiki"><p>No, these keys are not always meant to be ignored, but only when they have those specific values.</p>


	<p>Regarding the verbose option, I don't know. Does exiv2 do anything different as in print the raw (uninterpreted) values in addition to the interpreted ones? If so, then we can consider printing those values when verbose is used.</p></div>
    </div>
  </div>
  
  <div id="change-5319" class="journal has-notes">
    <div id="note-4">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-4" class="journal-link">#4</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="13 Aug 2016 12:45" href="/projects/exiv2/activity?from=2016-08-13">over 5 years</a> ago
      <span id="journal-5319-private_notes" class=""></span>
    </h4>

    <div id="journal-5319-notes" class="wiki"><p>I don't thing verbose does much.  And it's a feature of exiv2(.exe) and not the library.  If you decide to remove those in canonmn.cpp, the --verbose flag will not be able to see those keys.</p>


	<p>--vebose gives a little more output by reporting file paths and stuff.<pre>954 rmills@rmillsmbp:~/gnu/exiv2/trunk $ exiv2 -pv --grep LensID/i ~/Stonehenge.jpg 
0x000c NikonLd3     LensIDNumber                Byte        1  146
955 rmills@rmillsmbp:~/gnu/exiv2/trunk $ exiv2 -pa --grep LensID/i ~/Stonehenge.jpg 
Exif.NikonLd3.LensIDNumber                   Byte        1  Sigma 18-250mm F3.5-6.3 DC OS Macro HSM
956 rmills@rmillsmbp:~/gnu/exiv2/trunk $ exiv2 --verbose -pa --grep LensID/i ~/Stonehenge.jpg 
File 1/1: /Users/rmills/Stonehenge.jpg
Exif.NikonLd3.LensIDNumber                   Byte        1  Sigma 18-250mm F3.5-6.3 DC OS Macro HSM
957 rmills@rmillsmbp:~/gnu/exiv2/trunk $ exiv2 --verbose -pv --grep LensID/i ~/Stonehenge.jpg 
File 1/1: /Users/rmills/Stonehenge.jpg
0x000c NikonLd3     LensIDNumber                Byte        1  146
958 rmills@rmillsmbp:~/gnu/exiv2/trunk $ </pre>--verbose also reports when the return value of exiv2(.exe) is not zero.</p>


	<p>A very important use of --verbose is with --version.  It prints a lot of information about the build <em><strong>AND</strong></em> the paths to dynamic libraries loaded by exiv2(.exe).</p></div>
    </div>
  </div>
  
  <div id="change-5489" class="journal has-notes has-details">
    <div id="note-5">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-5" class="journal-link">#5</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="30 Aug 2016 16:13" href="/projects/exiv2/activity?from=2016-08-30">about 5 years</a> ago
      <span id="journal-5489-private_notes" class=""></span>
    </h4>

    <ul class="details">
       <li><strong>Target version</strong> changed from <i>0.26</i> to <i>0.28</i></li>
    </ul>
    <div id="journal-5489-notes" class="wiki"><p>Development of this feature has been deferred for v0.27 and to be developed in branches/develop.  <a class="changeset" title="Copied trunk to branches/develop." href="/projects/exiv2/repository/exiv2/revisions/4449">r4449</a></p></div>
    </div>
  </div>
  
  <div id="change-5499" class="journal has-notes">
    <div id="note-6">
    <div class="contextual">
      <span class="journal-actions"></span>
      <a href="#note-6" class="journal-link">#6</a>
    </div>
    <h4>
      
      Updated by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="31 Aug 2016 15:11" href="/projects/exiv2/activity?from=2016-08-31">about 5 years</a> ago
      <span id="journal-5499-private_notes" class=""></span>
    </h4>

    <div id="journal-5499-notes" class="wiki"><p>Based on the list above, all of these tags are in 'binary arrays', i.e., composite IFD tags which consist of a number of values that are decoded into different tags, e.g., a single IFD tag consisting of three short values 1, 2, 3 which are decoded into three different tags, tag1 with value short 1, tag2 with value short 2 and tag3 with value short 3.</p>


	<p>My understanding is that Canon decided to use a certain value to identify tags which are not present in certain images (maybe because the camera used doesn't support the feature related to the particular tag). So, e.g., the second value of the above sample array could be set to -1 to indicate that tag2 is not present, as, because of the choice to use a binary array for the tags, that tag cannot simply be omitted from the binary structure.</p>


	<p>Exiv2 should ignore such tags, as if they were really not present in the image.</p>


	<p>A straightforward implementation will be to enhance the TIFF parser to not read such tags at all:</p>


	<p>New settings should be added to <code>Internal::ArrayCfg</code> to make it possible to define the tags to be ignored. The actual configurations for the known arrays are in <code>tiffimage.cpp</code>. <code>TiffReader::visitBinaryArray</code> can then use the new configuration to skip these tags.</p>


	<p>The write code may require minor changes as well.</p></div>
    </div>
  </div>
  


</div>

<div style="clear: both;"></div>
<div class="contextual">





</div>


<div style="clear: both;"></div>


<p class="other-formats">Also available in:  <span><a class="atom" rel="nofollow" href="/issues/1206.atom">Atom</a></span>
  <span><a class="pdf" rel="nofollow" href="/issues/1206.pdf">PDF</a></span>
</p>





        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
