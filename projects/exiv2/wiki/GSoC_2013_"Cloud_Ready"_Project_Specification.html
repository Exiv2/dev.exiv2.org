<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>GSoC 2013 &quot;Cloud Ready&quot; Project Specification - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="KCkWXZl+MzNAYQU9c6nqvIZwxBmMWS94omc/Z/0iqnrKZL2y6wT/MxUFGjHMfuaPueKQYH26jsJfR6/vvhtNFQ==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->

</head>
<body class="project-exiv2 has-main-menu controller-wiki action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="wiki_pages" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="wiki_pages" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=wiki" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=wiki">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki selected" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="">
    <div id="sidebar">
          
<h3>Wiki</h3>
<ul>
  <li><a href="/projects/exiv2/wiki">Start page</a></li>
  <li><a href="/projects/exiv2/wiki/index">Index by title</a></li>
  <li><a href="/projects/exiv2/wiki/date_index">Index by date</a></li>
</ul>


        
    </div>

    <div id="content">
        
        <div class="contextual">

  
  

  <span class="drdn"><span class="drdn-trigger"><span class="icon-only icon-actions" title="Actions">Actions</span></span><div class="drdn-content"><div class="drdn-items">
    <a class="icon icon-history" href="/projects/exiv2/wiki/GSoC_2013_%22Cloud_Ready%22_Project_Specification/history">History</a>

      
      
      
      

</div></div></span></div>




<div class="wiki wiki-page">
  <a name="GSoC-2013-Cloud-Ready-Project-Specification"></a>
<h1 >GSoC 2013 "Cloud Ready" Project Specification<a href="#GSoC-2013-Cloud-Ready-Project-Specification" class="wiki-anchor">&para;</a></h1>


	<p>This is a grand vision of how to provide metadata from Any Image to Any Device at Any Time to Anywhere.  Building on the solid base of the Exiv2 library, we plan to implement client-server technologies to extract metadata from images from any location and present it on any device.  This project is about enabling technology and look forward to applications taking advantage of this in the future.</p>


	<p>There are four subprojects:</p>


	<ol>
	<li>Remote I/O support (GSoC 2013 Student)</li>
		<li>exiv2(.exe) to run as a service (daemon) on a web socket.</li>
		<li>client-side use of the exiv2 service (using the web socket)</li>
		<li>JSON support</li>
	</ol>


	<p>This is quite a large project.  Robin Mills intends to implement the daemon/web-socket support during Spring 2013.  The GSoC student is expected to implement the Remote I/O support.  The proposal to have a GSoC student join us will be made via KDE <a class="external" href="http://community.kde.org/GSoC/2013/Ideas#Exiv2_.22Cloud_Ready.22_Project">http://community.kde.org/GSoC/2013/Ideas#Exiv2_.22Cloud_Ready.22_Project</a></p>


	<p><img src="http://clanmills.com/files/Exiv2CloudVision.png" alt="" /><br />[[<a class="external" href="http://clanmills.com/files/Exiv2CloudVision.pdf">http://clanmills.com/files/Exiv2CloudVision.pdf</a>]]</p>


	<a name="1-Remote-IO-support-GSoC-2013-Student"></a>
<h2 >1 Remote I/O support (GSoC 2013 Student)<a href="#1-Remote-IO-support-GSoC-2013-Student" class="wiki-anchor">&para;</a></h2>


	<p>Today we provide support for files resident on the local file system. These files can be memory mapped if this feature is supported by the host OS.</p>


	<p>With the increasing interest in "cloud" computing, it's become more common for files to reside in remote locations which are not mapped to the file system. Very common cases today are ftp and http. For example: <a class="external" href="http://bla/bla/bla/file.jpg">http://bla/bla/bla/file.jpg</a>. Today there are a myriad of "Cloud" storage products, such as AWS, DropBox, Google Drive, Sky Drive, Box,iCloud, Just Cloud and more.</p>


	<p>The proposal is to support http, ftp and ssh. This can be done by deriving a new Class from the BasicIO abstract class. The exiv2 command would accept filenames with a URL. For example:</p>


<pre>
exiv2 -pt http://clanmills.com/files/Robin.jpg
exiv2 -pt ftp://username@password:/clanmills.com/Robin.jpg
exiv2 -pt ssh://username@password:/clanmills.com/Robin.jpg
</pre><br />In most image files, the metadata is defined in the first 100k of the file, so the implementation should only read blocks on demand from the server and avoid copying the complete file.

	<p>The simplest possible implementation of this proposal for exiv2 is to detect the protocol and use a helper application such as curl or ssh. This implementation probably requires copying the complete file from the remote storage to a temporary file in the local file system. While such an implementation can be constructed quickly, this does not satisfy the project aim to make efficient use of band-width.</p>


	<p>It is very desirable to use a robust implementation of the web protocols and a library such as libcurl should be considered. The selection of the protocol support library must respect build implications. We should be careful to avoid adding a large library (such as boost) to the build dependencies. Additionally, the implementation is required to be written in C++ and run on Mac/Windows/Linux without dependency on platform frameworks such as .Net, Java, or Cocoa. It may be that build switches can be provided to enable Exiv2 to use platform frameworks. This could be especially useful on mobile platforms such as Android and iOS.</p>


	<p>The implementation should provide bi-directional support (both read and write) with read-access being the first priority.</p>


	<p><img src="http://clanmills.com/files/Exiv2CloudReady.png" alt="" /></p>


	<p>[[<a class="external" href="http://clanmills.com/files/Exiv2CloudReady.pdf">http://clanmills.com/files/Exiv2CloudReady.pdf</a>]]</p>


	<a name="2-and-3-Exiv2-daemon-server-and-client"></a>
<h2 >2 and 3 Exiv2 daemon server and client<a href="#2-and-3-Exiv2-daemon-server-and-client" class="wiki-anchor">&para;</a></h2>


	<p>enable exiv2 to run as a service (daemon) on a web socket. I imagine two types of clients:</p>


	<ol>
	<li>exiv2 itself of course</li>
		<li>JavaScript/WebSocket client</li>
	</ol>


	<p>To do this we could do something like this:<br /><pre>
Server:      # exiv2 --daemon --port 54321
Client:      $ exiv2 -pt exv://server:54321:/Robin.jpg
Even better: $ exiv2 -pt exv://server:54321:/http://clanmills.com/files/Robin.jpg
</pre>I don't want to get into detail concerning the JavaScript API for this. Something like this:<br /><pre>
&lt;script src="js/Exiv2.js"&gt;
var exiv2     = new Exiv2( { server : 'clanmills.com' , port : 54321 }); 
var metadata  = eval(exiv2.command('--JSON -pt /Robin.jpg '));
// or even better
var metadata  = eval(exiv2.command('--JSON -pt http://clanmills.com/files/Robin.jpg'));
</pre>To get the most from this functionality, we should provide JSON (and/or XML) support which I discuss below.</p>


	<p>Before I discuss JSON, I'd like to present this drawing to explain how everything fits together.  The Exiv2d Web Socket Server can communicate with any server on the internet.  Therefore Web Socket clients can come to the server as a "one stop shop" for images.  The clients do not need to support all the protocols - they only need to be able to talk to the Web Socket Server.  Downloadable client code will be provided in JavaScript for use by browsers.  C++ code will be provided for Servers and Custom Apps.  Test scripts will be developed in Python.  Regrettably, due to time constraints, I've declared Java to be "out of scope" for 2013.</p>


	<p><img src="http://clanmills.com/files/Exiv2CloudServer.png" alt="" /><br />[[<a class="external" href="http://clanmills.com/files/Exiv2CloudServer.pdf">http://clanmills.com/files/Exiv2CloudServer.pdf</a>]]</p>


	<a name="4-JSON-Support"></a>
<h2 >4 JSON Support<a href="#4-JSON-Support" class="wiki-anchor">&para;</a></h2>


	<p>5 years ago, I became interested in exiv2 to implement a GeoTagging application. I decided to use Python as an excuse to learn the language. I used the pyexiv2 wrapper, written by Olivier, and the project was a success. Building exiv2 and pyexiv2 on Windows and MacOSX was a challenge (to say the least).</p>


	<p>Since then, I've worked steadily on the exiv2 msvc and msvc64 built environments and I believe both are working very well.</p>


	<p>Sadly, building pyexiv2 is remains a challenge because it requires boost and the scons build utility. (scons is/was another GSoC project.) The consequence is that my python script seldom uses the latest exiv2 and is not available on all my machines (Windows/Cygwin/Mac/Kubuntu). The script is stable (hardly been changed in 5 years), however building the pyexiv2 wrapper is a maintenance challenge. The pyexiv2 has to be built for specific versions of python (2.6, 2.7 etc), architecture (32/64 bit), platform (windows/cygwin/macosx/linux).</p>


	<p>This is not a criticism of Olivier's pyexiv2 wrapper. Olivier has done a very good job. Python wrappers which link C++ are a severe maintenance challenge. I haven't worked for years with Perl's C++ support (XS and/or SWIG), however I anticipate similar pain and trouble.</p>


	<p>JSON to the rescue. My proposal is to provide a JSON interface to read and write metadata in the exiv2 command-line utility.</p>


	<p>As an sample application to prove our JSON support, provide wrappers for Perl and Python. The wrappers can be written entirely in the scripting language and use the language's JSON support. There is no need to get involved with C++ integration challenges such as boost/scons/pyexiv2, xs and swig. When reading from files, the wrapper will call exiv2.exe ONCE to capture all JSON to file. When writing to files, the wrapper will call exiv2.exe ONCE. This strategy will enable the wrappers to and run on all platforms on which exiv2.exe is available.</p>


	<a name="Expected-results"></a>
<h2 >Expected results:<a href="#Expected-results" class="wiki-anchor">&para;</a></h2>


	<ol>
	<li>To deploy a webservice to provide Exiv2 services.</li>
		<li>To provide a JavaScript library to enable developers use the Exiv2 service.</li>
		<li>An engineering assessment of the effort involved in providing access to cloud servers such as AWS.</li>
	</ol>


	<a name="GSoC-Mentor"></a>
<h2 >GSoC Mentor:<a href="#GSoC-Mentor" class="wiki-anchor">&para;</a></h2>


	<p>Robin Mills <a class="external" href="http://clanmills.com/files/CV.pdf">http://clanmills.com/files/CV.pdf</a></p>


	<p>I've been a volunteer on the Exiv2 project for 5 years.  I worked for Adobe for 10 years, where I implemented reading PDF and JDF files over http (without copying the complete file).  I'm now a freelance contractor and I've been working on a mobile app which uses WebSockets.  I've worked on both server and client code.</p>


	<a name="Project-Notes"></a>
<h2 >Project Notes:<a href="#Project-Notes" class="wiki-anchor">&para;</a></h2>


	<p>If you wish the submit a proposal, or discuss this project with me, then please do the following:</p>


	<ul>
	<li>Confirm with me that you have good C++ skills</li>
		<li>Download and build Exiv2.</li>
	</ul>


	<p>When you read the code, here are some suggestions for matters you may wish to consider:</p>


	<a name="1-Exiv2-BasicIO-abstract-class-and-HttpIO-concrete-class-for-reading"></a>
<h3 >1)    Exiv2 BasicIO abstract class and HttpIO concrete class (for reading)<a href="#1-Exiv2-BasicIO-abstract-class-and-HttpIO-concrete-class-for-reading" class="wiki-anchor">&para;</a></h3>


	<ul>
	<li>   I don’t remember the API, however it has methods to read from stream (open/close/tell/seek,read,write)</li>
		<li>   You should derive a new class from BasicIO, and could be called HttpIO or something like that</li>
		<li>   HttpIO should allocate memory for the complete file and maintain a map of blocks which have been copied from the server</li>
		<li>   When a read is requested, HttpIO should ensure the appropriate blocks have been requested, update the map, return data</li>
		<li>   The copy from the server should use HTTP’s ‘byte range’ to limit limit the number of bytes to be copied</li>
	</ul>


Why do we need to allocate memory for the complete file? I think we just need to allocate enough space for the metadata, don't we?
	<ol>
	<li>Some elderly HTTP server don't support "byte range", you have to copy the whole file.</li>
		<li>I’m hoping we can use the Memory Mapping IO code.  So you populate the memory with data “Just in time”.</li>
		<li>Some file formats (eg PDF) are random access and the metadata can be anywhere in the file.  Most JPGs have the metadata in the first 100k, however we want our code to handle other possibilities.</li>
		<li>The map tells us which blocks to transmit to the server when we’ve modified the file.</li>
		<li>The map is very simple – an array of bools.  I suggest a block size of 8*1024 – however make sure that’s a const that we can tune.  You might also want to always prepopulate the first 100k on open.  So, when you get the “open” call, you do a 100k GET  from the server and you’re in business.  Good, eh?</li>
	</ol>


	<a name="2-HttpIO-and-writing"></a>
<h3 >2)    HttpIO and writing<a href="#2-HttpIO-and-writing" class="wiki-anchor">&para;</a></h3>


	<ul>
	<li>   I’ve never wanted to write "byte-ranges" over http.  We need to research this.</li>
		<li>   However the map should maintain the parts of the file which have changed and only send those blocks to the server.</li>
	</ul>


	<a name="3-Protocol-support-library"></a>
<h3 >3)    Protocol support library<a href="#3-Protocol-support-library" class="wiki-anchor">&para;</a></h3>


	<ul>
	<li>   I respect libcurl.  I believe it supports http/https/ftp/sftp</li>
		<li>   I’m sure it can do ‘byte-ranges” for http/gets. </li>
		<li>   I don’t know if it can do byte-ranges on other protocols</li>
	</ul>


	<a name="4-Other-protocols"></a>
<h3 >4)    Other protocols<a href="#4-Other-protocols" class="wiki-anchor">&para;</a></h3>


	<ul>
	<li>      file:/// data: and "-" (meaning stdin)</li>
		<li>   Other protocols may be possible. (smb, nfs, ssh).  Needs to be investigated.</li>
		<li>   Cloud protocols (AWS, DropBox etc).  Needs to be investigated.</li>
	</ul>


	<a name="5-User-Interface-test-harness-and-Platforms"></a>
<h3 >5)  User Interface, test harness and Platforms<a href="#5-User-Interface-test-harness-and-Platforms" class="wiki-anchor">&para;</a></h3>


	<p>Exiv2 is a library.  There is no user interface.  Exiv2 includes about 20 sample applications which are all command-line programs.  The main application is exiv2(.exe) which does many things and is used by the test suite.  The test suite is written in bash.  On Windows, the test suite is run from Cygwin - however it can test libraries built with Visual Studio as well as GCC and Clang.</p>


	<p>All code is required to build, execute and test correctly on the major platforms: Windows/MacOSX/Linux.  I will provide help to port from the development system to the others.</p>


	<a name="6-Some-thoughts-about-implementation"></a>
<h3 >6) Some thoughts about implementation<a href="#6-Some-thoughts-about-implementation" class="wiki-anchor">&para;</a></h3>


	<p>There is a Memory Mapped IO class in Exiv2.  I think we can use that to implement the HTTP read stuff.  We can allocate memory for the complete file, then populate the memory "just in time" when the user makes a read read.</p>


	<p>The priority is to have HTTP/read support (without copying the whole file).<br />Writing back isn’t so interesting (most HTTP servers don’t allow PUT).<br />Other protocols are interesting, and the "quick and dirty" solution is to copy the complete file.</p>


	<p>This business of only updating those parts of the file which have changed are very effectively implemented by rsync.  Perhaps we should investigate if we can incorporate that in our solution.  I personally update clanmills.com (which has 6GB/100,000+ files) using rsync (over ssh) and I am always astonished by its speed/reliability.</p>


	<a name="Notes-about-prototyping-a-solution"></a>
<h1 >Notes about prototyping a solution<a href="#Notes-about-prototyping-a-solution" class="wiki-anchor">&para;</a></h1>


	<p>I) First of all, for all folks interested in contributing to this project, I recommend that you register with the Exiv2 forum <strong>AND</strong> add a watch to this page.  It's my intention to update this page quite frequently.  I'll make the same information available to everybody who would like to be involved.</p>


	<p>2) If you don't know anything about HTTP's GET verb, HTTP Header and Body - now's the time to learn.  Google something up, visit the library, or ask around.  Everybody involved in web programming knows about this.  So, I'm not going to discuss it here.</p>


	<p>3) When you inspect the Exiv2 code base, you discover that concrete class for opening and reading files are derived from the abstract BasicIO class.  I recommend that you "instrument" those function with printf (or cout) statements to report when they are called and their arguments.  You should be able to run the command exiv2 -pt foo.jpg and you'll see the IO calls being made.</p>


	<p>Here's my efforts (I've run it on Windows/Cygwin/MacOSX)<br /><a class="external" href="http://clanmills.com/exiv2/basicio.zip">http://clanmills.com/exiv2/basicio.zip</a></p>


	<p>4) Download and build curl.<br />Like Exiv2, curl is both a library and a very useful command-line tool.  Have a look at the man page for curl : <a class="external" href="http://linux.about.com/od/commands/l/blcmdl1_curl.htm">http://linux.about.com/od/commands/l/blcmdl1_curl.htm</a> and you'll discover the very interesting --range from-to option.  You'll also find curl --verbose helpful as it shows you what's being done by curl:</p>


<pre>
Robins-iMac:temp rmills$ curl http://clanmills.com/files/CV.pdf &gt; CV.pdf
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 38539  100 38539    0     0  91844      0 --:--:-- --:--:-- --:--:--  106k
Robins-iMac:temp rmills$ ls -alt CV.pdf
-rw-r--r--  1 rmills  staff  38539 Mar  1 17:41 CV.pdf

Robins-iMac:temp rmills$ curl --verbose http://clanmills.com/files/CV.pdf &gt; /dev/null 
* About to connect() to clanmills.com port 80 (#0)
*   Trying 173.254.28.62...
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0* connected
* Connected to clanmills.com (173.254.28.62) port 80 (#0)
&gt; GET /files/CV.pdf HTTP/1.1
&gt; User-Agent: curl/7.24.0 (x86_64-apple-darwin12.0) libcurl/7.24.0 OpenSSL/0.9.8r zlib/1.2.5
&gt; Host: clanmills.com
&gt; Accept: */*
&gt; 
&lt; HTTP/1.1 200 OK
&lt; Date: Sat, 02 Mar 2013 01:41:41 GMT
&lt; Server: Apache
&lt; Last-Modified: Sat, 10 Nov 2012 20:55:11 GMT
&lt; Accept-Ranges: bytes
&lt; Content-Length: 38539
&lt; Vary: Accept-Encoding
&lt; Content-Type: application/pdf
&lt; 
{ [data not shown]
100 38539  100 38539    0     0  91458      0 --:--:-- --:--:-- --:--:--  105k
* Connection #0 to host clanmills.com left intact
* Closing connection #0

Robins-iMac:temp rmills$ curl http://clanmills.com/files/CV.pdf | od -a | head

0000000   %   P   D   F   -   1   .   4  nl   %   G   l  si   "  nl   5
0000020  sp   0  sp   o   b   j  nl   &lt;   &lt;   /   L   e   n   g   t   h
0000040  sp   6  sp   0  sp   R   /   F   i   l   t   e   r  sp   /   F
0000060   l   a   t   e   D   e   c   o   d   e   &gt;   &gt;  nl   s   t   r
0000100   e   a   m  nl   x  fs   m   ]   k dc3   ^   6   u  rs   X   q
0000120   k   *  gs   6   i   R   t   ^   Y  em   N   d   ^   7   U   R
0000140 eot   H stx   $   ?   U   w   H   5  gs   X   Z   $  gs  ht   {
0000160   A   +   Y dc2   b   ]   V syn   V   6   r   3   |   !   ?   7
0000200 bel   $ soh   s   @   &lt;  sp   x   .   V  so   ;   S   [   c   a
0000220   &gt;   $   A   \   N   }   &lt;   8   x   r   (   . dc4   &gt;   *   ]

Robins-iMac:temp rmills$ curl --range 23-60 http://clanmills.com/files/CV.pdf 
&lt;&lt;/Length 6 0 R/Filter /FlateDecode&gt;&gt;
Robins-iMac:temp rmills$ 
</pre>

	<p>4) And how, you might be able to implement the HttpIO class!</p>


	<p>You know how to get the length of the file (it's in the Content-Length: header).  You'll find the HTTP verb HEAD is designed to provide this information.  And you know how to read a range of bytes!</p>


	<p>If you download the file <a class="external" href="http://clanmills.com/LargsPanorama.jpg">http://clanmills.com/LargsPanorama.jpg</a>:</p>


<pre>
1008 rmills@rmills-linux:/Windows/Users/rmills/clanmills $ cd ~/temp
1009 rmills@rmills-linux:~/temp $ curl http://clanmills.com/LargsPanorama.jpg &gt; Largs.jpg
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  485k  100  485k    0     0   115k      0  0:00:04  0:00:04 --:--:--  126k
1010 rmills@rmills-linux:~/temp $ open Largs.jpg 
1011 rmills@rmills-linux:~/temp $ exiv2 -pt Largs.jpg
Exif.Image.Orientation                       Short       1  top, left
Exif.Image.XResolution                       Rational    1  72
Exif.Image.YResolution                       Rational    1  72
Exif.Image.ResolutionUnit                    Short       1  inch
Exif.Image.Software                          Ascii      29  Adobe Photoshop CS Macintosh
Exif.Image.DateTime                          Ascii      20  2007:01:28 11:28:40
Exif.Image.ExifTag                           Long        1  164
Exif.Photo.ColorSpace                        Short       1  Uncalibrated
Exif.Photo.PixelXDimension                   Long        1  2160
Exif.Photo.PixelYDimension                   Long        1  345
Exif.Thumbnail.Compression                   Short       1  JPEG (old-style)
Exif.Thumbnail.XResolution                   Rational    1  72
Exif.Thumbnail.YResolution                   Rational    1  72
Exif.Thumbnail.ResolutionUnit                Short       1  inch
Exif.Thumbnail.JPEGInterchangeFormat         Long        1  302
Exif.Thumbnail.JPEGInterchangeFormatLength   Long        1  1688
1012 rmills@rmills-linux:~/temp $ 
</pre><br />The aim of the project is to write an new HttpIO class (derived from BasicIO), so that the command:

	<p>exiv2 -pt <a class="external" href="http://clanmills.com/LargsPanorama.jpg">http://clanmills.com/LargsPanorama.jpg</a> produces the same output as above.</p>


	<p>The "quick and dirty" solution is when "open" is called, you use curl to download the file to /tmp/LargsPanorama.jpg, then delegate everything to the FileIO class.  Works?  Of course!  Efficient?  No!  You copied the whole file.</p>


Here are some things to think about:
	<ol>
	<li>The clever solution is to use the byte-range feature of curl to copy only those bytes actually requested by Exiv2.</li>
		<li>We don't want to invoke external programs like curl.  We want to link and call libcurl for ourselves.</li>
		<li>What happens if exiv2 requests the same bytes more than once?  We want to cache them of course.</li>
		<li>What about other protocols:  FTP/SSH and so on.  Well, that's what the projects about.</li>
	</ol>


	<p>I hope this all makes sense.  I know you'll ask me when you're confused.</p>


	<p>This photo is of the beautiful town of Largs in Scotland where I was born. <img src="http://clanmills.com/LargsPanorama.jpg" alt="" /></p>
</div>


<fieldset class="collapsible collapsed hide-when-print">
  <legend onclick="toggleFieldset(this);">Files (0)</legend>
  <div style="display: none;">

  

</div>
</fieldset>

<p class="wiki-update-info">
  Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="20 Apr 2013 14:48" href="/projects/exiv2/activity?from=2013-04-20">over 8 years</a> ago
 · <a href="/projects/exiv2/wiki/GSoC_2013_%22Cloud_Ready%22_Project_Specification/history">17 revisions</a>
</p>





        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
