<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Revision 2 - History - The Metadata in TIFF files - The Metadata in TIFF files - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="MTOzdyFVE0gfAecXPbExNenw+2+3Fzm+LhASFH8AMYbTfhiYUy/fSEpl+BuCZj0G1mKvFkb0mATTMIKcPDnW6Q==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
  <meta name="robots" content="noindex,follow,noarchive" />
</head>
<body class="project-exiv2 has-main-menu controller-wiki action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="wiki_pages" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="wiki_pages" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=wiki" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=wiki">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki selected" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="">
    <div id="sidebar">
          
<h3>Wiki</h3>
<ul>
  <li><a href="/projects/exiv2/wiki">Start page</a></li>
  <li><a href="/projects/exiv2/wiki/index">Index by title</a></li>
  <li><a href="/projects/exiv2/wiki/date_index">Index by date</a></li>
</ul>


        
    </div>

    <div id="content">
        
        <div class="contextual">


  <span class="drdn"><span class="drdn-trigger"><span class="icon-only icon-actions" title="Actions">Actions</span></span><div class="drdn-content"><div class="drdn-items">
    <a class="icon icon-history" href="/projects/exiv2/wiki/The_Metadata_in_TIFF_files/history">History</a>

      

</div></div></span></div>

<p class="breadcrumb"><a href="/projects/exiv2/wiki/FAQ">FAQ</a> » <a href="/projects/exiv2/wiki/Start_Page">Start Page</a> » </p>

  <h2><a href="/projects/exiv2/wiki/The_Metadata_in_TIFF_files">The Metadata in TIFF files</a> &#187; <a href="/projects/exiv2/wiki/The_Metadata_in_TIFF_files/history">History</a> &#187; Revision 2</h2>

    <p>
      <a href="/projects/exiv2/wiki/The_Metadata_in_TIFF_files/1">« Previous</a> |
    Revision 2/20
      (<a href="/projects/exiv2/wiki/The_Metadata_in_TIFF_files/2/diff">diff</a>)
      | <a href="/projects/exiv2/wiki/The_Metadata_in_TIFF_files/3">Next »</a>
    <br />
    <em><a class="user active" href="/users/119">Robin Mills</a>, 26 Apr 2015 23:29 </em><br />
    
    </p>
    <hr />

<div class="wiki wiki-page">
  <a name="The-Metadata-in-TIFF-files"></a>
<h1 >The Metadata in TIFF files<a href="#The-Metadata-in-TIFF-files" class="wiki-anchor">&para;</a></h1>


	<p>The Tagged Image File Format is a container.  It's very flexible and can deal with multiple pages, different colour spaces, frame configurations as well as metadata.  The specification is available from:  <a class="external" href="https://partners.adobe.com/public/developer/en/tiff/TIFF6.pdf">https://partners.adobe.com/public/developer/en/tiff/TIFF6.pdf</a></p>


	<p>The format is quite simple and consists of a fixed format header (of 8 bytes) which provides the offset of a directory of records.  A directory has a two byte header which contains the length of the directory followed by 12 byte records or "tags".  The final entry in the directory is always the offset to the next dictionary.  A dictionary of length == 0 terminates the directory chain.</p>


	<p>A tag consists of a 12 byte record: Tag, Type, Count, Offset which are 2,2,4 and 4 bytes respectively.  The Tag defines the purpose of the record (Width, Height, ColorSpace etc) and the Type defines the nature of the data.  Count and Offset are used to contain the data, or provide an offset in the file at which to read the raw data for this tag.</p>


	<p>This is all very well described in the specification.  The code in tiff image.cpp/ TiffImage::printStructure() decodes the dictionaries.</p>


	<p>The TIFF container is so flexible it is used as the structure for most RAW formats including Adobe's DNG.  Additionally the TIFF contain is used to store the metadata that lies inside the Exif and Iptc data blocks within JPEG and PNG files.</p>


	<p><strong>Example:</strong><br />The version of exiv2(.exe) which ships with v0.25 provides options -pS to reveal the structure of the TIFF and option -pX is used to extract the raw XMP/xml data.  The option -pa is used to print the metadata in human readable format.<pre>$ exiv2 -pa ~/tif
Exif.Image.ImageWidth                        Short       1  40
Exif.Image.ImageLength                       Short       1  470
Exif.Image.BitsPerSample                     Short       3  8 8 8
Exif.Image.Compression                       Short       1  LZW
Exif.Image.PhotometricInterpretation         Short       1  RGB
Exif.Image.StripOffsets                      Long        1  2694
Exif.Image.Orientation                       Short       1  right, top
Exif.Image.SamplesPerPixel                   Short       1  3
Exif.Image.RowsPerStrip                      Short       1  1092
Exif.Image.StripByteCounts                   Long        1  5086
Exif.Image.PlanarConfiguration               Short       1  1
Exif.Image.Predictor                         Short       1  Horizontal differencing
Exif.Image.SampleFormat                      Short       3  Unsigned integer data
Exif.Image.XMLPacket                         Byte      2500  (Binary value suppressed)
Xmp.dc.title                                 LangAlt     1  lang="x-default" this is a title
/Users/rmills/tif: (No IPTC data found in the file)
$ exiv2 -pS ~/tif
STRUCTURE OF TIFF FILE: /Users/rmills/tif
 address |    tag                      |      type |    count |   offset | value
      10 | 0x0100 ImageWidth           |     SHORT |        1 |  2621440 | 40
      22 | 0x0101 ImageLength          |     SHORT |        1 | 30801920 | 470
      34 | 0x0102 BitsPerSample        |     SHORT |        3 |      182 | 
      46 | 0x0103 Compression          |     SHORT |        1 |   327680 | 5
      58 | 0x0106 PhotometricInterpret |     SHORT |        1 |   131072 | 2
      70 | 0x0111 StripOffsets         |      LONG |        1 |     2694 | 0
      82 | 0x0112 Orientation          |     SHORT |        1 |   393216 | 6
      94 | 0x0115 SamplesPerPixel      |     SHORT |        1 |   196608 | 3
     106 | 0x0116 RowsPerStrip         |     SHORT |        1 | 71565312 | 1092
     118 | 0x0117 StripByteCounts      |      LONG |        1 |     5086 | 0
     130 | 0x011c PlanarConfiguration  |     SHORT |        1 |    65536 | 1
     142 | 0x013d Predictor            |     SHORT |        1 |   131072 | 2
     154 | 0x0153 SampleFormat         |     SHORT |        3 |      188 | 
     166 | 0x02bc XMLPacket            |      BYTE |     2500 |      194 | &lt;?xpacket begin="..." id="W5M0Mp ...
$ exiv2 -pX ~/tif | xmllint -pretty 1 -
&lt;?xml version="1.0"?&gt;
&lt;?xpacket begin="﻿" id="W5M0MpCehiHzreSzNTczkc9d"?&gt;
&lt;x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="XMP Core 4.4.0-Exiv2"&gt;
  &lt;rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"&gt;
    &lt;rdf:Description xmlns:dc="http://purl.org/dc/elements/1.1/" rdf:about=""&gt;
      &lt;dc:title&gt;
        &lt;rdf:Alt&gt;
          &lt;rdf:li xml:lang="x-default"&gt;this is a title&lt;/rdf:li&gt;
        &lt;/rdf:Alt&gt;
      &lt;/dc:title&gt;
    &lt;/rdf:Description&gt;
  &lt;/rdf:RDF&gt;
&lt;/x:xmpmeta&gt;
&lt;?xpacket end="w"?&gt;
855 rmills@rmillsmbp:~/Documents/exiv2 $ </pre></p>


	<p>You can clearly see the XMLPacket is stored at offset 194 into the file and consists of 2500 bytes.   You can of course directly extract the XMP with the following command which says:  set the block size to 1 byte, skip 194 bytes and dump the next 2500 bytes:<pre>863 rmills@rmillsmbp:~/Documents/exiv2 $ dd bs=1 skip=194 count=2500 if=~/tif  | xmllint -pretty 1 -
2500+0 records in
2500+0 records out
2500 bytes transferred in 0.005714 secs (437526 bytes/sec)
&lt;?xml version="1.0"?&gt;
&lt;?xpacket begin="﻿" id="W5M0MpCehiHzreSzNTczkc9d"?&gt;
&lt;x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="XMP Core 4.4.0-Exiv2"&gt;
  &lt;rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"&gt;
    &lt;rdf:Description xmlns:dc="http://purl.org/dc/elements/1.1/" rdf:about=""&gt;
      &lt;dc:title&gt;
        &lt;rdf:Alt&gt;
          &lt;rdf:li xml:lang="x-default"&gt;this is a title&lt;/rdf:li&gt;
        &lt;/rdf:Alt&gt;
      &lt;/dc:title&gt;
    &lt;/rdf:Description&gt;
  &lt;/rdf:RDF&gt;
&lt;/x:xmpmeta&gt;
&lt;?xpacket end="w"?&gt;
864 rmills@rmillsmbp:~/Documents/exiv2 $ </pre>The option -pX doesn't actually use dd to achieve the same result and is much more convenient to use.</p>


	<p>To demonstrate that the metadata block in a JPEG is a TIFF file, extract and print the structure.<pre>$ exiv2 -pS ~/jpg 
STRUCTURE OF JPEG FILE: /Users/rmills/jpg
 address | marker     | length  | data
       2 | 0xd8 SOI  
       4 | 0xe1 APP1  |   14862 | Exif..II*.....................
   14868 | 0xe1 APP1  |    2720 | http://ns.adobe.com/xap/1.0/.&lt;
   17590 | 0xed APP13 |     110 | Photoshop 3.0.8BIM.......6....
   17702 | 0xe2 APP2  |    4094 | MPF.II*...............0100....
   21798 | 0xdb DQT   |     132 
   21932 | 0xc0 SOF0  |      17 
   21951 | 0xc4 DHT   |     418 
   22371 | 0xda SOS   |      12 
$ dd bs=1 skip=12 count=14862 if=~/jpg of=bull.tif
14862+0 records in
14862+0 records out
14862 bytes transferred in 0.038783 secs (383211 bytes/sec)
$ exiv2 -pS bull.tif
STRUCTURE OF TIFF FILE: bull.tif
 address |    tag                      |      type |    count |   offset | value
      10 | 0x010f Make                 |     ASCII |       18 |      134 | NIKON CORPORATION.
      22 | 0x0110 Model                |     ASCII |       12 |      152 | NIKON D5300.
      34 | 0x0112 Orientation          |     SHORT |        1 |        1 | 1
      46 | 0x011a XResolution          |  RATIONAL |        1 |      164 | 
      58 | 0x011b YResolution          |  RATIONAL |        1 |      172 | 
      70 | 0x0128 ResolutionUnit       |     SHORT |        1 |        2 | 2
      82 | 0x0131 Software             |     ASCII |       10 |      180 | Ver.1.00 .
      94 | 0x0132 DateTime             |     ASCII |       20 |      190 | 2015:02:13 20:46:51.
     106 | 0x0213 YCbCrPositioning     |     SHORT |        1 |        1 | 1
     118 | 0x8769 ExifTag              |      LONG |        1 |      210 | 210
    4080 | 0x0103 Compression          |     SHORT |        1 |        6 | 6
    4092 | 0x011a XResolution          |  RATIONAL |        1 |     4168 | 
    4104 | 0x011b YResolution          |  RATIONAL |        1 |     4176 | 
    4116 | 0x0128 ResolutionUnit       |     SHORT |        1 |        2 | 2
    4128 | 0x0201 JPEGInterchangeForma |      LONG |        1 |     4184 | 4184
    4140 | 0x0202 JPEGInterchangeForma |      LONG |        1 |    10670 | 10670
    4152 | 0x0213 YCbCrPositioning     |     SHORT |        1 |        1 | 1
$ </pre></p>
</div>


<fieldset class="collapsible collapsed hide-when-print">
  <legend onclick="toggleFieldset(this);">Files (1)</legend>
  <div style="display: none;">

  <div class="attachments">
<div class="contextual">
  
</div>
<table>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/1102">Tiff.png</a>    <span class="size">(38.1 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/1102/Tiff.png">Tiff.png</a>  </td>
  <td></td>
  <td>
      <span class="author">Robin Mills, 13 Nov 2016 09:12</span>
  </td>
  <td>
  </td>
</tr>
</table>
</div>


</div>
</fieldset>

<p class="wiki-update-info">
  Updated by <a class="user active" href="/users/119">Robin Mills</a> <a title="26 Apr 2015 23:29" href="/projects/exiv2/activity?from=2015-04-26">over 6 years</a> ago
 · <a href="/projects/exiv2/wiki/The_Metadata_in_TIFF_files/history">2 revisions</a>
</p>





        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
