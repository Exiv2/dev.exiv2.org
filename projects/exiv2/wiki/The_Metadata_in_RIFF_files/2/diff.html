<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Revision 2 - History - The Metadata in RIFF files - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="VuEG3JpRhLA8Q9Lc/ZidtLiAgR9iWHoxomsQZFxzko60rK0z6CtIsGknzdBCT5GHhxLVZpO724tfS4DsH0p14Q==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
</head>
<body class="project-exiv2 has-main-menu controller-wiki action-diff avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="wiki_pages" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="wiki_pages" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=wiki" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=wiki">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki selected" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="nosidebar">
    <div id="sidebar">
        
        
    </div>

    <div id="content">
        
        <div class="contextual">
<a class="icon icon-history" href="/projects/exiv2/wiki/The_Metadata_in_RIFF_files/history">History</a>
</div>



<h2><a href="/projects/exiv2/wiki/The_Metadata_in_RIFF_files">The Metadata in RIFF files</a> &#187; <a href="/projects/exiv2/wiki/The_Metadata_in_RIFF_files/history">History</a> &#187; Revision 2</h2>

<p>
Revision <a href="/projects/exiv2/wiki/The_Metadata_in_RIFF_files/1">1</a>
<em>(Mahesh Hegde, 10 Sep 2013 12:19)</em>
&#8594;
Revision <a href="/projects/exiv2/wiki/The_Metadata_in_RIFF_files/2">2</a>/6
<em>(Mahesh Hegde, 10 Sep 2013 12:21)</em>
</p>

<div class="text-diff">
h1. The Metadata in RIFF (.avi) files (Under construction) <br /><br /> Please note: Four bytes words in caps have special significance in this document, which are called Chunk headers, and appear exactly same in the original RIFF file. 
<br />  
<br /> This page brief about the Riff(Resource Interchange File Format) type video file container, popular video files using Riff container being AVI files. <br /><br /> h2. Why RIFF? <br /><br /> Since video files most likely to have multiple data chunks like video,audio,subtitle,metadata which essentially describe about the video,it&#39;s been convenient to have structured data rather than in a random order. <br /><br /> h2.    What is RIFF? <br /><br /> RIFF is a structured video container format Issued as a joint design by IBM Corporation and Microsoft Corporation in 1991. <br /><br /> h2. How it is structured? <br /><br /> Everything in RIFF is structured in Chunk, sub-chunk hierarchy.    Every chunk contains ChunkID, ChunkSize, and ChunkData.    First four bytes of a RIFF file type must be ASCII values corresponding to letters *RIFF*.    This is the ChunkId parent of every other sub-chunk.    Rules dominating RIFF structure which describe how a typical RIFF file are: <br /><br /> * Every chunk should have ChunkId(four bytes), ChunkSize(four bytes).    Do not include size of ChunkId and ChunkSize in ChunkSize. 
<br /> * ChunkData having odd number of bytes should be padded with one more dummy byte,and ChunkSize is always even. 
<br /> * ChunkData can be simple data like video frames (encoded or plane), audio samples or another Chunk having similar    structure as parent Chunk.    Hence ChunkData can have sub-chunks and it is recursive, which means LIST chunk can contain another LIST chunk. 
<br /> * Every chunk will have data which has to be decoded according to either predefined schema(Fixed size structured metadata like *AVIH*,*STRH* primitive chunks) or variable size metadata chunks like *INFO* main Chunk. <br /><br /> Following picture is a typical RIFF file. 
<br /> <span class="diff_in">!/attachments/538/riff_file_structure.jpg!</span> <span class="diff_out">!/attachments/534/riff_file_structure.jpg!</span> <br /><br /> Here Tags RIFF,AVI (notice single space after AVI),LIST,hdrl,movi are four byte character codes,and are present right in the beginning of the chunks and appear exactly same(corresponding ASCII) in the file.Following are the some of the predefined Primitive chunk Structure. <br /><br /> h3. AVIH primitive Chunk  <br /><br /> |_.Byte Number |_.Metadata       |_.Description | 
<br /> |0 to 3 | *avih* | Primitive Header tag  
<br /> Signifying start of avih chunk | 
<br /> |4 to 7 |size| 44(fixed) | 
<br /> |8 to 11|Microseconds Per Frame| Video related Data | 
<br /> |12 to 15| Maximum Bytes Per Second| Video related Data| 
<br /> |16 to 19|Padding Granularity|Video related Data| 
<br /> |20 to 23|Flags|Video related Data| 
<br /> |24 to 27|Total Frames|Video related Data| 
<br /> |28 to 31|Initial Frames|Video related Data| 
<br /> |32 to 35|Streams|Video related Data| 
<br /> |36 to 39|Suggested Buffer Size|Video related Data| 
<br /> |40 to 43|Width|Video Dimention| 
<br /> |44 to 47|Height|Video Dimention| 
<br /> |48 to 51|Reserved|Reserved| <br /><br /> For More Detail refer http://msdn.microsoft.com/en-us/library/windows/desktop/dd318183(v=vs.85).aspx <br /><br /> h3. STRH Primitive Chunk <br /><br /> |_.Byte Number |_.Metadata       |_.Description | 
<br /> |0 to 3|*strh*|Stream Header Chunk| 
<br /> |4 to 7|size|52| 
<br /> |8 to 11|Type,&#39;auds&#39; 
<br /> &#39;mids&#39;,&#39;txts&#39; 
<br /> &#39;vids&#39;|Define Data about  
<br /> either of Audio,Midi 
<br /> text or Video| 
<br /> |12 to 15|Handler|For Audio and Video, 
<br /> This will be codec name which  
<br /> will be used by Audio/Video Players| 
<br /> |16 to 19|Flags|Defines whether Stream should be  
<br /> enabled/disabled| 
<br /> |20 to 23|Priority|Stream priority| 
<br /> |24 to 27|Language|Stream Language| 
<br /> |28 to 31|Initial Frames|Significant data for  
<br /> interleaved Files,specifies Audio  
<br /> position relative to Video| 
<br /> |32 to 35|Scale|Used internally  
<br /> for calculations| 
<br /> |36 to 39|Rate|Stream Rate| 
<br /> |40 to 43|Start|Specifies Starting Time of  
<br /> the Stream| 
<br /> |44 to 47|Length|Stream Length| 
<br /> |48 to 51|Suggested Buffer 
<br /> Size|Used by Video Players| 
<br /> |52 to 55|Quality|Stream Quality| 
<br /> |56 to 59|Sample Size|Size of Single sample| 
<br /> |60 to 63|Frame|Rectangle position 
<br /> ,upper Left corner| <br /><br /> For More Detail refer http://msdn.microsoft.com/en-us/library/windows/desktop/dd318183(v=vs.85).aspx <br /><br /> Similar Chunk structure is found in *strd* and *strf*. <br /><br /> h3. INFO Main Header Chunk <br /><br /> |_.Byte Number |_.Metadata       |_.Description | 
<br /> |0 to 3|INFO|Info Header Tag| 
<br /> |4 to 7|Info Primitive Tag|Predefined Tag Header| 
<br /> |8 to 11|size|Size of Info Primitive Chunk| 
<br /> |12 to 12+size|Info Primitive 
<br /> Data|String Array of Metadata| 
<br /> |12+size+1 to 12+size+4|Info Primitive Chunk|Optional Second Info Primitive Chunk| 
<br /> |....|size|Size of Second Info Primitive Chunk| <br /><br /> Info is slightly special Metadata Chunk,because we can store variable sized metadata in here.These are basically user related data and video subjects related information.Here we have flexibility to add tags,having standard tag Ids like Comment,Copyright,Location Description,Genre,Country and more. <br /><br /> h3. In Exiv2, all video files are treated as Image Files and the RIFF read flow is as follows: <br /><br /> <span class="diff_in">!/attachments/538/riff_read_in_exiv2_flow.jpeg!</span> <span class="diff_out">!/attachments/535/riff_read_in_exiv2_flow.jpeg!</span> <br /><br /> h3. Write-Flow <br /><br /> <span class="diff_in">!/attachments/538/riff_read_in_exiv2_flow.jpeg!</span> <span class="diff_out">!/attachments/535/riff_read_in_exiv2_flow.jpeg!</span>
</div>

        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
