<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Revision 6 - History - The Metadata in JPEG files - The Metadata in JPEG files - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="p0vk6NNq7kpxW9gw4iXmxnq1IcH87xD/5KvbunGuWa9FBk8HoRAiSiQ/xzxd8ur1RSd1uA0MsUUZi0syMpe+wA==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
  <meta name="robots" content="noindex,follow,noarchive" />
</head>
<body class="project-exiv2 has-main-menu controller-wiki action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="wiki_pages" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="wiki_pages" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=wiki" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=wiki">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki selected" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="">
    <div id="sidebar">
          
<h3>Wiki</h3>
<ul>
  <li><a href="/projects/exiv2/wiki">Start page</a></li>
  <li><a href="/projects/exiv2/wiki/index">Index by title</a></li>
  <li><a href="/projects/exiv2/wiki/date_index">Index by date</a></li>
</ul>


        
    </div>

    <div id="content">
        
        <div class="contextual">


  <span class="drdn"><span class="drdn-trigger"><span class="icon-only icon-actions" title="Actions">Actions</span></span><div class="drdn-content"><div class="drdn-items">
    <a class="icon icon-history" href="/projects/exiv2/wiki/The_Metadata_in_JPEG_files/history">History</a>

      

</div></div></span></div>



  <h2><a href="/projects/exiv2/wiki/The_Metadata_in_JPEG_files">The Metadata in JPEG files</a> &#187; <a href="/projects/exiv2/wiki/The_Metadata_in_JPEG_files/history">History</a> &#187; Revision 6</h2>

    <p>
      <a href="/projects/exiv2/wiki/The_Metadata_in_JPEG_files/5">« Previous</a> |
    Revision 6/36
      (<a href="/projects/exiv2/wiki/The_Metadata_in_JPEG_files/6/diff">diff</a>)
      | <a href="/projects/exiv2/wiki/The_Metadata_in_JPEG_files/7">Next »</a>
    <br />
    <em><a class="user active" href="/users/3761">Tuan Nhu</a>, 22 Jul 2013 11:43 </em><br />
    
    </p>
    <hr />

<div class="wiki wiki-page">
  <a name="The-Metadata-in-JPEG-files"></a>
<h1 >The Metadata in JPEG files<a href="#The-Metadata-in-JPEG-files" class="wiki-anchor">&para;</a></h1>


	<p>This article shares my investigations about the metadata structure in JPEG files. It also introduces briefly the algorithm used in exiv2 to read and write Exif, IPTC, XMP data and image comments on the JPEG files.</p>


	<a name="Background"></a>
<h2 >Background<a href="#Background" class="wiki-anchor">&para;</a></h2>


	<p>JPEG ISO standard is a commonly used method of lossy compression for digital photography. The name "JPEG" stands for Joint Photographic Experts Group, the name of the committee.</p>


	<p>JPEG refers only to a class of compression algorithms, not to a specific file format. In order to produce files with embedded JPEG streams, a number of file format standards have been adapted or devised. Some of them are  JPEG /<abbr title="JPEG File Interchange Format">JFIF</abbr>, JPEG /SPIFF (Still Picture Interchange File Format), JPEG /<abbr title="Camera Image File Format">CIFF</abbr>, JPEG/Exif (Exchangeable image file format).</p>


Among them, the most common types are JPEG/Exif and JPEG/JFIF. 
	<ul>
	<li>JPEG/Exif is the most common image format used by digital cameras and other photographic image capture devices. </li>
		<li>JPEG/JFIF is the most common format for storing and transmitting photographic images on the World Wide Web.</li>
	</ul>


	<a name="The-metadata-structure-in-JPEG"></a>
<h2 >The metadata structure in JPEG<a href="#The-metadata-structure-in-JPEG" class="wiki-anchor">&para;</a></h2>


	<p>A JPEG file contains several segments; each segment contains different kinds of data, delimited by two-byte codes called markers.  The markers are hexadecimal; they begin with 0xFF and end with a code (1 byte) indicating the kind of marker.</p>


	<p>Some markers consist of just those two bytes; others are followed by two bytes indicating the length of marker-specific payload data that follows.  The length includes the two bytes for the length, but not the two bytes for the marker.</p>


	<table>
		<tr>
			<th>Short name </th>
			<th>Bytes      </th>
			<th>Payload     </th>
			<th>Name and Comments </th>
		</tr>
		<tr>
			<td>SOI          </td>
			<td>0xFF, 0xD8   </td>
			<td>None       </td>
			<td>Start Of Image       </td>
		</tr>
		<tr>
			<td>SOF0          </td>
			<td>0xFF, 0xC0   </td>
			<td>Variable size </td>
			<td>Start Of Frame (Baseline DCT)<br />Indicates that this is a baseline DCT-based JPEG, and specifies the width, height, number of components, and component subsampling</td>
		</tr>
		<tr>
			<td>SOF2          </td>
			<td>0xFF, 0xC2   </td>
			<td>Variable size </td>
			<td>Start Of Frame (Progressive DCT)<br />Indicates that this is a progressive DCT-based JPEG, and specifies the width, height, number of components, and component subsampling</td>
		</tr>
		<tr>
			<td>DHT          </td>
			<td>0xFF, 0xC4   </td>
			<td>Variable size </td>
			<td>Define Huffman Table(s)</td>
		</tr>
		<tr>
			<td>DQT           </td>
			<td>0xFF, 0xDB   </td>
			<td>Variable size </td>
			<td>Define Quantization Table(s)</td>
		</tr>
		<tr>
			<td>DRI           </td>
			<td>0xFF, 0xDD   </td>
			<td>2 bytes       </td>
			<td>Define Restart Interval<br />Specifies the interval between RSTn markers, in macroblocks. This marker is followed by two bytes indicating the fixed size so it can be treated like any other variable size segment.</td>
		</tr>
		<tr>
			<td>SOS           </td>
			<td>0xFF, 0xDA   </td>
			<td>Variable size </td>
			<td>Start Of Scan<br />Begins a top-to-bottom scan of the image. In baseline DCT JPEG images, there is generally a single scan. Progressive DCT JPEG images usually contain multiple scans. This marker specifies which slice of data it will contain, and is immediately followed by entropy-coded data.</td>
		</tr>
		<tr>
			<td>RSTn          </td>
			<td>0xFF, 0xDn<br />               n(n=0..7)   </td>
			<td>None          </td>
			<td>Restart<br />Inserted every r macroblocks, where r is the restart interval set by a DRI marker. Not used if there was no DRI marker. The low 3 bits of the marker code cycle in value from 0 to 7.</td>
		</tr>
		<tr>
			<td>APPn           </td>
			<td>0xFF, 0xEn  </td>
			<td>Variable size </td>
			<td>Application-specific<br />For example, an Exif JPEG file uses an APP1 marker to store metadata, laid out in a structure based closely on TIFF.</td>
		</tr>
		<tr>
			<td>COM          </td>
			<td>0xFF, 0xFE  </td>
			<td>Variable size </td>
			<td>Comment</td>
		</tr>
		<tr>
			<td>EOI          </td>
			<td>0xFF, 0xD9  </td>
			<td>None          </td>
			<td>End Of Image</td>
		</tr>
	</table>




	<p>=. <em>Fig.1. The common JPEG markers. From Wikipedia, <a class="external" href="https://en.wikipedia.org/wiki/JPEG">https://en.wikipedia.org/wiki/JPEG</a></em></p>
</div>


<fieldset class="collapsible collapsed hide-when-print">
  <legend onclick="toggleFieldset(this);">Files (7)</legend>
  <div style="display: none;">

  <div class="attachments">
<div class="contextual">
  
</div>
<table>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/511">test.jpg</a>    <span class="size">(285 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/511/test.jpg">test.jpg</a>  </td>
  <td>from http://www.flickr.com/photos/canderson/5470671552/</td>
  <td>
      <span class="author">Tuan Nhu, 23 Jul 2013 09:28</span>
  </td>
  <td>
  </td>
</tr>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/512">fig2.jpg</a>    <span class="size">(155 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/512/fig2.jpg">fig2.jpg</a>  </td>
  <td>Basic Structure of JPEG Files, From Exif.org</td>
  <td>
      <span class="author">Tuan Nhu, 24 Jul 2013 00:34</span>
  </td>
  <td>
  </td>
</tr>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/513">fig3.jpg</a>    <span class="size">(343 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/513/fig3.jpg">fig3.jpg</a>  </td>
  <td>Flowchart of readMetadata</td>
  <td>
      <span class="author">Tuan Nhu, 24 Jul 2013 00:37</span>
  </td>
  <td>
  </td>
</tr>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/514">fig4.jpg</a>    <span class="size">(443 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/514/fig4.jpg">fig4.jpg</a>  </td>
  <td>Flowchart of writeMetadata</td>
  <td>
      <span class="author">Tuan Nhu, 24 Jul 2013 00:38</span>
  </td>
  <td>
  </td>
</tr>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/518">fig2d.jpg</a>    <span class="size">(155 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/518/fig2d.jpg">fig2d.jpg</a>  </td>
  <td></td>
  <td>
      <span class="author">Robin Mills, 17 Aug 2013 13:33</span>
  </td>
  <td>
  </td>
</tr>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/519">fig3d.jpg</a>    <span class="size">(70.4 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/519/fig3d.jpg">fig3d.jpg</a>  </td>
  <td></td>
  <td>
      <span class="author">Robin Mills, 17 Aug 2013 13:33</span>
  </td>
  <td>
  </td>
</tr>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/520">fig4d.jpg</a>    <span class="size">(81 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/520/fig4d.jpg">fig4d.jpg</a>  </td>
  <td></td>
  <td>
      <span class="author">Robin Mills, 17 Aug 2013 13:33</span>
  </td>
  <td>
  </td>
</tr>
</table>
</div>


</div>
</fieldset>

<p class="wiki-update-info">
  Updated by <a class="user active" href="/users/3761">Tuan Nhu</a> <a title="22 Jul 2013 11:43" href="/projects/exiv2/activity?from=2013-07-22">over 8 years</a> ago
 · <a href="/projects/exiv2/wiki/The_Metadata_in_JPEG_files/history">6 revisions</a>
</p>





        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
