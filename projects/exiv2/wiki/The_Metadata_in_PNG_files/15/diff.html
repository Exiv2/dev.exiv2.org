<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Revision 15 - History - The Metadata in PNG files - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="CA6Kj1r6gjlUMSoJO02I+YdTa98QLHAioWoDfTTP0RrqQyFgKIBOOQFVNQWEmoTKuME/puHP0ZhcSpP1d/Y2dQ==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
</head>
<body class="project-exiv2 has-main-menu controller-wiki action-diff avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="wiki_pages" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="wiki_pages" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=wiki" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=wiki">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki selected" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="nosidebar">
    <div id="sidebar">
        
        
    </div>

    <div id="content">
        
        <div class="contextual">
<a class="icon icon-history" href="/projects/exiv2/wiki/The_Metadata_in_PNG_files/history">History</a>
</div>



<h2><a href="/projects/exiv2/wiki/The_Metadata_in_PNG_files">The Metadata in PNG files</a> &#187; <a href="/projects/exiv2/wiki/The_Metadata_in_PNG_files/history">History</a> &#187; Revision 15</h2>

<p>
Revision <a href="/projects/exiv2/wiki/The_Metadata_in_PNG_files/14">14</a>
<em>(Robin Mills, 17 Aug 2013 13:30)</em>
&#8594;
Revision <a href="/projects/exiv2/wiki/The_Metadata_in_PNG_files/15">15</a>/16
<em>(Robin Mills, 26 Apr 2015 16:14)</em>
</p>

<div class="text-diff">
h1. The Metadata in PNG files <br /><br /> The Portable Network Graphics (PNG) is a raster graphics file format that supports a portable, legally unencumbered, well-compressed, well-specified standard for lossless bitmapped image files.  <br /><br /> A PNG always starts with an 8-byte signature: 137 80 78 71 13 10 26 10 (decimal values). The remainder of the file consists a series of chunks beginning with an IHDR chunk and ending with an IEND chunk. <br /><br /> h2. 1. Chunks <br /><br /> Each chunk consists of four parts:  <br /><br /> |_.Length | 4 bytes |An unsigned integer giving the number of bytes in the chunk&#39;s data field. The length counts only the data field, not itself, the chunk type code, or the CRC. Zero is a valid length. Although encoders and decoders should treat the length as unsigned, its value must not exceed 2^31-1 bytes. | 
<br /> |_.Chunk type | 4 bytes |Type codes are restricted to consist of uppercase and lowercase ASCII letters and they are case sensitive. 
<br /> + The case of the first letter indicates whether the chunk is critical or not. If the first letter is uppercase, the chunk is critical; if not, the chunk is ancillary (more details are mentioned below). 
<br /> + The case of the second letter indicates whether the chunk is &quot;public&quot; (either in the specification or the registry of special-purpose public chunks) or &quot;private&quot; (not standardised). Uppercase is public and lowercase is private. 
<br /> + The third letter must be uppercase to conform to the PNG specification. It is reserved for future expansion. 
<br /> + The case of the fourth letter indicates whether the chunk is safe to copy by editors that do not recognize it.| 
<br /> |_.Chunk data| _Length_ bytes |The data bytes appropriate to the chunk type, if any. This field can be of zero length. | 
<br /> |_.CRC| 4 bytes| A CRC (Cyclic Redundancy Check) calculated on the preceding bytes in the chunk, including the chunk type code and chunk data fields, but not including the length field. The CRC is always present, even for chunks containing no data. | <br /><br /> p=. _Fig.1. The chunk layout._ <br /><br /> Chunks declare themselves as _critical_ or _ancillary_. Chunks that are necessary for successful display of the file&#39;s contents are called _critical_ chunks. If a decoder encounters a critical chunk it does not recognize, it must abort reading the file or supply the user with an appropriate warning. <br /><br /> |_.Name |_.Multiple |_.Ordering constraints|_.Content | 
<br /> |IHDR     | No          |Must be the first       |the image&#39;s width, height, and bit depth| 
<br /> |PLTE     | No          |Before IDAT             |the palette; list of colors.| 
<br /> |IDAT     | Yes         |Multiple IDATs must be consecutive |the actual image data, which may be split among multiple IDAT chunks. Such splitting increases filesize slightly, but makes it possible to generate a PNG in a streaming manner. | 
<br /> |IEND     | No         |Must be the last |it just marks the image end. The chunk&#39;s data field is empty. | <br /><br /> p=. _Fig.2. Some standard critical chunks._ <br /><br /> Chunks that are not strictly necessary in order to meaningfully display the contents of the file are known as _ancillary_ chunks. It includes gamma values, background color, and textual metadata information, ect... If a decoder encourters an ancillary chunk that it does not understand can safely ignore it.  <br /><br /> |_.Name |_.Multiple |_.Ordering constraints|_.Content | 
<br /> |cHRM     |No           |Before PLTE and IDAT    |the chromaticity coordinates of the display primaries and white point.| 
<br /> |gAMA     |No           |Before PLTE and IDAT    |gamma values.| 
<br /> |iCCP     |No           |Before PLTE and IDAT    |an ICC color profile.| 
<br /> |sBIT     |No           |Before PLTE and IDAT    |the color-accuracy of the source data.| 
<br /> |sRGB     |No           |Before PLTE and IDAT    |the standard sRGB color space.| 
<br /> |bKGD     |No           |After PLTE; before IDAT|the default background color. It is intended for use when there is no better choice available, such as in standalone image viewers.| 
<br /> |hIST     |No           |After PLTE; before IDAT|the histogram, or total amount of each color in the image.| 
<br /> |tRNS     |No           |After PLTE; before IDAT|transparency information.For indexed images, it stores alpha channel values for one or more palette entries. For truecolor and grayscale images, it stores a single pixel value that is to be regarded as fully transparent.| 
<br /> |pHYs     |No           |Before IDAT             |the intended pixel size and/or aspect ratio of the image.| 
<br /> |sPLT     |Yes          |Before IDAT             |a palette to use if the full range of colors is unavailable.| 
<br /> |tIME     |No           |None                    |the time that the image was last changed.| 
<br /> |iTXt     |Yes          |None                    |UTF-8 text, compressed or not, with an optional language tag.| 
<br /> |tEXt     |Yes          |None                    |text that can be represented in ISO/IEC 8859-1.| 
<br /> |zTXt     |Yes          |None                    |compressed text with the same limits as tEXt. | <br /><br /> p=. _Fig.3. Some standard ancillary chunks._ <br /><br /> h2. 2. Textual information chunks - the metadata in PNG <br /><br /> The iTXt, tEXt, and zTXt chunks (text chunks) are used for conveying textual information associated with the image. They are the places we can find all metadata of PNG file. <br /><br /> Each of the text chunks contains as its first field a keyword that indicates the type of information represented by the text string. The following keywords are predefined and should be used where appropriate:  
<br /> |_.Keywords |_.Explain | 
<br /> |Title        |Short (one line) title or caption for image | 
<br /> |Author       |Name of image&#39;s creator | 
<br /> |Description       |Description of image (possibly long) | 
<br /> |Copyright          |Copyright notice | 
<br /> |Creation Time      |Time of original image creation | 
<br /> |Software           |Software used to create the image | 
<br /> |Disclaimer         |Legal disclaimer | 
<br /> |Warning            |Warning of nature of content | 
<br /> |Source             |Device used to create the image | 
<br /> |Comment            |Miscellaneous comment; conversion from GIF comment| <br /><br /> Other keywords may be invented for other purposes. The keyword must be at least one character and less than 80 characters long. Keywords of general interest can be registered with the maintainers of the PNG specification. According to &quot;XMP Specification&quot;:http://wwwimages.adobe.com/www.adobe.com/content/dam/Adobe/en/devnet/xmp/pdfs/XMPSpecificationPart3.pdf, an XMP packet is embedded in a PNG graphic file by adding a chunk of type iTXt with the keyword &#39;XML:com.adobe.xmp&#39;. There are no standard for Exif, IPTC data. In Exiv2, when Exif, IPTC are added, they are stored in zTXt text chunks and save as ASCII. <br /><br /> h3. 2.1 tEXt Textual data  <br /><br /> In the format: <br /><br /> |_.Keyword |_.Null separator |_.Text| 
<br /> |1-79 bytes|1 byte              | n bytes |  <br /><br /> The text is interpreted according to the ISO/IEC 8859-1 (Latin-1) character set. The text string can contain any Latin-1 character. Newlines in the text string should be represented by a single linefeed character (decimal 10). <br /><br /> h3. 2.2 zTXt Compressed textual data <br /><br /> In the format: <br /><br /> |_.Keyword |_.Null separator |_.Compression method |_.Compressed text| 
<br /> |1-79 bytes|1 byte             |1 byte | n bytes| <br /><br /> The zTXt chunk contains textual data, just as tEXt does; however, zTXt takes advantage of compression. The zTXt and tEXt chunks are semantically equivalent, but zTXt is recommended for storing large blocks of text. The only presently legitimate value for _Compression method_ is 0 (&quot;deflate/inflate compression&quot;:http://www.w3.org/TR/PNG-Compression.html) <br /><br /> h3. 2.3 iTXt International textual data <br /><br /> In the format: <br /><br /> |_.Keyword |_.Null separator |_.Compression flag |_.Compression method |_.Language tag |_.Null separator |_.Translated keyword |_.Null separator |_.Text| 
<br /> |1-79 bytes|1 byte             |1 byte | 1 byte| 0 or more bytes |1 byte |0 or more bytes | 1 byte | 0 or more bytes | <br /><br /> This chunk is semantically equivalent to the tEXt and zTXt chunks, but the textual data is in the UTF-8 encoding of the Unicode character set instead of Latin-1 <br /><br /> <span class="diff_in">*Example:* 
<br /> This example uses the version of exiv2(.exe) that ships in v0.25 to show the structure of the file.    The option -pa prints all metadata, -pS prints the structure of the file, -pX extracts the raw XMP/xml data. <br /><br /> &lt;pre&gt;841 rmills@rmillsmbp:~/gnu/exiv2/trunk/website $ exiv2 -pa ~/png  
<br /> Exif.Image.ImageWidth                          SLong         1    320 
<br /> ... 
<br /> Exif.Thumbnail.JPEGInterchangeFormatLength     Long          1    4376 
<br /> Iptc.Application2.ObjectName                   String        4    ovni 
<br /> ... 
<br /> Iptc.Application2.RecordVersion                Short         1    4 
<br /> Xmp.dc.title                                   LangAlt       1    lang=&quot;x-default&quot; this is the title 
<br /> 842 rmills@rmillsmbp:~/gnu/exiv2/trunk/website $ exiv2 -pS ~/png  
<br /> STRUCTURE OF PNG FILE: /Users/rmills/png 
<br />  address | index | chunk_type |     length | data 
<br />        8 |       0 |         IHDR |         13 |  
<br />       33 |       1 |         zTXt |       8769 | Raw profile type exif..x...[r.. 
<br />     8814 |       2 |         zTXt |        270 | Raw profile type iptc..x.=QKn.  
<br />     9096 |       3 |         iTXt |       2524 | XML:com.adobe.xmp.....&lt;?xpacket 
<br />    11632 |       4 |         iCCP |       1404 | icc..x...i8.......af\...w_3... 
<br />    13048 |       5 |         sBIT |          3 |  
<br />    13063 |       6 |         zTXt |         87 | Software..x...A.. ......B....}. 
<br />    13162 |       7 |         IDAT |       8192 | x...Y.$Wv&amp;v.{.{l.T.......[w.=m$ 
<br /> ... 
<br />   119814 |      20 |         IDAT |       8192 | k........!..B*.....\*.(!..0.s.. 
<br />   128018 |      21 |         IDAT |       3346 | .Y.L@I$M.Z[.0A ...K#.t.0+.G(.jX 
<br />   131376 |      22 |         IEND |          0 |  
<br /> 843 rmills@rmillsmbp:~/gnu/exiv2/trunk/website $ exiv2 -pX ~/png | xmllint -pretty 1 -  
<br /> &lt;?xml version=&quot;1.0&quot;?&gt; 
<br /> &lt;?xpacket begin=&quot;﻿&quot; id=&quot;W5M0MpCehiHzreSzNTczkc9d&quot;?&gt; 
<br /> &lt;x:xmpmeta xmlns:x=&quot;adobe:ns:meta/&quot; x:xmptk=&quot;XMP Core 4.4.0-Exiv2&quot;&gt; 
<br />   &lt;rdf:RDF xmlns:rdf=&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;&gt; 
<br />     &lt;rdf:Description xmlns:dc=&quot;http://purl.org/dc/elements/1.1/&quot; rdf:about=&quot;&quot;&gt; 
<br />       &lt;dc:title&gt; 
<br />         &lt;rdf:Alt&gt; 
<br />           &lt;rdf:li xml:lang=&quot;x-default&quot;&gt;this is the title&lt;/rdf:li&gt; 
<br />         &lt;/rdf:Alt&gt; 
<br />       &lt;/dc:title&gt; 
<br />     &lt;/rdf:Description&gt; 
<br />   &lt;/rdf:RDF&gt; 
<br /> &lt;/x:xmpmeta&gt; 
<br /> &lt;?xpacket end=&quot;w&quot;?&gt; 
<br /> 844 rmills@rmillsmbp:~/gnu/exiv2/trunk/website $ &lt;/pre&gt; <br /><br /> Most of the file consists of IDAT blocks which contain the image itself (pixels).    More interestingly, the zTXt chunks contain the Exif and Iptc data.    The iTXt chunk contains the XMP/xml. <br /><br /></span> h2. References <br /><br /> | 1. PNG Spec , Version 1.2 | http://www.libpng.org/pub/png/spec/1.2/PNG-Contents.html | 
<br /> | 2. Wikipedia. PNG. | http://en.wikipedia.org/wiki/Portable_Network_Graphics | 
<br /> | 3. Image File Formats - JPG, TIF, PNG, GIF Which to use? | http://www.scantips.com/basics09.html | 
<br /> | 4. Benefits of the PNG Image Format | http://www.atalasoft.com/png.aspx | <span class="diff_out">
<br /></span>
</div>

        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
