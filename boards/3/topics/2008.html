<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>libexiv2 linking problems - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="PBbdAVz5kY4Lw7U4GRAWYvb04nGP4d462oQNJ1DJHM/eW3buLoNdjl6nqjSmxxpRyWa2CH4Cf4AnpJ2vE/D7oA==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
</head>
<body class="project-exiv2 has-main-menu controller-messages action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="messages" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="messages" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=boards" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=boards">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards selected" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="nosidebar">
    <div id="sidebar">
        
        
    </div>

    <div id="content">
        
        <p class="breadcrumb"><a href="/projects/exiv2/boards">Forums</a> » <a href="/projects/exiv2/boards/3">Forum</a> » </p>

<div class="contextual">
    
    
    
    
</div>

<h2>libexiv2 linking problems</h2>

<div class="message">
<p><span class="author">Added by <a class="user active" href="/users/4405">Norritt -</a> <a title="15 Apr 2015 20:53" href="/projects/exiv2/activity?from=2015-04-15">over 6 years</a> ago</span></p>
<div class="wiki">
<p>Hello everyone,</p>


	<p>I've found to this forum on my search for solutions to problems linking libexiv2. Before I start to go into details about the problem I'll give a brief overview overview over my development plattform:</p>


	<p>OS/Environment: Kubuntu 14.04.02 LTS (inside Oracle Virtual Box 4.3.12 r93733)<br />Kernelinfo: 3.13.0-49-generic #83-Ubuntu SMP Fri Apr 10 20:11:33 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux</p>


	<p>I did not manually download and compile the libexiv2 code from this website but I'm trying to link against the libexiv2/libexiv2-dev packages provided within the kubuntu package repository. Details on the installed packages follow:</p>


<pre>
$ dpkg-query -S libexiv2
libexiv2-dev: /usr/lib/libexiv2.la
libexiv2-dev: /usr/share/doc/libexiv2-dev/copyright
libexiv2-dev: /usr/share/doc/libexiv2-dev
libexiv2-12: /usr/share/doc/libexiv2-12
libexiv2-dev: /usr/lib/libexiv2.so
libexiv2-dev: /usr/share/doc/libexiv2-dev/changelog.Debian.gz
libexiv2-dev: /usr/lib/libexiv2.a
libexiv2-12: /usr/share/doc/libexiv2-12/changelog.Debian.gz
libexiv2-12: /usr/share/doc/libexiv2-12/copyright
libexiv2-12: /usr/lib/libexiv2.so.12
libexiv2-12: /usr/lib/libexiv2.so.12.0.0

$ ls -l /usr/lib/libexiv2*
-rw-r--r-- 1 root root 5870542 Dez 17  2013 /usr/lib/libexiv2.a
-rw-r--r-- 1 root root     940 Dez 17  2013 /usr/lib/libexiv2.la
lrwxrwxrwx 1 root root      18 Dez 17  2013 /usr/lib/libexiv2.so -&gt; libexiv2.so.12.0.0
lrwxrwxrwx 1 root root      18 Dez 17  2013 /usr/lib/libexiv2.so.12 -&gt; libexiv2.so.12.0.0
-rw-r--r-- 1 root root 2300872 Dez 17  2013 /usr/lib/libexiv2.so.12.0.0
</pre>

	<p>As described within the README provided with the source code from this website executing pkg-config should provide the appropriate compiler and linker flags:<br /><pre>
$ pkg-config exiv2 --cflags

$ pkg-config exiv2 --libs
-lexiv2  
</pre></p>


	<p>The makefile I'm using to compile my test project looks like this:<br /><pre>
  1 OUTPUT = Main
  2 #EXTENSION = "cc" 
  3 EXTENSION = "cpp" 
  4 PROJECT_DIR = ./
  5 
  6 LIBRARIES = -lexiv2
  7 
  8 FILES = $(shell find . -maxdepth 1 -name "*.$(EXTENSION)")
  9 HEADER = $(shell find . -maxdepth 1 -name "*.h")
 10 INCLUDES = -I$(PROJECT_DIR)
 11 
 12 #definitions for standard make options
 13 #GDB_OPTION = -ggdb
 14 GDB_OPTION = -O3
 15 CPPFLAGS = -Wall -std=c++11
 16 OUTPUT_OPTION = $(GDB_OPTION) $(INCLUDES)
 17 
 18 ifeq ($(EXTENSION),"cc")
 19     OBJECTS = $(FILES:%.cc=%.o)
 20 endif
 21 ifeq ($(EXTENSION),"cpp")
 22     OBJECTS = $(FILES:%.cpp=%.o)
 23 endif
 24 
 25 #build the output
 26 all: TEST_IF_C_FILES_ARE_THERE $(OUTPUT)
 27 
 28 ${OUTPUT}: $(OBJECTS) $(HEADER)
 29     g++ $(GDB_OPTION) $(LIBRARIES) $(OBJECTS) -o ${OUTPUT}
 30 
 31 TEST_IF_C_FILES_ARE_THERE:
 32     @test "$(FILES)" != "" 
 33 
 34 #rebuild the objects, if one header file has changed
 35 $(OBJECTS): $(HEADER)
 36 
 37 clean:
 38     rm -f $(OUTPUT) $(OBJECTS)
 39 
 40 new: clean $(OUTPUT)
</pre></p>


	<p>If I try to build my code using this makefile I keep receiving the following errors:<br /><pre>
make
g++  -Wall -std=c++11   -c -O3 -I./   exiffilter.cpp
In file included from /usr/include/exiv2/metadatum.hpp:39:0,
                 from /usr/include/exiv2/exif.hpp:34,
                 from /usr/include/exiv2/bmpimage.hpp:34,
                 from /usr/include/exiv2/exiv2.hpp:35,
                 from exiffilter.cpp:1:
/usr/include/exiv2/value.hpp:984:25: note: attribute for ‘struct Exiv2::DateValue::Date’ must follow the ‘struct’ keyword
         EXIV2API struct Date
                         ^
g++  -Wall -std=c++11   -c -O3 -I./   main.cpp
In file included from /usr/include/exiv2/metadatum.hpp:39:0,
                 from /usr/include/exiv2/exif.hpp:34,
                 from /usr/include/exiv2/bmpimage.hpp:34,
                 from /usr/include/exiv2/exiv2.hpp:35,
                 from exiffilter.h:4,
                 from main.cpp:3:
/usr/include/exiv2/value.hpp:984:25: note: attribute for ‘struct Exiv2::DateValue::Date’ must follow the ‘struct’ keyword
         EXIV2API struct Date
                         ^
g++ -O3 -lexiv2  ./exiffilter.o ./main.o -o Main
./exiffilter.o: In Funktion `ExifFilter::ExifFilter(std::string const&#38;)':
exiffilter.cpp:(.text+0x1c): Nicht definierter Verweis auf `Exiv2::ImageFactory::open(std::string const&#38;)'
./exiffilter.o: In Funktion `operator&lt;&lt;(std::ostream&#38;, ExifFilter const&#38;)':
exiffilter.cpp:(.text+0xa9): Nicht definierter Verweis auf `Exiv2::Image::good() const'
collect2: error: ld returned 1 exit status
make: *** [Main] Fehler 1
</pre></p>


	<p>To make sure that this phenomenon has nothing to do with my code I also tried to build the exifprint.cpp code provided as example inside the API documentation, which shows similar results:<br /><pre>
$ make
g++  -Wall -std=c++11   -c -O3 -I./   exifprint.cpp
In file included from /usr/include/exiv2/metadatum.hpp:39:0,
                 from /usr/include/exiv2/exif.hpp:34,
                 from /usr/include/exiv2/bmpimage.hpp:34,
                 from /usr/include/exiv2/exiv2.hpp:35,
                 from exifprint.cpp:5:
/usr/include/exiv2/value.hpp:984:25: note: attribute for ‘struct Exiv2::DateValue::Date’ must follow the ‘struct’ keyword
         EXIV2API struct Date
                         ^
g++ -O3 -lexiv2  ./exifprint.o -o Main
./exifprint.o: In Funktion `Exiv2::BasicError&lt;char&gt;::~BasicError()':
exifprint.cpp:(.text._ZN5Exiv210BasicErrorIcED2Ev[_ZN5Exiv210BasicErrorIcED5Ev]+0x5b): Nicht definierter Verweis auf `Exiv2::AnyError::~AnyError()'
./exifprint.o: In Funktion `main':
exifprint.cpp:(.text.startup+0x72): Nicht definierter Verweis auf `Exiv2::ImageFactory::open(std::string const&#38;)'
exifprint.cpp:(.text.startup+0x634): Nicht definierter Verweis auf `Exiv2::BasicError&lt;char&gt;::setMsg()'
exifprint.cpp:(.text.startup+0x6a7): Nicht definierter Verweis auf `Exiv2::AnyError::~AnyError()'
./exifprint.o:(.rodata._ZTIN5Exiv210BasicErrorIcEE[_ZTIN5Exiv210BasicErrorIcEE]+0x10): Nicht definierter Verweis auf `typeinfo for Exiv2::AnyError'
collect2: error: ld returned 1 exit status
make: *** [Main] Fehler 1
</pre></p>


	<p>I'd be grateful for any hints on how to fix this issue. Thanks for your help.</p>


	<p>Cheers norritt</p>
</div>

</div>
<br />

<div id="replies">
<h3 class="comments icon icon-comments">Replies (6)</h3>
  <div class="message reply" id="message-2009">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/2008?r=2009#message-2009">RE: libexiv2 linking problems</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="15 Apr 2015 22:06" href="/projects/exiv2/activity?from=2015-04-15">over 6 years</a> ago
  </h4>
  <div class="wiki"><p>I use kubuntu 14.04 and 14.10 all the time for Linux work, and run kubuntu on our build server :<pre>558 rmills@rmillsmbp:~/gnu/exiv2/trunk $ ssh rmills@rmillsmm-kubuntu uname -a
Linux rmillsmm-kubuntu 3.13.0-37-generic #64-Ubuntu SMP Mon Sep 22 21:28:38 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux
559 rmills@rmillsmbp:~/gnu/exiv2/trunk $ </pre>So you're on "home turf".</p>


	<p>I never use the Linux Mafia version of exiv2, however nobody has reported anything like this before.  Have you tried to build from source?  You might have a mixed up combination of Mafia supplied and current trunk files.  We have made changes to the header file directories for v0.25 and a jumble of v0.24 and v0.25 files is unlikely to work.</p>


	<p>Looking at the output, I suspect you don't have the file exv_conf.h.<pre>560 rmills@rmillsmbp:~/gnu/exiv2/trunk $ finder "*.h" -exec grep -H EXIV2API {} \;
./config/config.h:/* Define EXIV2API for DLL builds */   &lt;--- autotools generate file
./config/config.h:#  define EXIV2API EXV_EXPORT
./config/config.h:#  define EXIV2API EXV_IMPORT
./config/config.h:# define EXIV2API
./include/exiv2/exv_conf.h:/* Define EXIV2API for DLL builds */ &lt;--- munged into this for the public use
./include/exiv2/exv_conf.h:#  define EXIV2API EXV_EXPORT
./include/exiv2/exv_conf.h:#  define EXIV2API EXV_IMPORT
./include/exiv2/exv_conf.h:# define EXIV2API

./include/exiv2/exv_msvc-webready.h: &lt;---------- MSVC files
./include/exiv2/exv_msvc.h:#define EXIV2API
./include/exiv2/exv_msvc.h:/* Define EXIV2API for DLL builds */
./include/exiv2/i18n.h:EXIV2API const char* _exvGettext(const char* str); &lt;--- simple use of EXIV2API
561 rmills@rmillsmbp:~/gnu/exiv2/trunk $</pre>I encourage you to pull the latest code from the trunk and build it!<pre>
$ svn export svn://dev.exiv2.org/svn/trunk
$ cd trunk
$ make config ; ./configure ; make -j ; sudo make install ; make -j samples ; make tests</pre><br />It's rather late in England (almost 11:06pm).  I'll investigate more tomorrow.  Let me know if you solved this for yourself.</p></div>
  
  </div>
  <div class="message reply" id="message-2010">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/2008?r=2010#message-2010">RE: libexiv2 linking problems</a>
    -
    Added by <a class="user active" href="/users/4405">Norritt -</a> <a title="16 Apr 2015 10:02" href="/projects/exiv2/activity?from=2015-04-16">over 6 years</a> ago
  </h4>
  <div class="wiki"><p>Hey Robin,</p>


	<p>thanks for the swift reply. If different versions have been mixed that must have happened on side of the package maintainers from (k)ubuntu. I haven't manually downloaded any version of the library to my development system yet, but only used the packet management (muon and apt).</p>


	<p>It seems "exv_conf.h" is present on my system:</p>


<pre>
$ find / -name exv_conf.h 2&gt; /dev/null
/usr/include/exiv2/exv_conf.h
$ md5sum /usr/include/exiv2/exv_conf.h 
daf52c10b21052133e8f215685979f45  /usr/include/exiv2/exv_conf.h
</pre>

	<p>Further files in the /usr/include/exiv2 directory are:</p>


<pre>
$ ls -l /usr/include/exiv2/
insgesamt 468
-rw-r--r-- 1 root root 29172 Dez 17  2013 basicio.hpp
-rw-r--r-- 1 root root  4806 Dez 17  2013 bmpimage.hpp
-rw-r--r-- 1 root root  5610 Dez 17  2013 convert.hpp
-rw-r--r-- 1 root root  5704 Dez 17  2013 cr2image.hpp
-rw-r--r-- 1 root root  6670 Dez 17  2013 crwimage.hpp
-rw-r--r-- 1 root root 15334 Dez 17  2013 datasets.hpp
-rw-r--r-- 1 root root  3860 Dez 17  2013 easyaccess.hpp
-rw-r--r-- 1 root root  5041 Dez 17  2013 epsimage.hpp
-rw-r--r-- 1 root root 12298 Dez 17  2013 error.hpp
-rw-r--r-- 1 root root 25073 Dez 17  2013 exif.hpp
-rw-r--r-- 1 root root  2144 Dez 17  2013 exiv2.hpp
-rw-r--r-- 1 root root  7286 Dez 17  2013 exv_conf.h
-rw-r--r-- 1 root root  2705 Dez 17  2013 futils.hpp
-rw-r--r-- 1 root root  4882 Dez 17  2013 gifimage.hpp
-rw-r--r-- 1 root root 27246 Dez 17  2013 image.hpp
-rw-r--r-- 1 root root 12001 Dez 17  2013 iptc.hpp
-rw-r--r-- 1 root root  5005 Dez 17  2013 jp2image.hpp
-rw-r--r-- 1 root root 18255 Dez 17  2013 jpgimage.hpp
-rw-r--r-- 1 root root 12541 Dez 17  2013 metadatum.hpp
-rw-r--r-- 1 root root  5307 Dez 17  2013 mrwimage.hpp
-rw-r--r-- 1 root root  5711 Dez 17  2013 orfimage.hpp
-rw-r--r-- 1 root root  5283 Dez 17  2013 pgfimage.hpp
-rw-r--r-- 1 root root  4999 Dez 17  2013 pngimage.hpp
-rw-r--r-- 1 root root  6642 Dez 17  2013 preview.hpp
-rw-r--r-- 1 root root 11948 Dez 17  2013 properties.hpp
-rw-r--r-- 1 root root  5788 Dez 17  2013 psdimage.hpp
-rw-r--r-- 1 root root  5143 Dez 17  2013 rafimage.hpp
-rw-r--r-- 1 root root  5632 Dez 17  2013 rw2image.hpp
-rw-r--r-- 1 root root  9077 Dez 17  2013 tags.hpp
-rw-r--r-- 1 root root  5035 Dez 17  2013 tgaimage.hpp
-rw-r--r-- 1 root root  8838 Dez 17  2013 tiffimage.hpp
-rw-r--r-- 1 root root 21608 Dez 17  2013 types.hpp
-rw-r--r-- 1 root root 61107 Dez 17  2013 value.hpp
-rw-r--r-- 1 root root  6479 Dez 17  2013 version.hpp
-rw-r--r-- 1 root root 16056 Dez 17  2013 xmp.hpp
-rw-r--r-- 1 root root  4363 Dez 17  2013 xmpsidecar.hpp
</pre>

	<p>According to information inside the exv_conf.h the installed version is 0.23:</p>


<pre>
139 /* Define to the name of this package. */
140 #define EXV_PACKAGE "exiv2" 
141 
142 /* Define to the full name of this package. */
143 #define EXV_PACKAGE_NAME "exiv2" 
144 
145 /* Define to the full name and version of this package. */
146 #define EXV_PACKAGE_STRING "exiv2 0.23" 
147 
148 /* Define to the one symbol short name of this package. */
149 #define EXV_PACKAGE_TARNAME "exiv2" 
150 
151 /* Define to the version of this package. */
152 #define EXV_PACKAGE_VERSION "0.23" 
</pre></div>
  
  </div>
  <div class="message reply" id="message-2011">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/2008?r=2011#message-2011">RE: libexiv2 linking problems</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="16 Apr 2015 10:16" href="/projects/exiv2/activity?from=2015-04-16">over 6 years</a> ago
  </h4>
  <div class="wiki"><p>I've spent a couple of hours on this without getting it totally solved.  I believe you have to use libtool to do the link.  I installed libtool using sudo apt-get install libtool.  When you build in the trunk, the autotools magically create a libtool that's polished in some mysterious way.  However I think the "vanilla" libtool from the Linux Mafia is sufficient.<pre>1218 rmills@rmillsmbp-kubuntu:~/temp/forum $ ls -alt
total 12
drwxrwxr-x 2 rmills rmills 4096 Apr 16 11:10 .
drwxr-xr-x 5 rmills rmills 4096 Apr 16 10:03 ..
-rw-rw-r-- 1 rmills rmills 1676 Apr 16 09:30 exifprint.cpp
1219 rmills@rmillsmbp-kubuntu:~/temp/forum $ make exifprint.o
g++    -c -o exifprint.o exifprint.cpp
1220 rmills@rmillsmbp-kubuntu:~/temp/forum $ libtool --mode=link g++ -g -O -lstdc++ -pthread exifprint.o -o exifprint /usr/lib/libexiv2.so
libtool: link: g++ -g -O -pthread exifprint.o -o exifprint /usr/lib/libexiv2.so  -lstdc++ -pthread
exifprint.o: In function `main':
exifprint.cpp:(.text+0xac): undefined reference to `Exiv2::ImageFactory::open(std::string const&#38;, bool)'
collect2: error: ld returned 1 exit status
1221 rmills@rmillsmbp-kubuntu:~/temp/forum $ </pre>I'm going out for lunch today.  I'll have another look at this this afternoon.</p></div>
  
  </div>
  <div class="message reply" id="message-2012">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/2008?r=2012#message-2012">RE: libexiv2 linking problems</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="16 Apr 2015 15:29" href="/projects/exiv2/activity?from=2015-04-16">over 6 years</a> ago
  </h4>
  <div class="wiki"><p>Solved!  (I think).  When I did a sudo apt-get install libexiv2-dev, version v0.23 was installed into /usr/include /usr/lib etc...</p>


	<p>Two different issues:</p>


	<ol>
	<li>Compile warning with EXIV2API struct Date</li>
		<li>Linking issues</li>
	</ol>


	<p><strong>1. Compiler warning (<a class="issue tracker-1 status-5 priority-4 priority-default closed" title="Bug: GCC warning when including exiv2.hpp (Closed)" href="/issues/898">#898</a>)</strong> in /usr/include/exiv2/value.hpp:<pre>1320 rmills@rmillsmbp-kubuntu:~/temp/forum $ grep EXIV2API /usr/include/exiv2/value.hpp | grep Date
    class EXIV2API DateValue : public Value {
        EXIV2API struct Date  &lt;---------------- WRONG
1320 rmills@rmillsmbp-kubuntu:~/temp/forum $ </pre>Should be:<pre>        struct EXIV2API Date</pre></p>


	<p><strong>2. Use libtool to do the linking</strong></p>


	<p>And now we are happy.  <strong>Here we go:</strong></p>


<pre>1314 rmills@rmillsmbp-kubuntu:~/temp/forum $ ls -alt
total 12
drwxrwxr-x 2 rmills rmills 4096 Apr 16 15:48 .
-rw-rw-r-- 1 rmills rmills 1676 Apr 16 15:28 exifprint.cpp
drwxr-xr-x 5 rmills rmills 4096 Apr 16 10:03 ..
1315 rmills@rmillsmbp-kubuntu:~/temp/forum $ make exifprint.o
g++    -c -o exifprint.o exifprint.cpp
1316 rmills@rmillsmbp-kubuntu:~/temp/forum $ libtool --mode=link g++ -g -O -lstdc++ -pthread exifprint.o -o exifprint /usr/lib/libexiv2.a -lz -lexpat
libtool: link: g++ -g -O -pthread exifprint.o -o exifprint  -lstdc++ /usr/lib/libexiv2.a -lz /usr/local/lib/libexpat.so -pthread
1317 rmills@rmillsmbp-kubuntu:~/temp/forum $ exifprint ~/R.jpg | wc
    156    4079   18748
1318 rmills@rmillsmbp-kubuntu:~/temp/forum $</pre>I had totally forgotten about <a class="issue tracker-1 status-5 priority-4 priority-default closed" title="Bug: GCC warning when including exiv2.hpp (Closed)" href="/issues/898">#898</a>.  It's my old brain-cell you know, it don't remember so good no more you know.

	<p><strong>3. Please ignore the linking issue this morning:</strong><pre>exifprint.cpp:(.text+0xac): undefined reference to `Exiv2::ImageFactory::open(std::string const&#38;, bool)'</pre>The API for ImageFactory::open has widened in v0.25 to include an optional bool.  I was compiling with the v0.25 headers and linking the v0.23 library.  Not found.  Correct.  My error.  And the v0.25 header already includes the fix to values.hpp which is why I didn't see the compiler warning about Date.</p>


	<p>I encourage you to build from the trunk as the binaries from the Linux Mafia are rather elderly.  We have a build server which builds and tests Kubuntu/MacOS-X/MSVC/MinGW/Cygwin every time we submit to trunk and selected branches.  So our build is seldom broken and almost always passes the test suite.  If you prefer to only use released code, you can download the v0.24 tarball from exiv2.org.  We hope to ship v0.25 in the next couple of months.</p></div>
  
  </div>
  <div class="message reply" id="message-2013">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/2008?r=2013#message-2013">RE: libexiv2 linking problems</a>
    -
    Added by <a class="user active" href="/users/4405">Norritt -</a> <a title="16 Apr 2015 20:19" href="/projects/exiv2/activity?from=2015-04-16">over 6 years</a> ago
  </h4>
  <div class="wiki"><p>Hey Robin,</p>


	<p>yes, solved indeed! Swapping "EXIV2API struct" (for me it was in line 984) and using libtool did the trick. Both your exifprint example as well as my code do now compile. Thanks a lot for your friendly and quick help, I really appreciate that - and sorry for causing you that much extra effort.</p>


	<p>As far as my habit to stick with the distribution code goes: Usually I prefer this method because it minimizes the risk of the afore mentioned header version mixup, plus I can be sure that anyone can run the code on a (*)ubuntu system without worrying about downloading the correct library source verions manually using svn. Also I have to admit I try to keep the overhad for managing sources of projects not maintained by myself to a minimum and prefer to let my system or namely the package management deal with updates automatically wherever possible, rather then updating manually via svn. Though I honestly didn't expect the current Kubuntu release to use <em>that</em> old packages. Considering this, your proposal to use your codebase from svn might actually still be the better option.</p>


	<p>Thanks again and have a nice evening!</p></div>
  
  </div>
  <div class="message reply" id="message-2014">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/2008?r=2014#message-2014">RE: libexiv2 linking problems</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="16 Apr 2015 21:30" href="/projects/exiv2/activity?from=2015-04-16">over 6 years</a> ago
  </h4>
  <div class="wiki"><p>Well thank you, Norritt.  I'm happy that you are happy.  And thank you for saying such nice things about my response to your query.  You didn't cause me "extra effort".  I simply took a while to unravel the overlapping puzzles:</p>


	<ol>
	<li>v0.25 headers</li>
		<li>v0.23 libraries</li>
		<li>header bug <a class="issue tracker-1 status-5 priority-4 priority-default closed" title="Bug: GCC warning when including exiv2.hpp (Closed)" href="/issues/898">#898</a></li>
		<li>the mysterious libtool</li>
	</ol>


	<p>Most issues are simple.  It's the analysis that's so puzzling.</p>


	<p>You're right to avoid code that hasn't been released.  I would like us to increase our release frequency and now that our Jenkins build server is working well, I believe we can.</p></div>
  
  </div>
</div>
<span class="pagination"><ul class="pages"></ul><span><span class="items">(1-6/6)</span> </span></span>



        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
