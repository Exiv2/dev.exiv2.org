<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Using an older version of expat - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="PoT1cCnTwElo6hVyEUKSsqeiluoCnCAGknsDrqofwdLcyV6fW6kMST2OCn6ulZ6BmDDCk/N/gbxvW5Mm6SYmvQ==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
</head>
<body class="project-exiv2 has-main-menu controller-messages action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="messages" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="messages" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=boards" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=boards">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards selected" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="nosidebar">
    <div id="sidebar">
        
        
    </div>

    <div id="content">
        
        <p class="breadcrumb"><a href="/projects/exiv2/boards">Forums</a> » <a href="/projects/exiv2/boards/3">Forum</a> » </p>

<div class="contextual">
    
    
    
    
</div>

<h2>Using an older version of expat</h2>

<div class="message">
<p><span class="author">Added by <a class="user active" href="/users/146">Anonymous Poster</a> <a title="22 Dec 2009 14:21" href="/projects/exiv2/activity?from=2009-12-22">almost 12 years</a> ago</span></p>
<div class="wiki">
<p>I have a program that uses exiv2 0.17.1, built using the wxWidgets framework, and it is working well.<br />Now I need to upgrade to the latest version (0.18.2) and I have read that it needs expat 2.0.1.<br />Unluckily wxWidgets ships with expat 1.95.6. Do you think that exiv2 would work with that older version of expat, or does it really need the newest version? I don't even know if and how I can change the expat version in wxWidgets, so keeping the older one would save me a lot of time.</p>


	<p>Thanks in advance.</p>


	<p>Fulvio Senore</p>
</div>

</div>
<br />

<div id="replies">
<h3 class="comments icon icon-comments">Replies (8)</h3>
  <div class="message reply" id="message-305">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/304?r=305#message-305">RE: Using an older version of expat</a>
    -
    Added by <a class="user active" href="/users/133">Robin Mills</a> <a title="23 Dec 2009 08:27" href="/projects/exiv2/activity?from=2009-12-23">almost 12 years</a> ago
  </h4>
  <div class="wiki"><p>On which platform are you working?</p>


	<p>If I guess you are using Windows, then I think it'll be OK.  If you put exiv2 and the expat DLL into the same directory, then having a different expat DLL on your hard drive shouldn't have any impact.  Of course if you want to use exiv2 and wxWidgets in the same application (eg Phatch) then you might have difficulties if the API of expat 2.0.1 is significantly different from 1.95.6.  Try it and see, however don't forget to keep your 'old' expat dll so you can restore your system if it doesn't work.</p>


	<p>If it doesn't work, please let me know more about your setup and the errors and I'll see what I can do.  Here are some options:<br />1) build exiv2 without XML support (which would remove XMP support)<br />2) build exiv2 with expat 1.95.6 (I don't know if this will build)<br />3) upgrade/build wxWidgets to a version which supports 2.0.1<br />4) build a version of exiv2 (or wxWidgets) which is statically linked with expat</p>


	<p>If it does work, can you let us know so that anybody else visiting this page knows you have succeeded.</p>


	<p>Robin</p></div>
  
  </div>
  <div class="message reply" id="message-306">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/304?r=306#message-306">RE: Using an older version of expat</a>
    -
    Added by <a class="user active" href="/users/318">Fulvio Senore</a> <a title="23 Dec 2009 10:01" href="/projects/exiv2/activity?from=2009-12-23">almost 12 years</a> ago
  </h4>
  <div class="wiki"><p>I am developing a program that works on Linux, OS X and Windows.</p>


	<p>I studied the problem a little more and I realized that expat is only used for XMP support.<br />Since at the moment I do not need to handle XMP I decided to build exiv2 without xml support. I upgraded exiv2 because I want to handle raw images and the ability to extract the previews is perfect for my purposes.<br />I already built the program under all the supported operating systems and everything is working fine. I statically linked exiv2 and expat.</p>


	<p>In the future I plan to add XMP support, so I will have to solve this problem. Maybe wxWidgets will be updated to the newest expat, otherwise I think that at first I will try and use expat 1.95.6. If it will not work I will try different solutions and you will surely find me back at this forum.</p>


	<p>Anyway, I will surely post a message when I will add XMP support.</p>


	<p>Thank you for your help.</p>


	<p>Fulvio Senore</p></div>
  
  </div>
  <div class="message reply" id="message-307">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/304?r=307#message-307">RE: Using an older version of expat</a>
    -
    Added by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="23 Dec 2009 17:38" href="/projects/exiv2/activity?from=2009-12-23">almost 12 years</a> ago
  </h4>
  <div class="wiki"><blockquote>

	<p>I studied the problem a little more and I realized that expat is only used for XMP support.</p>


</blockquote>

	<p>That's right. Since Exiv2 uses the XMP-SDK from Adobe, you might get a better answer from them, maybe here: <a class="external" href="http://forums.adobe.com/community/design_development/xmp_sdk">http://forums.adobe.com/community/design_development/xmp_sdk</a></p>


	<p>Besides, I think it should be possible to link two versions of expat into your program, one for Exiv2 and another version for wxWidget. They would normally be linked with different names, so that should work just fine.</p>


	<p>Andreas</p></div>
  
  </div>
  <div class="message reply" id="message-309">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/304?r=309#message-309">RE: Using an older version of expat</a>
    -
    Added by <a class="user active" href="/users/318">Fulvio Senore</a> <a title="24 Dec 2009 06:27" href="/projects/exiv2/activity?from=2009-12-24">almost 12 years</a> ago
  </h4>
  <div class="wiki"><p>Hello Andreas,</p>


	<p>thank you for the link, and thank you for exiv2: it is a great tool.</p>


	<p>I didn't think of linking two versions of expat. I thought that it would have led to symbols duplication at linking time.</p>


	<p>Fulvio</p></div>
  
  </div>
  <div class="message reply" id="message-310">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/304?r=310#message-310">RE: Using an older version of expat</a>
    -
    Added by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="24 Dec 2009 20:08" href="/projects/exiv2/activity?from=2009-12-24">almost 12 years</a> ago
  </h4>
  <div class="wiki"><p>I wasn't accurate. I thought if libexiv2.so has been linked with libexpat.so.1 and libwxwidgets.so with libexpat.so.2, it is possible to link a program with both, libexiv2.so as well as libwxwidgets.so and in turn they both would use their own version of libexpat.</p>


	<p>But although that doesn't result in duplicate symbols, it doesn't work anyway. This is what happens (using two versions of libexiv2 instead of libexpat):</p>


	<p>Let's build a sample liba.so which uses libexiv2 0.18.99 (trunk):</p>


<pre>
ahuggel@mowgli&gt; cat a.cpp
#include &lt;exiv2/types.hpp&gt;
#include &lt;iostream&gt;
#include "a.hpp" 

void a()
{
    std::cout &lt;&lt; "a(): Compiled with Exiv2 version " &lt;&lt; EXV_PACKAGE_VERSION &lt;&lt; "\n" 
              &lt;&lt; "     Runtime Exiv2 version is    " &lt;&lt; Exiv2::version()    &lt;&lt; "\n";
}

ahuggel@mowgli&gt; g++ -Wall -fPIC -DPIC -c a.cpp -o a.o
ahuggel@mowgli&gt; g++ -shared a.o -lexiv2 -o liba.so
ahuggel@mowgli&gt; ldd liba.so | grep exiv2
    libexiv2.so.5 =&gt; /usr/local/lib/libexiv2.so.5 (0xb7d71000)
</pre>

	<p>And another similar library libb.so which uses libexiv2 0.17</p>


<pre>
ahuggel@mowgli&gt; cat b.cpp
#include &lt;exiv2/types.hpp&gt;
#include &lt;iostream&gt;
#include "b.hpp" 

void b()
{
    std::cout &lt;&lt; "b(): Compiled with Exiv2 version " &lt;&lt; EXV_PACKAGE_VERSION &lt;&lt; "\n" 
              &lt;&lt; "     Runtime Exiv2 version is    " &lt;&lt; Exiv2::version()    &lt;&lt; "\n";
}

ahuggel@mowgli&gt; ldd libb.so | grep exiv2
    libexiv2.so.4 =&gt; /usr/local/lib/libexiv2.so.4 (0xb7e0c000)
</pre>

	<p>liba and libb are linked with different versions of libexiv2 which co-exist on my system. Programs that use either liba or libb also use the respective version of libexiv2, as expected.</p>


	<p>Now I can write a program that uses both, liba.so and libb.so</p>


<pre>
ahuggel@mowgli&gt; cat main.cpp
#include "a.hpp" 
#include "b.hpp" 

int main()
{
    a();
    b();
    return 0;
}
</pre>

	<p>This program compiles and links without complaining about duplicate symbols and seems to be linked with both versions of libexiv2:</p>


<pre>
ahuggel@mowgli&gt; g++ -Wall -L. -la -lb main.cpp -o main
ahuggel@mowgli&gt; ldd ./main | grep -e b[ab] -e exiv2
    liba.so (0xb7fdd000)
    libb.so (0xb7fda000)
    libexiv2.so.5 =&gt; /usr/local/lib/libexiv2.so.5 (0xb7b94000)
    libexiv2.so.4 =&gt; /usr/local/lib/libexiv2.so.4 (0xb7a03000)
</pre>

	<p>However, when I run the program, it only uses one version of libexiv2:</p>


<pre>
ahuggel@mowgli&gt; ./main
a(): Compiled with Exiv2 version 0.18.99
     Runtime Exiv2 version is    0.18.99
b(): Compiled with Exiv2 version 0.17
     Runtime Exiv2 version is    0.18.99
</pre>

	<p>I don't understand why this is so, but it reminds me of some very obscure bugs we saw in digiKam at one point.</p>


	<p>Andreas</p></div>
  
  </div>
  <div class="message reply" id="message-311">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/304?r=311#message-311">RE: Using an older version of expat</a>
    -
    Added by <a class="user active" href="/users/133">Robin Mills</a> <a title="24 Dec 2009 20:48" href="/projects/exiv2/activity?from=2009-12-24">almost 12 years</a> ago
  </h4>
  <div class="wiki"><p>Merry Christmas to the Huggel Family:</p>


	<p><img src="http://clanmills.com/images/Holiday2009.jpg" alt="" /></p>


	<p>Ah, the joys of linking libraries on Christmas Day.  This really interests me - however I haven't time at the moment to investigate.  There are debugging environment strings on the mac (man dyld) such as LD_PRINT_LIBRARIES which give more insight to the behavior of the dynamic loader at run time.  There's ldconfig on Linux which I've never used.  Windows has depends.exe and I distribute a home-made command-line version depends1.exe in the msvc directory for validating the build.</p>


	<p>Merry  Christmas to Everybody.</p></div>
  
  </div>
  <div class="message reply" id="message-317">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/304?r=317#message-317">RE: Using an older version of expat</a>
    -
    Added by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="25 Dec 2009 03:25" href="/projects/exiv2/activity?from=2009-12-25">almost 12 years</a> ago
  </h4>
  <div class="wiki"><p>Thanks Robin! And Merry Christmas to you and your family too!<br />Andreas</p></div>
  
  </div>
  <div class="message reply" id="message-320">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/304?r=320#message-320">RE: Using an older version of expat</a>
    -
    Added by <a class="user active" href="/users/318">Fulvio Senore</a> <a title="26 Dec 2009 01:08" href="/projects/exiv2/activity?from=2009-12-26">almost 12 years</a> ago
  </h4>
  <div class="wiki"><p>Andreas,</p>


	<p>thank you for taking the time to test this.</p>


	<p>I have a better knowledge of Windows than *nix, and I was thinking of static linking. That is why I thought about duplicated symbols.</p>


	<p>Fulvio</p></div>
  
  </div>
</div>
<span class="pagination"><ul class="pages"></ul><span><span class="items">(1-8/8)</span> </span></span>



        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
