<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>potential bug? or my mistake - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="LQbu9bfaH7bnPDwYBhTncLnN1ICKihG/a+GZDmbOHODPS0UaxaDTtrJYIxS5w+tDhl+A+XtpsAWWwQmGJff7jw==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
</head>
<body class="project-exiv2 has-main-menu controller-messages action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="messages" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="messages" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=boards" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=boards">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards selected" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="nosidebar">
    <div id="sidebar">
        
        
    </div>

    <div id="content">
        
        <p class="breadcrumb"><a href="/projects/exiv2/boards">Forums</a> » <a href="/projects/exiv2/boards/3">Forum</a> » </p>

<div class="contextual">
    
    
    
    
</div>

<h2>potential bug? or my mistake</h2>

<div class="message">
<p><span class="author">Added by <a class="user active" href="/users/6191">lestat lestrange</a> <a title="18 Aug 2017 18:47" href="/projects/exiv2/activity?from=2017-08-18">over 4 years</a> ago</span></p>
<div class="wiki">
<p>exiftool -b -ThumbnailImage test.cr2 > thumbnail.jpg</p>


	<p>Returns a rotated thumbnail. Why?</p>
</div>

</div>
<br />

<div id="replies">
<h3 class="comments icon icon-comments">Replies (5)</h3>
  <div class="message reply" id="message-2906">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/2905?r=2906#message-2906">RE: potential bug? or my mistake</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="18 Aug 2017 20:18" href="/projects/exiv2/activity?from=2017-08-18">over 4 years</a> ago
  </h4>
  <div class="wiki"><p>Can you attach a test file and I will look at it?  There is no pixel processing code in Exiv2, so images/thumbnails are never rotated, scaled, cropped or resampled.  The image and previews are exactly what was stored by the camera manufacturer.</p>


	<p>There is a metadata item Exif.Image.Orientation which can have a value 0..7  The values determine orientation.  I've forgotten the spec and in effect 3 bits which represent how the  image is encoded. left-to-right (or right-to-left), top-to-bottom (or bottom-to-top) not-rotated (or rotated).  This can be set when the camera is rotated.  <a class="external" href="http://www.exiv2.org/tags.html">http://www.exiv2.org/tags.html</a></p>


	<p>There could be additional information in the MakerNotes (the Camera Manufacturer's private data).  Exiv2 can usually read/modify/rewrite MakerNotes.  If Exif.Image.Orientation isn't specified (or is zero), please look at all the metadata and you'll probably find an explanation.  <a class="external" href="http://www.exiv2.org/tags-canon.html">http://www.exiv2.org/tags-canon.html</a></p>


	<p>There's a discussion about this on Canon's Forum:  <a class="external" href="http://community.usa.canon.com/t5/EOS-Rebel/Thumbnail-and-Image-not-in-the-same-orientation-in-Windows/td-p/211563">http://community.usa.canon.com/t5/EOS-Rebel/Thumbnail-and-Image-not-in-the-same-orientation-in-Windows/td-p/211563</a></p></div>
  
  </div>
  <div class="message reply" id="message-2907">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/2905?r=2907#message-2907">RE: potential bug? or my mistake</a>
    -
    Added by <a class="user active" href="/users/6191">lestat lestrange</a> <a title="18 Aug 2017 20:32" href="/projects/exiv2/activity?from=2017-08-18">over 4 years</a> ago
  </h4>
  <div class="wiki"><p>I cannot attach the image, it is 25b. Here is a drop box of it.</p>


	<p><a class="external" href="https://drive.google.com/file/d/0ByFF9-5uQ-qIcTRtbWEyMHk4S0E/view">https://drive.google.com/file/d/0ByFF9-5uQ-qIcTRtbWEyMHk4S0E/view</a></p>


	<p>Every file under that folder returns a sideways thumbnail.</p></div>
  
  </div>
  <div class="message reply" id="message-2908">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/2905?r=2908#message-2908">RE: potential bug? or my mistake</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="18 Aug 2017 21:49" href="/projects/exiv2/activity?from=2017-08-18">over 4 years</a> ago
  </h4>
  <div class="wiki"><p>Thank you for your files.</p>


	<p>I found the following discussion about Orientation:  <a class="external" href="http://sylvana.net/jpegcrop/exif_orientation.html">http://sylvana.net/jpegcrop/exif_orientation.html</a></p>


	<p>When I use the exiv2 image debugging feature -pR (print Structure Recursively), I see:<pre>868 rmills@rmillsmbp:~/Downloads/Origs $ exiv2 -pR TR01_Oatmeal_David_17-07-24_001.CR2  | grep -e ImageWidth -e ImageLength -e Orient
      18 | 0x0100 ImageWidth                |     SHORT |        1 |      5760 | 5760
      30 | 0x0101 ImageLength               |     SHORT |        1 |      3840 | 3840
     102 | 0x0112 Orientation               |     SHORT |        1 |         8 | 8
   71854 | 0x0100 ImageWidth                |     SHORT |        1 |       592 | 592
   71866 | 0x0101 ImageLength               |     SHORT |        1 |       395 | 395
869 rmills@rmillsmbp:~/Downloads/Origs $</pre>As you can see the Orientation is 8 which is a rotated image.  Canon stored a landscape 5760x3840 pixel image with orientation 8 (one of the rotated directions described in the reference above).  They also stored a preview landscape 592x395 pixels image which, I assume, is a downsampled version of the larger image.  As Exiv2 does not have code to manipulate the image, the preview has been extracted accurately in landscape.</p>


	<p>Image viewers (such as Preview on the Mac), understand the Orientation tag and rotate the image when it is displayed.  However, the image (and the preview) are stored in landscape.</p></div>
  
  </div>
  <div class="message reply" id="message-2909">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/2905?r=2909#message-2909">RE: potential bug? or my mistake</a>
    -
    Added by <a class="user active" href="/users/6191">lestat lestrange</a> <a title="18 Aug 2017 23:48" href="/projects/exiv2/activity?from=2017-08-18">over 4 years</a> ago
  </h4>
  <div class="wiki"><p>Can you show me the terminal command to flip the image to a regular picture for these pictures?</p></div>
  
  </div>
  <div class="message reply" id="message-2910">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/2905?r=2910#message-2910">RE: potential bug? or my mistake</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="19 Aug 2017 07:49" href="/projects/exiv2/activity?from=2017-08-19">over 4 years</a> ago
  </h4>
  <div class="wiki"><p>It's not the business of Exiv2 to manipulate the pixels in an image.  On the Mac, you can rotate the image with the sips command:<pre>$ sips --rotate 90 foo.jpg</pre>On other platforms, Image Magic provides tools for many image processing operations.  For example: <pre>$ jpegtran -rotate 90 foo.jpg &gt; foo90.jpg </pre></p>


	<p>Here is a reference to a discussion about image rotation.  Previews never contain metadata because this is forbidden by the Exif specification.  The author or this article discusses using ExifTool to insert the Orientation tag into the image.  Exiv2 can do the same task.  For most image viewers, this would appear to rotate the image.  In effect, the orientation tag is like putting the television on its side.  The image has not been modified, you have rotated the viewer.  <a class="external" href="http://www.imagemagick.org/discourse-server/viewtopic.php?t=21341">http://www.imagemagick.org/discourse-server/viewtopic.php?t=21341</a></p></div>
  
  </div>
</div>
<span class="pagination"><ul class="pages"></ul><span><span class="items">(1-5/5)</span> </span></span>



        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
