<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>build exiv2-0.23 with solarisstudio compiler 12.3  Error: Could not find a match for ... - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="jtx7n+jLECHAnjVSnKX2i3wwZmo4JLna2w89bF3R7MJskdBwmrHcIZX6Kl4jcvq4Q6IyE8nHGGAmL63kHugLrQ==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
</head>
<body class="project-exiv2 has-main-menu controller-messages action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="messages" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="messages" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=boards" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=boards">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards selected" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="nosidebar">
    <div id="sidebar">
        
        
    </div>

    <div id="content">
        
        <p class="breadcrumb"><a href="/projects/exiv2/boards">Forums</a> » <a href="/projects/exiv2/boards/3">Forum</a> » </p>

<div class="contextual">
    
    
    
    
</div>

<h2>build exiv2-0.23 with solarisstudio compiler 12.3  Error: Could not find a match for ...</h2>

<div class="message">
<p><span class="author">Added by <a class="user active" href="/users/3528">Carsten Grzemba</a> <a title="27 Jun 2012 02:44" href="/projects/exiv2/activity?from=2012-06-27">over 9 years</a> ago</span></p>
<div class="wiki">
<p>If i build exiv2 build on Solaris10 with solarisstudio compiler i got an error:</p>


	<p>$ /opt/solarisstudio12.3/bin/CC -xO3 -m32 -xarch=sparc -features=anachronisms,except,rtti,export,extensions,nestedaccess,tmplife,tmplrefstatic -I. -I/opt/csw/include -DEXV_LOCALEDIR=\"/opt/csw/share/locale\" -I../xmpsdk/include -c -DEXV_BUILDING_LIB=1 exif.cpp  -KPIC -DPIC -o .libs/exif.o<br />"exif.cpp", line 604: Error: Could not find a match for std::list&lt;Exiv2::Exifdatum&gt;::sort(bool(const Exiv2::Metadatum&#38;,const Exiv2::Metadatum&#38;)) needed in Exiv2::ExifData::sortByKey().<br />"exif.cpp", line 609: Error: Could not find a match for std::list&lt;Exiv2::Exifdatum&gt;::sort(bool(const Exiv2::Metadatum&#38;,const Exiv2::Metadatum&#38;)) needed in Exiv2::ExifData::sortByTag().<br />2 Error(s) detected.</p>


	<p>I am not an C++ expert and don't know how template matching work in detail.<br />Can somebody help how it can solved or work around it?</p>
</div>

</div>
<br />

<div id="replies">
<h3 class="comments icon icon-comments">Replies (17)</h3>
  <div class="message reply" id="message-1178">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1177?r=1178#message-1178">RE: build exiv2-0.23 with solarisstudio compiler 12.3  Error: Could not find a match for ...</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="27 Jun 2012 23:17" href="/projects/exiv2/activity?from=2012-06-27">over 9 years</a> ago
  </h4>
  <div class="wiki"><p>Carsten</p>


	<p>Thank you for reporting this.</p>


	<p>This code compiles with g++ (on Linux and Cygwin) and with MSVC on Windows.  So the solarisstudio compiler is unable to resolve his search for bool comparator(const Exiv2::Metadatum&#38;,...).</p>


	<p>The header is in metadatum.hpp (and the code in metadatum.cpp)<br />     EXIV2API bool cmpMetadataByTag(const Metadatum&#38; lhs, const Metadatum&#38; rhs);</p>


	<p>EXIV2API is a "house" decoration which I know for MSVC builds is set in exv_msvc.h  I know because I contributed this to exv_msvc.h</p>


	<p>For automake builds, the generated file exv_conf.h manages this and the EXIV2API decoration is not being correctly set for solaristudio.  I've listed the relevant code in exv_conf.h from the cygwin/g++ build.  You'll see there's a reference to __SUNPRO_C.  I think you'll probably have to extend the __SUNPRO_C code to also respect solarisstudio.</p>


	<p>The "source" file which generates exv_conf.h is config.h.in and when that's updated, I suspect:</p>


	<p>$ make clean; ./configure --whatever... ; make</p>


	<p>will make you happy.</p>


	<p>One last observation.  This declspec stuff relates to shared/DLL support.  Simply doing ./configure --disable-shared --enable-static will probably build "out of the box" without changes.  Of course you'll have a static build and that may (or may not) suit your purposes.</p>


	<p>I hope this helps.  If you are able to fix this, perhaps you could provide a patch file and I'll update the code base for other happy (or unhappy) users of solarisstudio.</p>


	<p>Robin</p>


<pre>
/* Symbol visibility support */
#ifdef WIN32
# define EXV_IMPORT __declspec(dllimport)
# define EXV_EXPORT __declspec(dllexport)
# define EXV_DLLLOCAL
# define EXV_DLLPUBLIC
#else
# ifdef EXV_WANT_VISIBILITY_SUPPORT
#  if defined(__GNUC__) &#38;&#38; (__GNUC__ &gt;= 4)
#   define EXV_IMPORT __attribute__ ((visibility("default")))
#   define EXV_EXPORT __attribute__ ((visibility("default")))
#   define EXV_DLLLOCAL __attribute__ ((visibility("hidden")))
#   define EXV_DLLPUBLIC __attribute__ ((visibility("default")))
#  elif defined(__SUNPRO_C) &#38;&#38; (__SUNPRO_C &gt;= 0x550)
#   define EXV_IMPORT __global
#   define EXV_EXPORT __global
#   define EXV_DLLLOCAL __hidden
#   define EXV_DLLPUBLIC __global
#  else
#   define EXV_IMPORT
#   define EXV_EXPORT
#   define EXV_DLLLOCAL
#   define EXV_DLLPUBLIC
#  endif
# else /* ! EXV_WANT_VISIBILITY_SUPPORT */
#  define EXV_IMPORT
#  define EXV_EXPORT
#  define EXV_DLLLOCAL
#  define EXV_DLLPUBLIC
# endif /* ! EXV_WANT_VISIBILITY_SUPPORT */
#endif /* ! WIN32 */

/* Define EXIV2API for DLL builds */
#ifdef EXV_HAVE_DLL
# ifdef EXV_BUILDING_LIB
#  define EXIV2API EXV_EXPORT
# else
#  define EXIV2API EXV_IMPORT
# endif /* ! EXV_BUILDING_LIB */
#else
# define EXIV2API
#endif /* ! EXV_HAVE_DLL */
</pre></div>
  
  </div>
  <div class="message reply" id="message-1179">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1177?r=1179#message-1179">RE: build exiv2-0.23 with solarisstudio compiler 12.3  Error: Could not find a match for ...</a>
    -
    Added by <a class="user active" href="/users/3528">Carsten Grzemba</a> <a title="29 Jun 2012 01:08" href="/projects/exiv2/activity?from=2012-06-29">over 9 years</a> ago
  </h4>
  <div class="wiki"><p>I can't see that this solves the problem. I guess that what you describe is related link problems, but I have a compile error.<br />Any other hints?</p></div>
  
  </div>
  <div class="message reply" id="message-1180">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1177?r=1180#message-1180">RE: build exiv2-0.23 with solarisstudio compiler 12.3  Error: Could not find a match for ...</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="29 Jun 2012 08:19" href="/projects/exiv2/activity?from=2012-06-29">over 9 years</a> ago
  </h4>
  <div class="wiki"><p>If the solarisstudio compiler has switch to trace loading header files, use that to be certain it read metadatum.hpp.</p></div>
  
  </div>
  <div class="message reply" id="message-1182">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1177?r=1182#message-1182">RE: build exiv2-0.23 with solarisstudio compiler 12.3  Error: Could not find a match for ...</a>
    -
    Added by <a class="user active" href="/users/3528">Carsten Grzemba</a> <a title="02 Jul 2012 00:15" href="/projects/exiv2/activity?from=2012-07-02">over 9 years</a> ago
  </h4>
  <div class="wiki"><p>I found out that Solaris Studio Compiler works if I use the libstl:<br />see also: <a class="external" href="https://forums.oracle.com/forums/thread.jspa?threadID=2408487&#38;tstart=0">https://forums.oracle.com/forums/thread.jspa?threadID=2408487&#38;tstart=0</a></p></div>
  
  </div>
  <div class="message reply" id="message-1183">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1177?r=1183#message-1183">RE: build exiv2-0.23 with solarisstudio compiler 12.3  Error: Could not find a match for ...</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="02 Jul 2012 05:59" href="/projects/exiv2/activity?from=2012-07-02">over 9 years</a> ago
  </h4>
  <div class="wiki"><p>I'm pleased to hear that you've got this to work.  Exactly what do you have to do?  Is it ./configure; make "CXXFLAGS=-library=libstl4" ; sudo make install ?</p></div>
  
  </div>
  <div class="message reply" id="message-1185">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1177?r=1185#message-1185">RE: build exiv2-0.23 with solarisstudio compiler 12.3  Error: Could not find a match for ...</a>
    -
    Added by <a class="user active" href="/users/3528">Carsten Grzemba</a> <a title="02 Jul 2012 23:13" href="/projects/exiv2/activity?from=2012-07-02">over 9 years</a> ago
  </h4>
  <div class="wiki"><p>Yes, with CXXFLAGS=-library=libstl4 it compiles, but now I have link errors:</p>


	<p>libtool: link: /opt/solarisstudio12.3/bin/CC -m32 -xarch=sparc -o .libs/taglist taglist.o  -L/opt/csw/lib -L/home/cgrzemba/opencsw/exiv2/trunk/work/build-isa-sparcv8plus/exiv2-0.23/xmpsdk/src ./.libs/libexiv2.so -lintl -liconv -lz -lm -lexpat -library=stlport4 -R/opt/csw/lib<br />Undefined                       first referenced<br /> symbol                             in file<br />bool Exiv2::ExifTags::isMakerGroup(const std::string &#38;) taglist.o<br />void Exiv2::ExifTags::taglist(std::ostream &#38;,const std::string &#38;) taglist.o<br />void Exiv2::ExifTags::taglist(std::ostream &#38;) taglist.o<br />void Exiv2::XmpProperties::printProperties(std::ostream &#38;,const std::string &#38;) taglist.o<br />bool Exiv2::ExifTags::isExifGroup(const std::string &#38;) taglist.o<br />Exiv2::__RTTI__1nFExiv2IAnyError_ taglist.o<br />[Hint: static member Exiv2::__RTTI__1nFExiv2IAnyError_ must be defined in the program]</p>


	<p>void Exiv2::IptcDataSets::dataSetList(std::ostream &#38;) taglist.o<br />ld: fatal: symbol referencing errors. No output written to .libs/taglist<br />gmake<sup><a href="#fn1">1</a></sup>: *** [taglist] Error 2</p></div>
  
  </div>
  <div class="message reply" id="message-1508">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1177?r=1508#message-1508">RE: build exiv2-0.23 with solarisstudio compiler 12.3  Error: Could not find a match for ...</a>
    -
    Added by <a class="user active" href="/users/3792">James McPherson</a> <a title="03 Apr 2013 04:06" href="/projects/exiv2/activity?from=2013-04-03">over 8 years</a> ago
  </h4>
  <div class="wiki"><p>I've just now (last 30 mins) successfully build Exiv2 v0.23 on Solaris 11.1 using the Solaris Studio 12.3 compiler.<br />This is for my migration of darktable from using non-Oracle dependencies (ie, built from pkg.openindiana.org/sfe<br />supplied g++).</p>


	<p>I used these environment settings:</p>


	<p>CXXFLAGS="-D__SUNOS__=1 -D__unix__=1 -D__SSE3__ -D__SSE__ -D__SSE2__ -D__SSE4__ -DOS_SOLARIS=1 -lumem -xlibmil -xlibmopt -xO5 -D__SIZE_TYPE__=size_t -xarch=sse3 -library=stdcxx4" <br />LDFLAGS="-R/usr/lib:/opt/darktable/lib -L/usr/lib -lstdcxx4 -lm -lumem -lc"</p>


	<p>I had to hack on the Makefiles to get various components to link correctly. It appears that some GNUisms are included<br />therein which Solaris Studio chokes on.</p>


	<p>I also had to add a collection of #include files {blocked out via #if defined(OS_SOLARIS)} so that I could build this<br />package with the Apache stdcxx4 library.</p>


	<p>I'll formalise the changes in the next few days (ie, tidy them up) and submit them as a patch against 0.23.</p></div>
  
  </div>
  <div class="message reply" id="message-1509">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1177?r=1509#message-1509">RE: build exiv2-0.23 with solarisstudio compiler 12.3  Error: Could not find a match for ...</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="03 Apr 2013 08:37" href="/projects/exiv2/activity?from=2013-04-03">over 8 years</a> ago
  </h4>
  <div class="wiki"><p>James</p>


	<p>Thanks for updating this.  It would be very helpful indeed for you to provide a patch.</p>


	<p>I've put a link to this discussion on the Wiki Page: <strong>How do I build Exiv2 <em>on the XYZ Platform</em></strong> <a class="external" href="http://dev.exiv2.org/projects/exiv2/wiki/How_do_I_build_Exiv2_on_the_XYZ_platform">http://dev.exiv2.org/projects/exiv2/wiki/How_do_I_build_Exiv2_on_the_XYZ_platform</a></p>


	<p>You're aware open source works by contributors sharing their experience.  You'll appreciate that without access to SolarisStudio, it's not possible for the Exiv2 team members to test anything on that platform.  If you have time and enthusiasm, perhaps you could build try to build Exiv2 with CMake and record your experience on this thread.</p>


	<p>Thanks very much for reporting your progress and success.</p>


	<p>Robin</p></div>
  
  </div>
  <div class="message reply" id="message-1512">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1177?r=1512#message-1512">RE: build exiv2-0.23 with solarisstudio compiler 12.3  Error: Could not find a match for ...</a>
    -
    Added by <a class="user active" href="/users/3792">James McPherson</a> <a title="05 Apr 2013 05:52" href="/projects/exiv2/activity?from=2013-04-05">over 8 years</a> ago
  </h4>
  <div class="wiki"><p>Building with cmake was much <strong>much</strong> easier than with the 0.23 tarball.</p>


	<p>I've attached diffs to enable building with</p>


	<p>#1 Solaris Studio 12.3<br />#2 Solaris 11.1<br />#3 using -library=stdcxx4 (the Apache stdcxx library).</p>


	<p>For reference, Oracle Solaris Studio is available for Linux via download from <a class="external" href="http://www.oracle.com/technetwork/server-storage/solarisstudio/downloads/index-jsp-141149.html">http://www.oracle.com/technetwork/server-storage/solarisstudio/downloads/index-jsp-141149.html</a></p>


	<p>The comments at the top of the attachment are</p>


	<ol>
	<li>environment flags used</li>
		<li>CC=cc</li>
		<li>CFLAGS=-D__SUNOS__=1 -D__unix__=1 -D__SSE3__ -D__SSE__ -D__SSE2__ -D__SSE4__ -DOS_SOLARIS=1 -lumem -xO3 -xarch=sse3 -R/opt/darktable/lib -lumem </li>
		<li>CXX=CC</li>
		<li>CXXFLAGS=-D__SUNOS__=1 -D__unix__=1 -D__SSE3__ -D__SSE__ -D__SSE2__ -D__SSE4__ -DOS_SOLARIS=1 -lumem -xO3 -xarch=sse3 -library=stdcxx4 -R/opt/darktable/lib -lumem </li>
		<li>LDFLAGS=-R/opt/darktable/lib -lumem </li>
		<li>PATH=/opt/SUNWspro/solarisstudio12.3/bin:/usr/perl5/bin:/opt/local/bin:/usr/gcc/4.6/bin/:/usr/bin:/usr/sbin:/bin:/sbin:/usr/dt/bin:/usr/sfw/bin:/usr/gnu/bin:</li>
	</ol>


####
	<ol>
	<li>This was for a CMake build. The CMake command line was</li>
		<li>mkdir build &#38;&#38; cd build </li>
		<li>cmake ..  -DCMAKE_INSTALL_PREFIX=/opt/darktable -DCMAKE_INSTALL_RPATH=/opt/darktable:/usr/lib
####</li>
	</ol>


	<p>Note that I have references to Darktable in the env vars because that's my use-case, building the library because it's a pre-req for the application.<br />I'm the Solaris maintainer of Darktable and blog about it at <a class="external" href="http://www.jmcpdotcom.com/blog/category/darktable">http://www.jmcpdotcom.com/blog/category/darktable</a>.</p>


	<p>I haven't svn committed the changes; I was surprised that 'svn commit -m ...' wanted a dev.exiv2.org username.</p></div>
  <div class="attachments">
<div class="contextual">
  
</div>
<table>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/469">exiv2_0.23-cmake_build_with_ss12_3_sol11_1.txt</a>    <span class="size">(6.8 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/469/exiv2_0.23-cmake_build_with_ss12_3_sol11_1.txt">exiv2_0.23-cmake_build_with_ss12_3_sol11_1.txt</a>  </td>
  <td></td>
  <td>
  </td>
  <td>
  </td>
</tr>
</table>
</div>

  </div>
  <div class="message reply" id="message-1513">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1177?r=1513#message-1513">RE: build exiv2-0.23 with solarisstudio compiler 12.3  Error: Could not find a match for ...</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="05 Apr 2013 07:52" href="/projects/exiv2/activity?from=2013-04-05">over 8 years</a> ago
  </h4>
  <div class="wiki"><p>Thanks for sending this, James.  I'll have a look at it over the weekend and submit it to the repos on your behalf (I'll acknowledge you in the commit message).  I'm sure you'll understand that we only grant write permission to our repos for "trusted friends".  It's not personal.  I worked for months on Exiv2 before being granted write access.</p>


	<p>I assume that your patch is relative to the trunk (and not the 0.23 branch).  My intention is to submit to trunk.</p>


	<p>Thanks for letting me know that Oracle SolarisStudio's is a free download for Linux.  One part of right-brain says "Ah, that'll be cool.  More toys", and left-brain says "Not so fast, buster.  That's yet another build/test platform.".  Right-brain usually wins.  I'll download and build with that.</p>


	<p>Robin</p></div>
  
  </div>
  <div class="message reply" id="message-1518">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1177?r=1518#message-1518">RE: build exiv2-0.23 with solarisstudio compiler 12.3  Error: Could not find a match for ...</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="16 Apr 2013 21:19" href="/projects/exiv2/activity?from=2013-04-16">over 8 years</a> ago
  </h4>
  <div class="wiki"><p>James</p>


	<p>Thanks very much for the patch. Submitted <a class="changeset" title="Patch:  Forum Topic 1177.  Thanks very much to James for providing this." href="/projects/exiv2/repository/exiv2/revisions/3018">r3018</a>.  You're welcome as a build engineer on our team anytime.  Thank You for this contribution.</p>


	<p>I've pasted your note from the top of your file here to help somebody in future.</p>


####
####
	<ol>
	<li>environment flags used</li>
		<li>CC=cc</li>
		<li>CFLAGS=-D__SUNOS__=1 -D__unix__=1 -D__SSE3__ -D__SSE__ -D__SSE2__ -D__SSE4__ -DOS_SOLARIS=1 -lumem -xO3 -xarch=sse3 -R/opt/darktable/lib -lumem </li>
		<li>CXX=CC</li>
		<li>CXXFLAGS=-D__SUNOS__=1 -D__unix__=1 -D__SSE3__ -D__SSE__ -D__SSE2__ -D__SSE4__ -DOS_SOLARIS=1 -lumem -xO3 -xarch=sse3 -library=stdcxx4 -R/opt/darktable/lib -lumem </li>
		<li>LDFLAGS=-R/opt/darktable/lib -lumem </li>
		<li>PATH=/opt/SUNWspro/solarisstudio12.3/bin:/usr/perl5/bin:/opt/local/bin:/usr/gcc/4.6/bin/:/usr/bin:/usr/sbin:/bin:/sbin:/usr/dt/bin:/usr/sfw/bin:/usr/gnu/bin:</li>
	</ol>


####
	<ol>
	<li>This was for a CMake build. The CMake command line was</li>
		<li>mkdir build &#38;&#38; cd build </li>
		<li>cmake ..  -DCMAKE_INSTALL_PREFIX=/opt/darktable -DCMAKE_INSTALL_RPATH=/opt/darktable:/usr/lib
####</li>
	</ol></div>
  
  </div>
  <div class="message reply" id="message-1519">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1177?r=1519#message-1519">RE: build exiv2-0.23 with solarisstudio compiler 12.3  Error: Could not find a match for ...</a>
    -
    Added by <a class="user active" href="/users/3762">Nehal J Wani</a> <a title="17 Apr 2013 11:16" href="/projects/exiv2/activity?from=2013-04-17">over 8 years</a> ago
  </h4>
  <div class="wiki"><p>On Fedora 17 (64-bit):</p>


	<p>I've tested revision 3019 of exiv2 from the svn trunk. Following are my observations:</p>


	<p>The following methods of building and testing work fine without any problem(s).</p>


	<p>GCC:</p>


	<p>(i) ./configure ; make ; make samples; make tests <br />(ii) cmake &lt;exiv2-dir&gt; ; make ; make samples; make tests</p>


	<p>SolarisStudio12.3: Tested on Fedora 17 (64-bit)</p>


	<p>(i) cmake -DCMAKE_CXX_FLAGS=-library=stlport4 -DCMAKE_CXX_COMPILER=/opt/oracle/solarisstudio12.3/bin/CC -DCMAKE_C_COMPILER=/opt/oracle/solarisstudio12.3/bin/cc &lt;exiv2-dir&gt; ; make ; make samples ; make tests</p>


	<p>Note: for linux platform, the option -DCMAKE_CXX_FLAGS=-library=stdcxx4 and -DCMAKE_CXX_FLAGS=-library=libstl4 both don't work. However, -DCMAKE_CXX_FLAGS=-library=stlport4 works. Also, couple of warnings arise.</p>


	<p>The ./configure method for SolarisStudio doesn't work :</p>


	<p>(ii) ./configure CXX=/opt/oracle/solarisstudio12.3/bin/CC CC=/opt/oracle/solarisstudio12.3/bin/cc CXXFLAGS=-library=stlport4<br />It gives the following error:</p>


	<p>[Wani@Linux trunk]$ make<br />if test "x1" = "x1"; then cd xmpsdk/src &#38;&#38; make xmpsdk; fi;<br />make<sup><a href="#fn1">1</a></sup>: Entering directory `/home/Wani/GSoC/exiv2-trunk/trunk/xmpsdk/src'<br />libtool: compile:  /opt/oracle/solarisstudio12.3/bin/CC -library=stlport4 -xldscope=hidden -I. -DEXV_LOCALEDIR=\"/usr/local/share/locale\" -I../include -funsigned-char -DNDEBUG=1 -DEXV_HAVE_STDINT_H=1 -c XML_Node.cpp  -KPIC -DPIC -o .libs/XML_Node.o<br />CC: Warning: Option -funsigned-char passed to ld, if ld is invoked, ignored otherwise<br />libtool: compile:  /opt/oracle/solarisstudio12.3/bin/CC -library=stlport4 -xldscope=hidden -I. -DEXV_LOCALEDIR=\"/usr/local/share/locale\" -I../include -funsigned-char -DNDEBUG=1 -DEXV_HAVE_STDINT_H=1 -c XML_Node.cpp -o XML_Node.o >/dev/null 2>&#38;1<br />CC: Warning: Option -funsigned-char passed to ld, if ld is invoked, ignored otherwise<br />/opt/oracle/solarisstudio12.3/prod/lib/amd64/crt1x.o: In function `_start':<br />fsr.s:(.text+0x3b): undefined reference to `main'<br />make<sup><a href="#fn1">1</a></sup>: <b>* [XML_Node.o] Error 2<br />make<sup><a href="#fn1">1</a></sup>: Leaving directory `/home/Wani/GSoC/exiv2-trunk/trunk/xmpsdk/src'<br />make: *</b> [xmpsdk] Error 2<br />[Wani@Linux trunk]$</p>


	<p>I've also tested revision 3020 of exiv2 from the svn trunk. Following are my observations:</p>


	<p>The following methods of building and testing work fine without any problem(s).</p>


	<p>GCC:</p>


	<p>(i) ./configure ; make ; make samples; make tests <br />(ii) cmake &lt;exiv2-dir&gt; ; make ; make samples; make tests</p>


	<p>These methods for SolarisStudio stop working:</p>


	<p>SolarisStudio12.3:</p>


	<p>(i) cmake -DCMAKE_CXX_FLAGS=-library=stlport4 -DCMAKE_CXX_COMPILER=/opt/oracle/solarisstudio12.3/bin/CC -DCMAKE_C_COMPILER=/opt/oracle/solarisstudio12.3/bin/cc &lt;exiv2-dir&gt; ; make ; make samples ; make tests<br />Error:<br />Scanning dependencies of target exiv2lib<br />[ 17%] Building CXX object src/CMakeFiles/exiv2lib.dir/asfvideo.cpp.o<br />"/home/Wani/GSoC/exiv2-trunk/trunk/src/error.cpp", line 29: Error: Multiple declaration for rcsId.<br />1 Error(s) detected.<br />make<sup><a href="#fn2">2</a></sup>: <b>* [src/CMakeFiles/exiv2lib.dir/asfvideo.cpp.o] Error 2<br />make<sup><a href="#fn1">1</a></sup>: <strong></b> [src/CMakeFiles/exiv2lib.dir/all] Error 2<br />make: *</strong>* [all] Error 2<br />[Wani@Linux trunk]$</p>


	<p>(ii) ./configure CXX=/opt/oracle/solarisstudio12.3/bin/CC CC=/opt/oracle/solarisstudio12.3/bin/cc CXXFLAGS=-library=stlport4<br />[Wani@Linux trunk]$ make<br />if test "x1" = "x1"; then cd xmpsdk/src &#38;&#38; make xmpsdk; fi;<br />make<sup><a href="#fn1">1</a></sup>: Entering directory `/home/Wani/GSoC/exiv2-trunk/trunk/xmpsdk/src'<br />libtool: compile:  /opt/oracle/solarisstudio12.3/bin/CC -library=stlport4 -xldscope=hidden -I. -DEXV_LOCALEDIR=\"/usr/local/share/locale\" -I../include -funsigned-char -DNDEBUG=1 -DEXV_HAVE_STDINT_H=1 -c XML_Node.cpp  -KPIC -DPIC -o .libs/XML_Node.o<br />CC: Warning: Option -funsigned-char passed to ld, if ld is invoked, ignored otherwise<br />libtool: compile:  /opt/oracle/solarisstudio12.3/bin/CC -library=stlport4 -xldscope=hidden -I. -DEXV_LOCALEDIR=\"/usr/local/share/locale\" -I../include -funsigned-char -DNDEBUG=1 -DEXV_HAVE_STDINT_H=1 -c XML_Node.cpp -o XML_Node.o >/dev/null 2>&#38;1<br />CC: Warning: Option -funsigned-char passed to ld, if ld is invoked, ignored otherwise<br />/opt/oracle/solarisstudio12.3/prod/lib/amd64/crt1x.o: In function `_start':<br />fsr.s:(.text+0x3b): undefined reference to `main'<br />make<sup><a href="#fn1">1</a></sup>: <b>* [XML_Node.o] Error 2<br />make<sup><a href="#fn1">1</a></sup>: Leaving directory `/home/Wani/GSoC/exiv2-trunk/trunk/xmpsdk/src'<br />make: *</b> [xmpsdk] Error 2<br />[Wani@Linux trunk]$</p>


	<p>I've attached the outputs of each case, which include warnings and errors.</p></div>
  <div class="attachments">
<div class="contextual">
  
</div>
<table>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/491">SolarisStudio_Rev3019_configure.txt</a>    <span class="size">(12.3 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/491/SolarisStudio_Rev3019_configure.txt">SolarisStudio_Rev3019_configure.txt</a>  </td>
  <td>SolarisStudio-R3019-configure</td>
  <td>
  </td>
  <td>
  </td>
</tr>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/492">SolarisStudio_Rev3020_Cmake.txt</a>    <span class="size">(8.78 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/492/SolarisStudio_Rev3020_Cmake.txt">SolarisStudio_Rev3020_Cmake.txt</a>  </td>
  <td>SolarisStudio-R3020-Cmake</td>
  <td>
  </td>
  <td>
  </td>
</tr>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/493">SolarisStudio_Rev3020_configure.txt</a>    <span class="size">(11.2 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/493/SolarisStudio_Rev3020_configure.txt">SolarisStudio_Rev3020_configure.txt</a>  </td>
  <td>SolarisStudio-R3020-configure</td>
  <td>
  </td>
  <td>
  </td>
</tr>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/494">GCC_Rev3019_Cmake.txt</a>    <span class="size">(15.6 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/494/GCC_Rev3019_Cmake.txt">GCC_Rev3019_Cmake.txt</a>  </td>
  <td>GCC-R3019-Cmake</td>
  <td>
  </td>
  <td>
  </td>
</tr>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/495">GCC_Rev3019_configure.txt</a>    <span class="size">(82.2 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/495/GCC_Rev3019_configure.txt">GCC_Rev3019_configure.txt</a>  </td>
  <td>GCC-R3019-configure</td>
  <td>
  </td>
  <td>
  </td>
</tr>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/496">GCC_Rev3020_Cmake.txt</a>    <span class="size">(15.7 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/496/GCC_Rev3020_Cmake.txt">GCC_Rev3020_Cmake.txt</a>  </td>
  <td>GCC-R3020-Cmake</td>
  <td>
  </td>
  <td>
  </td>
</tr>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/497">GCC_Rev3020_configure.txt</a>    <span class="size">(74.6 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/497/GCC_Rev3020_configure.txt">GCC_Rev3020_configure.txt</a>  </td>
  <td>GCC-R3020-configure</td>
  <td>
  </td>
  <td>
  </td>
</tr>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/498">SolarisStudio_Rev3019_Cmake.txt</a>    <span class="size">(23.7 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/498/SolarisStudio_Rev3019_Cmake.txt">SolarisStudio_Rev3019_Cmake.txt</a>  </td>
  <td>SolarisStudio-R3019-Cmake</td>
  <td>
  </td>
  <td>
  </td>
</tr>
</table>
</div>

  </div>
  <div class="message reply" id="message-1520">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1177?r=1520#message-1520">RE: build exiv2-0.23 with solarisstudio compiler 12.3  Error: Could not find a match for ...</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="17 Apr 2013 20:55" href="/projects/exiv2/activity?from=2013-04-17">over 8 years</a> ago
  </h4>
  <div class="wiki"><p>Thanks, Nehal.  You've gone to a lot of trouble and reported many results.  I believe the summary is that Exiv2 <a class="changeset" title="Update to r3018 to eliminate compiler warnings from GCC on Mac." href="/projects/exiv2/repository/exiv2/revisions/3020">r3020</a> builds and passes the test suite with GCC.  I can confirm that it is also good on Cygwin (GCC 4.6.2), the Mac 10.8 (Xcode 4.6.2) and Kubuntu 12.10 (GCC 4.8.0).</p>


However for SolarisStudio you have reported:
	<ul>
	<li>./cmake    #Fails! (with -library=stlport4)</li>
		<li>./configure #Fails! (with -library=stlport4)</li>
	</ul>


	<p>Regrettably, I have been unable to reproduce this because I been unable to install SolarisStudio 12.3 on my Kubuntu 12.10/64 system.</p>


James:
	<ol>
	<li>May I ask you to sync the trunk and build and test with SolarisStudio.<br />- I added a change in <a class="changeset" title="Update to r3018 to eliminate compiler warnings from GCC on Mac." href="/projects/exiv2/repository/exiv2/revisions/3020">r3020</a> to silence compiler warnings from rcsid_int.hpp.<br />- If <a class="changeset" title="Update to r3018 to eliminate compiler warnings from GCC on Mac." href="/projects/exiv2/repository/exiv2/revisions/3020">r3020</a> has broken the SolarisStudio build, can you suggest an alternative change.</li>
		<li>Have you been able to build with the autotools - or do you only recommend CMake for SolarisStudio?<br />- $ make distclean ; make config ; ./configure ; make ; sudo make install ; make samples ; make tests</li>
	</ol>


	<p>Robin</p></div>
  
  </div>
  <div class="message reply" id="message-1523">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1177?r=1523#message-1523">RE: build exiv2-0.23 with solarisstudio compiler 12.3  Error: Could not find a match for ...</a>
    -
    Added by <a class="user active" href="/users/3792">James McPherson</a> <a title="19 Apr 2013 05:20" href="/projects/exiv2/activity?from=2013-04-19">over 8 years</a> ago
  </h4>
  <div class="wiki"><p>I pulled <a class="changeset" title="Update to r3018 to eliminate compiler warnings from GCC on Mac." href="/projects/exiv2/repository/exiv2/revisions/3020">r3020</a> and rebuilt. I regret to say that I didn't pay close enough attention to the preprocessed source in my earlier comments. When I tried to reduce the branches in the #if..#else for rcsId I observed the following behaviour:</p>


	<p>"/scratch/src/photostuff/darktable/dependencies/exiv2-0.23-svn/src/asfvideo.cpp", line 30: Error: A declaration was expected instead of "{".<br />"/scratch/src/photostuff/darktable/dependencies/exiv2-0.23-svn/src/asfvideo.cpp", line 30: Error: A declaration was expected instead of "}".<br />2 Error(s) detected.</p>


	<p>This occurred unless I commented out the line following the opening of the macro. Checking the pre-processed source resulting from that change lead me to the point of enlightenment: Studio C++ doesn't appear to allow multiline macros like this one for rcsId.</p>


	<p>Using this block instead seems to be more correct, at the nominal expense of the rcsId ident string:</p>


<pre>
#if defined(__clang__) || (defined(OS_SOLARIS) &#38;&#38; defined(__SUNPRO_CC))
#define EXIV2_RCSID(id)
#else
#define EXIV2_RCSID(id) \
    namespace { \
        inline const char* getRcsId(const char*) { return id ; } \
        const char* rcsId = getRcsId(rcsId); \
    }
#endif

</pre></div>
  
  </div>
  <div class="message reply" id="message-1524">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1177?r=1524#message-1524">RE: build exiv2-0.23 with solarisstudio compiler 12.3  Error: Could not find a match for ...</a>
    -
    Added by <a class="user active" href="/users/3792">James McPherson</a> <a title="19 Apr 2013 05:30" href="/projects/exiv2/activity?from=2013-04-19">over 8 years</a> ago
  </h4>
  <div class="wiki"><p>Robin, in response to the other part of your question: I've only got this building via CMake. While I could go and hack up on the various g++ flags to remove those which conflict with Studio, or change them to the Studio equivalents, it's so much easier to use CMake instead that I won't bother.</p></div>
  
  </div>
  <div class="message reply" id="message-1525">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1177?r=1525#message-1525">RE: build exiv2-0.23 with solarisstudio compiler 12.3  Error: Could not find a match for ...</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="19 Apr 2013 21:31" href="/projects/exiv2/activity?from=2013-04-19">over 8 years</a> ago
  </h4>
  <div class="wiki"><p>Thank you James and Nehal for your work on this.  Much appreciated.  I've submitted 3021 which I believe will resolve the issue with src/rcsid_int.hpp.  I've reversed the logic of the decision to accept or ignore the macro EXIV2_RCSID.  Only GCC/G++/MSC will accept the EXIV2_RCSID.  Hopefully, we're now good.</p>


	<p>We are all in agreement that CMake should be used to build with the Oracle compilers and that ./configure (autotools) is broken.</p>


Nehal provided the following insight <em>(by private email)</em> to persuade the Oracle compilers to work on Kubuntu 12.10/64.
	<ol>
	<li>Install the 32 bit libraries</li>
		<li>use non-standard options for the compiler</li>
	</ol>


	<p>Of course the compilers (cc for C, and CC for C++) <strong>must be on your path</strong><br /><pre>
$ sudo apt-get install libc6-dev-i386 libc6-i386 lib32gcc1 lib32z1 lib32stdc++6 ia32-libs -y
$ CC -m32 -L/lib32 -R/lib32 foo.cpp -o foo
CC: Warning: failed to detect system linker version, falling back to custom linker usage
$ ./foo
</pre>The warning is benign and the compile and link is a success.  I build and installed expat 2.1.0 and zlib-1.2.7 from source with the Oracle compiler.</p>


	<p>I've used Nehal's flags with CMake.  It compiled xmpsdk and stopped at 29% on exif.cpp<br /><pre>
$ export CFLAGS="-m32 -L/lib32 -R/lib32" 
$ export CXXFLAGS="-m32 -L/lib32 -R/lib32" 
$ export LDFLAGS="-m32 -L/lib32 -R/lib32" 
$ cmake -DCMAKE_CXX_COMPILER=CC -DCMAKE_C_COMPILER=cc relative-path-to-exiv
$ make
</pre><br />James and Nehal:<br />I value the effort you have put into this.  Perhaps you'll have time over the weekend to confirm that that my changes to rcsid_int.hpp have been effective.</p>


	<p>Robin</p></div>
  
  </div>
  <div class="message reply" id="message-1526">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1177?r=1526#message-1526">RE: build exiv2-0.23 with solarisstudio compiler 12.3  Error: Could not find a match for ...</a>
    -
    Added by <a class="user active" href="/users/3762">Nehal J Wani</a> <a title="21 Apr 2013 10:16" href="/projects/exiv2/activity?from=2013-04-21">over 8 years</a> ago
  </h4>
  <div class="wiki"><p>I have built <a class="changeset" title="Forum: #1177.  Only compile EXIV2_RCSID for Complers: GCC/G++/MSC to silence warnings.  All other..." href="/projects/exiv2/repository/exiv2/revisions/3021">r3021</a> on Fedora 17/6 with Solaris Studio Compiler 12.3. CMake was used. There were no problems with the compilation, but only warnings. Although the software compiled fine, one of the test cases produced a diff with the standard result. I have attached the file relating to that.</p>


	<p>I also built <a class="changeset" title="Forum: #1177.  Only compile EXIV2_RCSID for Complers: GCC/G++/MSC to silence warnings.  All other..." href="/projects/exiv2/repository/exiv2/revisions/3021">r3021</a> with with GCC (./configure and Cmake) and there are no problems with the compilation and tests.</p></div>
  <div class="attachments">
<div class="contextual">
  
</div>
<table>
<tr>
  <td>
    <a class="icon icon-attachment" href="/attachments/499">SolarisStudio_Rev3021_Cmake.txt</a>    <span class="size">(23.7 KB)</span>
    <a class="icon-only icon-download" title="Download" href="/attachments/download/499/SolarisStudio_Rev3021_Cmake.txt">SolarisStudio_Rev3021_Cmake.txt</a>  </td>
  <td></td>
  <td>
  </td>
  <td>
  </td>
</tr>
</table>
</div>

  </div>
</div>
<span class="pagination"><ul class="pages"></ul><span><span class="items">(1-17/17)</span> </span></span>



        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
