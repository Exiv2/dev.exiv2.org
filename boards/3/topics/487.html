<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Does exiv2 have a -silent flag to not show console window? - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="3mb4kKP9Wh3J51Xnt2lCtblPddNmDaq9uTgSgZ69kNc8K1N/0YeWHZyDSusIvk6Ght0hqpfuCwdEGIIJ3YR3uA==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
</head>
<body class="project-exiv2 has-main-menu controller-messages action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="messages" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="messages" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=boards" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=boards">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards selected" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="nosidebar">
    <div id="sidebar">
        
        
    </div>

    <div id="content">
        
        <p class="breadcrumb"><a href="/projects/exiv2/boards">Forums</a> » <a href="/projects/exiv2/boards/3">Forum</a> » </p>

<div class="contextual">
    
    
    
    
</div>

<h2>Does exiv2 have a -silent flag to not show console window?</h2>

<div class="message">
<p><span class="author">Added by <a class="user active" href="/users/192">Bob Davies</a> <a title="13 Apr 2010 03:56" href="/projects/exiv2/activity?from=2010-04-13">over 11 years</a> ago</span></p>
<div class="wiki">
<p>I'm trying to launch exiv2 in the background from a firefox window, but there is currently a <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=485946" class="external">bug</a> in firefox which causes executable called at the commandline (when executed on windows) to display the console (and not very gracefully either).<br />I'm just wondering if maybe exiv2 has a -silent flag to not show console window?<br />It's not critical or anything, but I'm hoping to avoid kludging it with vbscript or anything like that.<br />Cheers<br />Bob</p>
</div>

</div>
<br />

<div id="replies">
<h3 class="comments icon icon-comments">Replies (8)</h3>
  <div class="message reply" id="message-488">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/487?r=488#message-488">RE: Does exiv2 have a -silent flag to not show console window?</a>
    -
    Added by <a class="user active" href="/users/133">Robin Mills</a> <a title="14 Apr 2010 02:18" href="/projects/exiv2/activity?from=2010-04-14">over 11 years</a> ago
  </h4>
  <div class="wiki"><p>Bob</p>


	<p>This is quite common 'windowsism'.  Python provides two variants - python.exe and pythonw.exe.  python.exe is the (dos) command line version and will throw a dos box thing on the display if you fire him from most apps (with the system() or some variant).  pythonw.exe however starts the python interpreter in a 'windows' environment (and no horrible dos box).</p>


	<p>I think it is however possible to start processes with the CreateProcess Win32 call and avoid the horrible dos box thing.  And I believe you can access the Win32 APIs from VB (or via a com object or something).  I don't know anything about Firefox plugins, however it sounds as though they should be using CreateProcess, however they've dropped you in trouble by using system() - and you've got this dos box thing on the glass.  Yuck!</p>


	<p>So it's not quite as simple as adding a flag -silent, the medicine is probably to add a new build target exiv2w which links exiv2 using the 'windows' environment.  I think I'm willing to do that for you in the MSVC branch.  However I'm not willing to offer anything at the moment for the cygwin build.  For sure, I will not commit new build targets without Andreas's agreement.</p>


	<p>So..... maybe you could say a little more about this.  If you can fix this from VB (with CreateProcess or something) then I don't need to do anything.  If you need assistance, I think I'm willing to do a private build of exiv2w for 0.19 with MSVC.  Are you using (or even better, building) with MSVC build.  Or do you use the precompiled Cygwin binaries?</p></div>
  
  </div>
  <div class="message reply" id="message-489">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/487?r=489#message-489">RE: Does exiv2 have a -silent flag to not show console window?</a>
    -
    Added by <a class="user active" href="/users/192">Bob Davies</a> <a title="14 Apr 2010 03:04" href="/projects/exiv2/activity?from=2010-04-14">over 11 years</a> ago
  </h4>
  <div class="wiki"><p>Aye, they changed to using ShellExecute instead of CreateProcess in 3.0, so it created this problem on windows (cos mac and linux are fine).<br />I was just hoping there might, maybe, possibly have been a -s flag hidden in there somewhere ;)<br />It can be worked around by using vb or simple executable (like hstart) to launch exiv2 quietly, it just means I may have to make end-users aware that some anti-virus or anti-malware may kick up alerts as a result. <br />I think I'll try knocking together a very simple exe for sending the call using CreateProcess, then compiling that for 'windows' env.<br />Thanks :)<br />Bob</p></div>
  
  </div>
  <div class="message reply" id="message-490">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/487?r=490#message-490">RE: Does exiv2 have a -silent flag to not show console window?</a>
    -
    Added by <a class="user active" href="/users/133">Robin Mills</a> <a title="14 Apr 2010 13:58" href="/projects/exiv2/activity?from=2010-04-14">over 11 years</a> ago
  </h4>
  <div class="wiki"><p>That's interesting, Bob.  I started thinking about this at breakfast this morning and thought "linking it to run as a windows app isn't the solution because you probably want to use the stdout stream".</p>


	<p>The solution is to provide a helper app which runs our "everyday" exiv2 application which writes to stdout on an invisible desktop.  Servers like IIS run on an invisible desktop.  The horrible dos box is still there of course, however nobody ever sets the invisible desktop to be their active desktop (although I have in the past).</p>


	<p>Incidentally, it's impossible for us to fix this from the command-line version of the console application exiv2.exe.  The dos box is created to host exiv2.exe.  So the box is on the display before we've arrived at main().</p>


	<p>And then you mentioned hstart.  Sounds like Hidden start to me.  I googled it and you're 100% on the money:  <a class="external" href="http://www.ntwind.com/software/utilities/hstart.html">http://www.ntwind.com/software/utilities/hstart.html</a></p>


	<p>I think hstart does exactly the following:  It launches a target (exiv2.exe) on the invisible desktop with CreateProcess.  You've solved it without us having to change anything.  Thanks.</p></div>
  
  </div>
  <div class="message reply" id="message-491">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/487?r=491#message-491">RE: Does exiv2 have a -silent flag to not show console window?</a>
    -
    Added by <a class="user active" href="/users/192">Bob Davies</a> <a title="14 Apr 2010 14:29" href="/projects/exiv2/activity?from=2010-04-14">over 11 years</a> ago
  </h4>
  <div class="wiki"><p>Yes Hidden Start is something I've used a few times in the past for running apps locally or for friends, but really couldn't face a slew of "[insert virus scanner name here] says your app is a virus, you suck!" so rather than use the well known (and rather heavyhanded) hstart, thanks to your console app as a windows app suggest, I've put together a pretty basic C++ app which can be used to proxy the call. <br />It's a simple wrapper for a CreateProcess call with the showWindow flag set off, and since I'm mainly using -eX or -iX the stdout isn't a requirement for me.</p>


	<p>It took a bit of digging a little deeper into the compiler options than I usually do, but looks like it will do the trick. Almost finished, just struggling to remember my C pointer/array references and conversion stuff (was in c# for way too long and got very lazy), but will post a link here when it's done for anyone else facing the same problem :)</p>


	<p>Thank you very much for the help :)<br />Bob</p></div>
  
  </div>
  <div class="message reply" id="message-492">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/487?r=492#message-492">RE: Does exiv2 have a -silent flag to not show console window?</a>
    -
    Added by <a class="user active" href="/users/133">Robin Mills</a> <a title="14 Apr 2010 16:57" href="/projects/exiv2/activity?from=2010-04-14">over 11 years</a> ago
  </h4>
  <div class="wiki"><p>Bob</p>


	<p>I'll be very happy to review your code if you wish.  I am a C++ warrior - so I'm used to the pain of pointers and stuff.  <a class="email" href="mailto:robin@clanmills.com">robin@clanmills.com</a></p></div>
  
  </div>
  <div class="message reply" id="message-493">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/487?r=493#message-493">RE: Does exiv2 have a -silent flag to not show console window?</a>
    -
    Added by <a class="user active" href="/users/192">Bob Davies</a> <a title="15 Apr 2010 10:12" href="/projects/exiv2/activity?from=2010-04-15">over 11 years</a> ago
  </h4>
  <div class="wiki"><p>I've put together a very simple wrapper to CreateProcess which can be used to call executables silently. <br />You can get it here: <a class="external" href="http://www.robertadavies.co.uk/2010/04/silentstart/">http://www.robertadavies.co.uk/2010/04/silentstart/</a><br />My knowledge of C/C++ is very limited, so I'd appreciate some eyes on the code (included in the download) and any feedback or improvements are appreciated.</p></div>
  
  </div>
  <div class="message reply" id="message-494">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/487?r=494#message-494">RE: Does exiv2 have a -silent flag to not show console window?</a>
    -
    Added by <a class="user active" href="/users/133">Robin Mills</a> <a title="15 Apr 2010 22:13" href="/projects/exiv2/activity?from=2010-04-15">over 11 years</a> ago
  </h4>
  <div class="wiki"><p>Bob</p>


	<p>I looked at the code,  built and and ran it without any trouble on Dev Studio 2008 Std Edition.  DevStudio C++ Express 2008 complained about afxres.h not being available to the resource compiler. afxres.h is a Microsoft file and I don't think it's redistributable.  So.... Express can't deal with it.</p>


	<p>I looked at the code and it looks OK to me.  I'm rather surprised it's so simple.  I think it'd be a little more complex if you wanted to capture stdout somewhere (but not very much more complex).  Good Job!</p>


	<p>If this achieves your aims, then I see no reason for you to spend more time at the moment.  I think you should maybe consider supporting unicode as your plugin could be used in locales where this is mission critical - such as south east asia.  I'm sure you wouldn't want Andreas' wife to report a bug to you now, would you?  (mind you I'm sure Andreas does let his mrs use windows!).</p></div>
  
  </div>
  <div class="message reply" id="message-495">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/487?r=495#message-495">RE: Does exiv2 have a -silent flag to not show console window?</a>
    -
    Added by <a class="user active" href="/users/192">Bob Davies</a> <a title="17 Apr 2010 17:47" href="/projects/exiv2/activity?from=2010-04-17">over 11 years</a> ago
  </h4>
  <div class="wiki"><p>Thanks :)<br />Aye, I tried to output messages to the console, but couldn't figure it out. Presumably the stdout handle isn't available for some reason. No idea why.<br />It's built as unicode, but again, encodings aren't something I'm familiar with (another C# handhold preventing actual learning) I've ended up using the A commands (presumably ansi, rather than wide) as that's what seems to work, but beyond that I don't really understand 'why' it works to use those instead of the W ones lol :D</p></div>
  
  </div>
</div>
<span class="pagination"><ul class="pages"></ul><span><span class="items">(1-8/8)</span> </span></span>



        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
