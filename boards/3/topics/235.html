<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>compile for OS X on PPC help - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="hRwzmexSDK+Q6PGlbOWGTeFjP88rlWiXt9m/pAoKSihnUZh2nijAr8WM7qnTMop+3vFrttp2yS1K+S8sSTOtRw==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
</head>
<body class="project-exiv2 has-main-menu controller-messages action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="messages" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="messages" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=boards" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=boards">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards selected" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="nosidebar">
    <div id="sidebar">
        
        
    </div>

    <div id="content">
        
        <p class="breadcrumb"><a href="/projects/exiv2/boards">Forums</a> » <a href="/projects/exiv2/boards/3">Forum</a> » </p>

<div class="contextual">
    
    
    
    
</div>

<h2>compile for OS X on PPC help</h2>

<div class="message">
<p><span class="author">Added by <a class="user active" href="/users/258">Samuel Turner</a> <a title="07 Oct 2009 09:14" href="/projects/exiv2/activity?from=2009-10-07">about 12 years</a> ago</span></p>
<div class="wiki">
<p>I have managed to compile exiv2 for use on OS X 10.5x on an Intel machine but not for 10.4x on a PPC and cannot get the thing to compile on my PPC computer, can anybody please help, I'm quite confused with the extra libraries I had to download also and would rather it be done by somebody who has the setup required - its just been so troublesome for me.</p>


	<p>If anybody can help out I'd really appreciate that!</p>


	<p>Thanks.</p>
</div>

</div>
<br />

<div id="replies">
<h3 class="comments icon icon-comments">Replies (3)</h3>
  <div class="message reply" id="message-275">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/235?r=275#message-275">RE: compile for OS X on PPC help</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="16 Nov 2009 11:52" href="/projects/exiv2/activity?from=2009-11-16">about 12 years</a> ago
  </h4>
  <div class="wiki"><p>Samuel</p>


	<p>We've discussed this off-line and I have no new information for you here.  However, someone else may visit this page and I'm offering advice for them.</p>


	<p>I have successfully built exiv2 on PPC on my elderly PowerBook G4 running Tiger and for Intel on my (intel-based) iMac running Leopard.</p>


	<p>The simplest way I know to build exiv2 on the Mac is to install MacPorts.  Then request exiv2 (sudo port install exiv2).  This will pull down the dependancies (expat, gettext, libiconv and zlib).  This ran for about 2 hours on my PowerBook G4 - however it did build successfully.  It was a lot faster on the iMac.</p>


	<p>I've also built exiv2 'by hand' and published my build notes at this location:  <a class="external" href="http://clanmills.com/articles/gpsexiftags/macos.shtml">http://clanmills.com/articles/gpsexiftags/macos.shtml</a>  These notes cover the building of exiv2 and pyexiv2 (v0.1.3) a Python wrapper for exiv2.  pyexiv2 requires the building of boost_python library.  So building exiv2 is a subset of the buildnotes on clanmills.com.</p>


	<p>If you have the dependences already built and installed, the following command sequence (which is typical of gnu software) will work from the exiv2 source directory:</p>


	<p>cd ~/gnu/exiv2   # or where-ever you decide to put the source code)<br />make config ; ./configure ; make ; sudo make install</p>


	<p>I recommend that you decompress the released code from the exiv2 web site. The more adventurous may wish to checkout the code with SVN.</p>


	<p>I have built a 'universal' (ppc/i386) version.  However I had to build the ppc version on the Powerbook and the intel version on the iMac and then combine them with lipo.  It is of course very desirable to build a 'universal' on an intel machine and perhaps somebody will find and contribute a solution.  The Apple Tech note (TN2137) on this subject side evades this issue by stating 'the configure environment was not envisioned with a universal binary-like sitatuion in mind'.  However the technote does discuss lipo:  <a class="external" href="http://developer.apple.com/mac/library/technotes/tn2005/tn2137.html">http://developer.apple.com/mac/library/technotes/tn2005/tn2137.html</a></p>


	<p>I hope this is helpful to you and anybody else wanting to build exiv2 on the Mac platform.</p>


	<p>Robin</p></div>
  
  </div>
  <div class="message reply" id="message-533">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/235?r=533#message-533">RE: compile for OS X on PPC help</a>
    -
    Added by <a class="user active" href="/users/133">Robin Mills</a> <a title="21 May 2010 19:59" href="/projects/exiv2/activity?from=2010-05-21">over 11 years</a> ago
  </h4>
  <div class="wiki"><p>I have new information about this subject.  My recommendation remains to use MacPorts to build exiv2 on the Mac.</p>


	<p>Here are some new discoveries about building on Snow Leopard.  As part of my activity on the Phatch project (which uses exiv2 and pyexiv2), I wanted to build a universal (ppc,i386,x86_64) build of exiv2.</p>


	<p>To build any particular architecture, you can use a command such as this (bash shell, csh users will have to drive on the other side of the road)</p>


<pre>
arch=i386   # arch=ppc  or arch=x86_64
make clean
./configure CFLAGS="$arch" CXXFLAGS="$arch" CPPFLAGS="$arch" LDFLAGS="$arch" OBJCFLAGS="$arch" OBJCXXFLAGS="$arch" 
env         CFLAGS="$arch" CXXFLAGS="$arch" CPPFLAGS="$arch" LDFLAGS="$arch" OBJCFLAGS="$arch" OBJCXXFLAGS="$arch" make
</pre><br />This builds the shared library version for a single architecture (ppc, i386 or x86_64).  I discovered however that binaries created on Snow Leopard would not execute on Leopard and Tiger.  However, libraries build on Leopard are happy on Snow Leopard.  Conclusion: build on your oldest machine!

	<p>Building for a single architecture is fine, and of course the libraries can be combined to make a 'universal' binary with lipo.  A command such as:<br /><pre>
lipo -arch i386 libd.i386 -arch ppc libd.ppc -arch x86_64 libd.x86_64 -create -output libd
</pre><br />If you want to build the static library, here's the variant:<br /><pre>
arch=i386
make clean 
./configure --enable-static --disable-shared CFLAGS="$arch" CXXFLAGS="$arch" CPPFLAGS="$arch" LDFLAGS="$arch" OBJCFLAGS="$arch" OBJCXXFLAGS="$arch" 
env        CFLAGS="$arch" CXXFLAGS="$arch" CPPFLAGS="$arch" LDFLAGS="$arch" OBJCFLAGS="$arch" OBJCXXFLAGS="$arch" make
</pre><br />I built the ppc binaries on my elderly Powerbook/Tiger machine use this conventional:<br /><pre>
$ make clean ; make config ; ./configure ; make ;
# or
$ make clean ; make config ; ./configure --enable-static --disable-shared ; make
</pre> <br />So putting the whole thing together, I used this script on Leopard to create the universal (ppc,i386,x86_64) dynamic and shared libraries.</p>


	<p>Leopard builds the i386 and x86_64 binaries.   He copies the ppc from the powerbook.  The whole thing is combined using lipo.  In the end you have four universal files:<br />exiv2 - the program which uses the shared library<br />exiv2s - the program which is statically linked<br />libexiv2.a - the static library<br />libexiv2.6.dylib</p>


	<p>You shouldn't install exiv2s with that name!  It's documented (in the man page) as exiv2.  However for build purposes, I couldn't have two files with the same name.  Perhaps I should have build into different directories:  For example: dynamic/exiv2 and static/exiv2</p>


<pre>
#!/bin/bash

L=libexiv2.6.dylib
A=exiv2
LIB=./src/.libs/$L
APP=./src/.libs/$A

l=libexiv2.a
a=exiv2
lib=./src/.libs/$l
app=./src/$a

props() {
    ls    -alt  $*
    lipo  -info $*
    otool -L    $*
    echo ----------------------
}

build_shared() {
    make clean
    ./configure CFLAGS="$arch" CXXFLAGS="$arch" CPPFLAGS="$arch" LDFLAGS="$arch" OBJCFLAGS="$arch" OBJCXXFLAGS="$arch" 
    env         CFLAGS="$arch" CXXFLAGS="$arch" CPPFLAGS="$arch" LDFLAGS="$arch" OBJCFLAGS="$arch" OBJCXXFLAGS="$arch" make

    props $LIB
    props $APP
}

build_static() {
    make clean 
    ./configure --enable-static --disable-shared CFLAGS="$arch" CXXFLAGS="$arch" CPPFLAGS="$arch" LDFLAGS="$arch" OBJCFLAGS="$arch" OBJCXXFLAGS="$arch" 
    env        CFLAGS="$arch" CXXFLAGS="$arch" CPPFLAGS="$arch" LDFLAGS="$arch" OBJCFLAGS="$arch" OBJCXXFLAGS="$arch" make
    props $lib
    props $app
}

for arch in '-arch i386' '-arch x86_64' '-arch ppc' ;do
    if [ "$arch"   = "-arch i386" ]; then
        build_shared
        cp                 $LIB              libd.i386
        cp                 $APP              appd.i386
        build_static
        cp                 $lib              libs.i386
        cp                 $app              apps.i386
    elif [ "$arch" = "-arch x86_64" ]; then
        build_shared
        cp                 $LIB              libd.x86_64
        cp                 $APP              appd.x86_64
        build_static
        cp                 $lib              libs.x86_64
        cp                 $app              apps.x86_64
    else
        scp powerbook:$PWD/$LIB              libd.ppc
        scp powerbook:$PWD/$APP              appd.ppc

        scp powerbook:$PWD/$l                libs.ppc
        scp powerbook:$PWD/${a}s             apps.ppc
    fi
done

lipo -arch i386 libd.i386 -arch ppc libd.ppc -arch x86_64 libd.x86_64 -create -output $L
lipo -arch i386 appd.i386 -arch ppc appd.ppc -arch x86_64 appd.x86_64 -create -output $A
lipo -arch i386 libs.i386 -arch ppc libs.ppc -arch x86_64 libs.x86_64 -create -output $l
lipo -arch i386 apps.i386 -arch ppc apps.ppc -arch x86_64 apps.x86_64 -create -output ${a}s

props $L
props $A
props $l
props ${a}s
</pre><br />Observant readers will notice the cunning use of scp to copy from the powerbook.  This works on the assumption that the directory layout on the powerbook is parallel to the host.  Additionally, I have ssh/certificate stuff configured so that I don't need to enter passwords.

	<p>I hope others find this useful.</p></div>
  
  </div>
  <div class="message reply" id="message-537">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/235?r=537#message-537">RE: compile for OS X on PPC help</a>
    -
    Added by <a class="user active" href="/users/133">Robin Mills</a> <a title="24 May 2010 20:52" href="/projects/exiv2/activity?from=2010-05-24">over 11 years</a> ago
  </h4>
  <div class="wiki"><p>Built/universal binaries for MacOSX exiv2 0.19 are available from:<br /><a class="external" href="http://clanmills.com/files/exiv2-0-19.zip">http://clanmills.com/files/exiv2-0-19.zip</a></p>


	<p>If you want to put the file "on a diet" to remove one or two of the architectures, use 'lipo' to create new binaries.</p></div>
  
  </div>
</div>
<span class="pagination"><ul class="pages"></ul><span><span class="items">(1-3/3)</span> </span></span>



        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
