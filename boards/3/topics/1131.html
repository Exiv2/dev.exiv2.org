<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Directory offset out of bounds? - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="ePky8+QsK8b93AUZtc3bGUYPaTrVRxiBuQV4gcKChl6atJkcllbnxqi4GhUKGtcqeZ09QySkuTtEJegJgbthMQ==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
</head>
<body class="project-exiv2 has-main-menu controller-messages action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="messages" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="messages" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=boards" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=boards">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards selected" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="nosidebar">
    <div id="sidebar">
        
        
    </div>

    <div id="content">
        
        <p class="breadcrumb"><a href="/projects/exiv2/boards">Forums</a> » <a href="/projects/exiv2/boards/3">Forum</a> » </p>

<div class="contextual">
    
    
    
    
</div>

<h2>Directory offset out of bounds?</h2>

<div class="message">
<p><span class="author">Added by <a class="user active" href="/users/3326">Jeroen Hegeman</a> <a title="18 Mar 2012 04:12" href="/projects/exiv2/activity?from=2012-03-18">over 9 years</a> ago</span></p>
<div class="wiki">
<p>Dear Exiv2 experts,</p>


	<p>First of all: thank you for this wonderful set of tools! I'm still new to digital photography but am impressed by some of the open source tools that are available!</p>


	<p>But, I've got a question. Exiv2 complains about the jpegs coming off my Sony Alpha 580. Trying a simple 'exiv2 print file.jpg' tells me:<br /><code>Error: Offset of directory Sony1, entry 0x2001 is out of bounds: Offset = 0x002a805e; truncating the entry</code></p>


	<p>The actual information coming out appears to be fine, and for the corresponding RAW file I don't see any such complaint. If there is anyone who can tell me how to narrow this down further in order to find out what's wrong and where, that would be great.</p>


	<p>Best regards,<br />Jeroen</p>
</div>

</div>
<br />

<div id="replies">
<h3 class="comments icon icon-comments">Replies (4)</h3>
  <div class="message reply" id="message-1134">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1131?r=1134#message-1134">RE: Directory offset out of bounds?</a>
    -
    Added by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="18 Mar 2012 05:16" href="/projects/exiv2/activity?from=2012-03-18">over 9 years</a> ago
  </h4>
  <div class="wiki"><p>That's probably a shortcoming of Exiv2: It reads from JPEGs only what is officially the Exif segment and parses that. According to the Exif specification that is a self-contained block of information, however, some Makernotes contain pointers to locations outside of the Exif segment and the error that you encountered is generated if Exiv2 comes across such a pointer. It won't affect all the other information that Exiv2 reads from the Exif segment. It also doesn't happen in RAW files as these usually do not contain an Exif section and Exiv2 accesses the entire RAW image if necessary. It can however potentially mean that modifying the Exif data of such an image with Exiv2 will corrupt this part of the Makernote (the pointer may not be correct anymore after writing); that's the reason why the error is issued.</p>


	<p>Unless you're a programmer and willing to improve how Exiv2 works in the described case, there is nothing you need to do about this. If the error bothers you, you can suppress it with the -q flag.</p>


	<p>Andreas</p></div>
  
  </div>
  <div class="message reply" id="message-1135">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1131?r=1135#message-1135">RE: Directory offset out of bounds?</a>
    -
    Added by <a class="user active" href="/users/3326">Jeroen Hegeman</a> <a title="18 Mar 2012 06:38" href="/projects/exiv2/activity?from=2012-03-18">over 9 years</a> ago
  </h4>
  <div class="wiki"><p>Thanks Andreas,</p>


	<p>After a bit of reading about the Exif and TIFF specs, I'm beginning to understand. It looks like each camera producer has 'improved upon' the standards in various ways. Exiv2's treatment looks correct to me, and I'll just ignore this message for the moment.</p>


	<p>By the way: along the way I saw that exiftool has already managed to decoded this whole Sony1 data block. Now I'm curious, and I'll have a look at how complicate this stuff is.</p>


	<p>Best regards,<br />Jeroen</p></div>
  
  </div>
  <div class="message reply" id="message-1136">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1131?r=1136#message-1136">RE: Directory offset out of bounds?</a>
    -
    Added by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="18 Mar 2012 07:03" href="/projects/exiv2/activity?from=2012-03-18">over 9 years</a> ago
  </h4>
  <div class="wiki"><p>Hi Jeroen,</p>


	<p>Yes, Exiftool is amazingly powerful and complete. But Exiv2 also decodes the Sony1 IFD (look for Exif.Sony1.* tags in the output of exiv2 -pa), the error says only tag 0x2001 in this IFD is pointing outside of the Exif data block. It will be interesting to check this entry with Exiftool.</p>


	<p>Andreas</p></div>
  
  </div>
  <div class="message reply" id="message-1137">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1131?r=1137#message-1137">RE: Directory offset out of bounds?</a>
    -
    Added by <a class="user active" href="/users/3326">Jeroen Hegeman</a> <a title="18 Mar 2012 07:42" href="/projects/exiv2/activity?from=2012-03-18">over 9 years</a> ago
  </h4>
  <div class="wiki"><p>Hi Andreas,</p>


	<p>If I understand the exiftool documentation here: <a class="external" href="http://www.sno.phy.queensu.ca/~phil/exiftool/TagNames/Sony.html">http://www.sno.phy.queensu.ca/~phil/exiftool/TagNames/Sony.html</a> correctly, what lives at 0x2001 is the PreviewImage.</p>


	<p>Exiv2 reports this as:<br /><code>Exif.Sony1.PreviewImage                      Undefined   0</code></p>


	<p>Exiftool reports this as:<br /><code>Preview Image                   : (Binary data 240295 bytes, use -b option to extract)</code></p>


	<p>I can easily imagine that Sony moves around this data block depending on the camera/sensor model.</p>


	<p>Cheers,<br />Jeroen</p></div>
  
  </div>
</div>
<span class="pagination"><ul class="pages"></ul><span><span class="items">(1-4/4)</span> </span></span>



        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
