<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Windows libraries - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="fEFlAuSDQ6SMsyqE0hLRw4tP8DIf+5PC7e6HmdeI+/OeDM7tlvmPpNnXNYhtxd3wtN2kS+4YMngQzhcRlLEcnA==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
</head>
<body class="project-exiv2 has-main-menu controller-messages action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="messages" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="messages" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=boards" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=boards">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards selected" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="nosidebar">
    <div id="sidebar">
        
        
    </div>

    <div id="content">
        
        <p class="breadcrumb"><a href="/projects/exiv2/boards">Forums</a> » <a href="/projects/exiv2/boards/3">Forum</a> » </p>

<div class="contextual">
    
    
    
    
</div>

<h2>Windows libraries</h2>

<div class="message">
<p><span class="author">Added by <a class="user active" href="/users/3685">Mateusz P.</a> <a title="12 Nov 2012 05:17" href="/projects/exiv2/activity?from=2012-11-12">about 9 years</a> ago</span></p>
<div class="wiki">
<p>Hello everyone,</p>


	<p>I am working on Qt, multi-platform project and would like to use exiv2.<br />Under Mac OS I have managed to build and link everything properly. <br />Following manual and discussions I have analysed and used:<br /><a class="external" href="http://dev.exiv2.org/projects/exiv2/wiki/How_do_I_build_Exiv2_on_the_XYZ_platform">http://dev.exiv2.org/projects/exiv2/wiki/How_do_I_build_Exiv2_on_the_XYZ_platform</a><br />Now I started to do the job on Windows and encountered problems.<br />The <strong>goal</strong> is to link against exiv2 libs within the larger project.<br />The system settings are:<br />Windows 7 (64 bit)<br />QtCreator which uses precompiled Qt libraries (precompiled for larger project, however all simple examples are build-able and compile-able).<br />QMAKESPEC uses Visual Studio 2008; thus the flag is: -spec win32-msvc2008 in build steps<br />jom.exe is used for 'make' process.</p>


	<p>To obtain the <strong>goal</strong> I used two approaches build the Exiv2 library :<br />1) <a class="external" href="http://clanmills.com/exiv2/mingw.shtml">http://clanmills.com/exiv2/mingw.shtml</a><br />2) <a class="external" href="http://dev.exiv2.org/boards/3/topics/1259">http://dev.exiv2.org/boards/3/topics/1259</a></p>


	<p>For both I have checked simple Qt + Exiv2 test app and for both build methods the build fails on linking stage...<br />The return error from QtCreator:<br />error: LNK2019: unresolved external symbol "public: static class std::auto_ptr&lt;class Exiv2::Image&gt; __cdecl Exiv2::ImageFactory::open(class std::basic_string&lt;char,struct std::char_traits&lt;char&gt;,class std::allocator&lt;char&gt; > const &#38;)" (?open@ImageFactory@Exiv2@<code>SA?AV?$auto_ptr@VImage@Exiv2</code>@<code>std</code>@ABV?$basic_string@DU?$char_traits@D@std@<code>V?$allocator@D@2</code>@4@<code>Z) referenced in function "private: void __thiscall TestWindow::on_pushButton_clicked(void)" (?on_pushButton_clicked@TestWindow</code>@AAEXXZ)</p>


	<p>However when I used another QtSDK and MinGW as a QMAKESPEC then project links and runs flawlessly. <br />Therefore I suspect the problem caused by different usage of compilers - MinGW for building Exi2 and visual studio (win32-msvc2008) compiler for building test app. Since I can't change the QMAKESPEC flag I search for some workarround.</p>


	<p>The commercial licence would be used for the project so I search for the way to distribute the project properly.<br />1. The static library exiv2.lib for Windows (32 and 64) would be the easiest way.<br />2. Dynamic .dlls exiv2.dll and required dependancies are also a convienient solution.</p>


	<p>How can I produce any of them for this specific configuration ?<br />Should I build exiv2 Visual Studio projects so they do it for me? I tried a simple way to open .sln solution and 'build' but I just go a bunch of errors.</p>


	<p>I'm not sure how to proceed with this idea.<br />Any clues?</p>
</div>

</div>
<br />

<div id="replies">
<h3 class="comments icon icon-comments">Replies (11)</h3>
  <div class="message reply" id="message-1305">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1304?r=1305#message-1305">RE: Windows libraries</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="12 Nov 2012 07:52" href="/projects/exiv2/activity?from=2012-11-12">about 9 years</a> ago
  </h4>
  <div class="wiki"><p>Hi</p>


<blockquote>

	<p>However when I used another QtSDK and MinGW as a QMAKESPEC then project links and runs flawlessly. __</p>


</blockquote>

	<p>If it links and runs, what's your problem?</p>


	<p>You cannot mix compilers and libraries.  If you're building your application with MingW, you'll have to link libraries built with MinGW.  If you're building your application with Visual Studio (MSVC), you'll have to link libraries built with the same version of Visual Studio.  You have a choice of build environments for MSVC.  As you are building 32 and 64 bit libraries, I recommend you use msvc64.  I've never built 64 bit libraries on MinGW.</p>


	<p>The reason you cannot mix compilers is because the name mangling scheme is compiler specific and not defined by the C++ standard.</p>


	<p>You can inspect the entry points on a libraries using the utility dumpbin.exe (MSVC) and nm (GCC).  The utilities c+filt (for GCC) and udname (for MSVC) will convert the strange names to something human readable.  I'm on the Mac at the moment:</p>


<pre>
$ for i in $(nm -g src/.libs/libexiv2.a | grep " U " | grep -i exiv | grep ImageFactory | sed -e "s/ U //g" | sort -u) ; do echo $i ; done
__ZN5Exiv212ImageFactory4openEPKhl
__ZN5Exiv212ImageFactory6createEi
$ for i in $(nm -g src/.libs/libexiv2.a | grep " U " | grep -i exiv | grep ImageFactory | sed -e "s/ U //g" | sort -u) ; do c++filt $i ; done
Exiv2::ImageFactory::open(unsigned char const*, long)
Exiv2::ImageFactory::create(int)
$ 
</pre>

	<p>If you run something similar using dumpbin.exe and udname.exe on MSVC, you'll discover that the mangled names are different.   Those different names result in the linker failures you've reported.  The solution is to use the same compiler to build your application and the libraries.</p>


	<p>Robin</p></div>
  
  </div>
  <div class="message reply" id="message-1306">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1304?r=1306#message-1306">RE: Windows libraries</a>
    -
    Added by <a class="user active" href="/users/3685">Mateusz P.</a> <a title="12 Nov 2012 08:10" href="/projects/exiv2/activity?from=2012-11-12">about 9 years</a> ago
  </h4>
  <div class="wiki"><p>thank you for quick response, Robin.</p>


	<p>That is exactly what I supposed to, my mistake is that I used two different compilers. <br />I meant, I can build my example when I use the same, here MinGW compilers.</p>


	<p>However the goal application uses Visual Studio setting in QMAKESPEC, -spec win32-msvc2008.(Entire project uses Qt Creator).<br />The tutorials, discussions explains nicely how to build the library with MinGW.</p>


	<p>Forgive me my lack of exeprience and my dump-looking question.<br />How, on the other hand, can I build exiv2 with Visual Studio?<br />Is it so, that I shall open Visual Studio solution and proceed with ReadMe.txt file located in exiv-0.23/msvc64?<br />From what I understood this solution should build all the desired libraries static/dynamic, 32- and 64- bit mode.</p></div>
  
  </div>
  <div class="message reply" id="message-1307">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1304?r=1307#message-1307">RE: Windows libraries</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="12 Nov 2012 08:35" href="/projects/exiv2/activity?from=2012-11-12">about 9 years</a> ago
  </h4>
  <div class="wiki">You can build exiv2 with Visual Studio in two ways:
	<ol>
	<li>In &lt;exiv2dir&gt;/msvc you'll find projects to build 32 bit libraries</li>
		<li>In &lt;exiv2dir&gt;/msvc64 you'll find projects to build 32 and 64 bit libraries.</li>
	</ol>


	<p>Both msvc and msvc64 will build static and dynamic libraries in debug and release mode.</p>


	<p>You can use Qt with Visual Studio in two ways:</p>


	<ol>
	<li>With QtCreator and defining the tool chain to build with Visual Studio 2008</li>
		<li>With Visual Studio with the Visual Studio Qt Plugin installed into Visual Studio</li>
	</ol>


	<p>Qt offer SDKs and downloads which are platform specific because of the library name mangling/linking issue explained above.</p>


	<p>I like Visual Studio a lot.  However when working in Qt, I prefer to work in QtCreator because using the same set of tools everywhere is easier on my old brain!  It's your choice - 2 roads to success.</p>


	<p>Robin</p></div>
  
  </div>
  <div class="message reply" id="message-1308">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1304?r=1308#message-1308">RE: Windows libraries</a>
    -
    Added by <a class="user active" href="/users/3685">Mateusz P.</a> <a title="13 Nov 2012 00:00" href="/projects/exiv2/activity?from=2012-11-13">about 9 years</a> ago
  </h4>
  <div class="wiki"><p>Thank you, Robin!<br />Your answer clarify everything what was unclear to me. Your posts are very informative, not only this one :)</p></div>
  
  </div>
  <div class="message reply" id="message-1309">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1304?r=1309#message-1309">RE: Windows libraries</a>
    -
    Added by <a class="user active" href="/users/3685">Mateusz P.</a> <a title="13 Nov 2012 02:20" href="/projects/exiv2/activity?from=2012-11-13">about 9 years</a> ago
  </h4>
  <div class="wiki"><p>I gave a try to procedure explained in ReadMe.txt.<br />Unfortunately have problems with build...<br />I have created a C:/gnu directory and placed 3 locations:<br /> C:/gnu/exiv2-0.23<br /> C:/gnu/expat-2.1.0<br /> C:/gnu/zlib-1.2.7</p>


	<p>I open C:/gnu/exiv2-0.23/msvc64/exiv.sln. I use Visual Studio 2008 in that purpose, and perfoms as it is stated in this point of ReadMe.txt :</p>


	<p>1.3  Open exiv2\msvc64\exiv2.sln (here the conversion wizard does the job without errors )<br />     Projects are zlib, expat, xmpsdk, exiv2lib, exiv2<br />     Build/Batch build...  Select All, Build<br />     - 5 projects       (zlib, expat, xmpsdk, exiv2lib, exiv2)<br />     x 2 Platforms      (x64|Win32)<br />     x 4 Configurations (Debug|Release|DebugDLL|ReleaseDLL)
     = 5x2x4 = 40 builds.<br />The build process begins and the following errors occur:</p>


	<p>Error    1    fatal error C1083: Cannot open source file: '..\..\..\expat-2.0.1\lib\xmlparse.c': No such file or directory    c1    expat<br />Error    2    fatal error C1083: Cannot open source file: '..\..\..\expat-2.0.1\lib\xmltok_ns.c': No such file or directory    c1    expat<br />Error    3    fatal error C1083: Cannot open source file: '..\..\..\expat-2.0.1\lib\xmltok_impl.c': No such file or directory    c1    expat<br />Error    4    fatal error C1083: Cannot open source file: '..\..\..\expat-2.0.1\lib\xmltok.c': No such file or directory    c1    expat<br />Error    5    fatal error C1083: Cannot open source file: '..\..\..\expat-2.0.1\lib\xmlrole.c': No such file or directory    c1    expat<br />Error    6    fatal error LNK1181: cannot open input file '..\expat\Win32\Release\libexpat.lib'    exiv2    exiv2</p>


	<p>I do not know if the Windows build issues are discussed here in forum or should I ask you, Robin, via e-mail.<br />Perhaps I miss some kind of setting here. I've tried to set manually in project properties the Additional Include Directories where I changed the location of expat libraries to C:/gnu/expat-2.1.0/lib. Although it did not help, the errors returned were the same as above.<br />Any clue I would appreciate.</p></div>
  
  </div>
  <div class="message reply" id="message-1310">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1304?r=1310#message-1310">RE: Windows libraries</a>
    -
    Added by <a class="user active" href="/users/3685">Mateusz P.</a> <a title="13 Nov 2012 05:24" href="/projects/exiv2/activity?from=2012-11-13">about 9 years</a> ago
  </h4>
  <div class="wiki"><p>Never mind, <br />I have found the problem.<br />The expat version I downloaded was slightly different. Now it builds libraries correct.</p></div>
  
  </div>
  <div class="message reply" id="message-1311">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1304?r=1311#message-1311">RE: Windows libraries</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="13 Nov 2012 09:39" href="/projects/exiv2/activity?from=2012-11-13">about 9 years</a> ago
  </h4>
  <div class="wiki"><p>I think you have discovered the solution.  From the output you've provided, I believe you're using exiv2 0.23 which builds with expat-2.0.1 and zlib-1.2.3.</p>


	<p>Since May 2012, the trunk builds with expat-2.1.0 and zlib-1.2.7.  It is possible to build the trunk with 2.0.1 and 1.2.3 - there's a python script 'setbuild.py' to modify the Visual Studio projects appropriately.</p>


	<p>Robin</p></div>
  
  </div>
  <div class="message reply" id="message-1312">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1304?r=1312#message-1312">RE: Windows libraries</a>
    -
    Added by <a class="user active" href="/users/3685">Mateusz P.</a> <a title="15 Nov 2012 01:14" href="/projects/exiv2/activity?from=2012-11-15">about 9 years</a> ago
  </h4>
  <div class="wiki"><p>Yes, indeed I have build all configurations of exiv2 with Visual Studio 2008 properly.<br />I have the following locations:<br />     exiv2lib\Win32\{Debug|Release|DebugDLL|ReleaseDLL}     32 bit builds<br />     exiv2lib\x64\{Debug|Release|DebugDLL|ReleaseDLL}       64 bit builds</p>


	<p>Now on, as it is said in ReadMe I would use them for "foreign" project.<br />I work with QtCreator and Qt under Windows 7. The tool chain I need to use  to build is Visual Studio 2008 (QMAKESPEC, -spec win32-msvc2008).<br />I would like to be able to in both ways, statically and dynamically. I am mostly interested in the release mode. <br />Have managed to build dynamically with obtained library files.</p>


	<p>The issue I have with <strong>static</strong> linking. I wasn't able to successfully link with static libs. <br />In Release folder there is only one file - <strong>exiv2s.lib</strong> file so I copied libexpat.lib and zlib1.lib from Release directories of each one.<br />My qmake looks as follows:</p>
	<pre><code>win32 {</code></pre>
	<pre><code>INCLUDEPATH += ../exiv2/include<br />                 INCLUDEPATH += ../exiv2/include/exiv2<br />                 LIBS        += ../exiv2lib/Win32/Release/exiv2s.lib<br />                 LIBS        += ../exiv2lib/Win32/Release/libexpat.lib<br />                 LIBS        += ../exiv2lib/Win32/Release/zlib1.lib</code></pre>
	<pre><code>}</code></pre>


	<p>However I am getting an error during compilation:<br /><em>The system cannot find the path specified.<br />jom: ..\Testproject\Makefile.Release [release\Testproject.exe] Error 1<br />jom: ..\Testproject\Makefile [release] Error 2<br />08:35:29: The process "..\jom.exe" exited with code 2.<br />Error while building/deploying project Testproject (target: )</em></p>


	<p>I am clueless. I miss something definitely. Maybe I should ad  something to my qmake so my project can build properly?<br />I would appreciate your help here.</p></div>
  
  </div>
  <div class="message reply" id="message-1313">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1304?r=1313#message-1313">RE: Windows libraries</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="15 Nov 2012 08:24" href="/projects/exiv2/activity?from=2012-11-15">about 9 years</a> ago
  </h4>
  <div class="wiki"><p>Yes, you've discovered that our library file names are "decorated" with s and d for debug/static.  I personally don't like this convention because it makes the libraries build specific and you can't simply swap debug/release.  However an exiv2 commercial client requested this and we did this for him.</p>


	<p>I can't say immediately what's up.  I haven't following in project I did a couple of years ago with exiv2/mingw:</p>
	<pre><code>LIBS         += $$quote(C:/MinGW/msys/1.0/local/lib/libexiv2.dll.a)</code></pre>


	<p>Take a look at the QMake documentation and you'll see what $$quote does.  You'll also see that I didn't use relative paths ../exiv2lib because I don't understand MinGW.  So I manually copied the library to a fixed location and linked it directly.</p>


	<p>As you're using MSVC, the filenames to link are different and the ones you've chosen look about right.    You might not have to link libexpat.lib and zlib1.lib when you link the statically. However you will have to link them to use the DLL.  Windows links a "stub" library for every DLL.  Stubs know how to load and use the DLL at run time - so they are small.</p>


<pre>
C:\gnu.test&gt;grep zlib1\.lib$ theLot.txt
      171952 .\exiv2\msvc64\zlib\x64\release\zlib1.lib
       14900 .\exiv2\msvc64\zlib\x64\releasedll\zlib1.lib
       14900 .\exiv2\msvc64\exiv2lib\x64\ReleaseDLL\zlib1.lib
       15260 .\exiv2\msvc64\exiv2lib\Win32\ReleaseDLL\zlib1.lib
      120780 .\exiv2\msvc64\zlib\win32\release\zlib1.lib
       15260 .\exiv2\msvc64\zlib\win32\releasedll\zlib1.lib  &lt;--- He's in zlib\win32\releaseDLL not exiv2lib 

C:\gnu.test&gt;grep libexpat\.lib$ theLot.txt
       17238 .\exiv2\msvc64\exiv2lib\Win32\DebugDLL\libexpat.lib
       17238 .\exiv2\msvc64\exiv2lib\Win32\ReleaseDLL\libexpat.lib
       16928 .\exiv2\msvc64\exiv2lib\x64\DebugDLL\libexpat.lib
       16928 .\exiv2\msvc64\exiv2lib\x64\ReleaseDLL\libexpat.lib
      611854 .\exiv2\msvc64\expat\win32\debug\libexpat.lib
       17238 .\exiv2\msvc64\expat\win32\debugdll\libexpat.lib
      233134 .\exiv2\msvc64\expat\win32\release\libexpat.lib
       17238 .\exiv2\msvc64\expat\win32\releasedll\libexpat.lib
      569860 .\exiv2\msvc64\expat\x64\debug\libexpat.lib
       16928 .\exiv2\msvc64\expat\x64\debugdll\libexpat.lib
      394036 .\exiv2\msvc64\expat\x64\release\libexpat.lib 
       16928 .\exiv2\msvc64\expat\x64\releasedll\libexpat.lib
       17238 .\expat-2.0.1\win32\bin\debug\libexpat.lib
       17238 .\expat-2.0.1\win32\bin\release\libexpat.lib &lt;--- He's in expat-2.0.1\win32\bin\release NOT exiv2lib
</pre>

	<p>If you're still stuck, perhaps you can zip your project and send it to me.  Please remove all the .ncb .pdb .ilk .obj .exe .dll and other temporary files created by MSVC.  And don't send the exiv2 code!  Your zip file should be be 500k of less.  Email: <a class="email" href="mailto:robin@clanmills.com">robin@clanmills.com</a></p></div>
  
  </div>
  <div class="message reply" id="message-1314">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1304?r=1314#message-1314">RE: Windows libraries</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="15 Nov 2012 08:45" href="/projects/exiv2/activity?from=2012-11-15">about 9 years</a> ago
  </h4>
  <div class="wiki"><p>I have my library filenames a little mixed in the previous post For static/release/win32, you should be link.<br /><pre>
      120780 .\exiv2\msvc64\zlib\win32\release\zlib1.lib            &lt;&lt;--- He's in zlib NOT exiv2lib
     233134 .\exiv2\msvc64\expat\win32\release\libexpat.lib     &lt;&lt;--- He's in expat NOT exiv2lib
</pre><br />For dynamic/releasedll/win32, you should link:<br /><pre>
      120780 .\exiv2\msvc64\zlib\win32\releasedll\zlib1.lib            &lt;&lt;--- He's in zlib NOT exiv2lib
     233134 .\exiv2\msvc64\expat\win32\releasedll\libexpat.lib     &lt;&lt;--- He's in expat NOT exiv2lib
</pre></p></div>
  
  </div>
  <div class="message reply" id="message-1315">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1304?r=1315#message-1315">RE: Windows libraries</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="16 Nov 2012 10:23" href="/projects/exiv2/activity?from=2012-11-16">about 9 years</a> ago
  </h4>
  <div class="wiki"><p>Good News:</p>


	<p>I've been able to build exiv2.exe with the following project using the static binding.<br /><pre>
#-------------------------------------------------
#
# Project created by QtCreator 2012-11-15T16:07:07
#
#-------------------------------------------------

TARGET    = exiv2

QT       += core
QT       -= gui

# http://stackoverflow.com/questions/1011197/qt-static-linking-and-deployment
CONFIG   += static
CONFIG   += console
CONFIG   -= app_bundle

TEMPLATE  = app

win32 {
    # http://www.formortals.com/build-qt-static-small-microsoft-intel-gcc-compiler/
    QMAKE_CFLAGS_RELEASE =  /D "WIN32" /D "_NDEBUG" /D "_CONSOLE" /D "BUILD_GETOPT" /D "_MBCS" /FD /EHsc /MD /W3 /WX

    INCLUDEPATH  += $$quote(C:/gnu.test/exiv2/msvc64/include)
    LIBS         += $$quote(C:/gnu.test/exiv2/msvc64/exiv2lib/Win32/release/exiv2s.lib)
    LIBS         += $$quote(C:/gnu.test/exiv2/msvc64/xmpsdk/win32/release/xmpsdk.lib)
    LIBS         += $$quote(C:/gnu.test/exiv2/msvc64/expat/Win32/Release/libexpat.lib)
    LIBS         += $$quote(C:/gnu.test/exiv2/msvc64/zlib/Win32/Release/zlib1.lib)

    #QMAKE_LFLAGS_RELEASE += /NODEFAULTLIB:msvcprt.lib
    #QMAKE_LFLAGS_RELEASE += /NODEFAULTLIB:msvcrt.lib
    #QMAKE_LFLAGS_RELEASE += /SUBSYSTEM:CONSOLE /OPT:REF /OPT:ICF /MACHINE:X86
    #LIBS         += libcmt.lib
}

SOURCES += $$quote(C:/gnu.test/exiv2/src/exiv2.cpp) \
$$quote(C:/gnu.test/exiv2/src/actions.cpp)      \
$$quote(C:/gnu.test/exiv2/src/getopt_win32.c)   \
$$quote(C:/gnu.test/exiv2/src/localtime.c)      \
$$quote(C:/gnu.test/exiv2/src/utils.cpp)

# That's all Folks!
##
</pre></p>


	<p>When you run exiv2 -v -V (verbose version) it reports:<br /><pre>
... bla bla bla ...

exiv2=0.23.0
platform=windows
compiler=MSVC
bits=4
dll=0
debug=0
version=9.00
date=Nov 16 2012
time=09:32:42
executable=C:\Robin\Projects\simple-build-desktop-Qt_4_8_3__vs-2008__Release\release\exiv2.exe
library=C:\Windows\SysWOW64\ntdll.dll
library=C:\Windows\syswow64\kernel32.dll
library=C:\Windows\syswow64\KERNELBASE.dll
library=C:\Windows\WinSxS\x86_microsoft.vc90.crt_1fc8b3b9a1e18e3b_9.0.30729.6161_none_50934f2ebcb7eb57\MSVCP90.dll
library=C:\Windows\WinSxS\x86_microsoft.vc90.crt_1fc8b3b9a1e18e3b_9.0.30729.6161_none_50934f2ebcb7eb57\MSVCR90.dll
library=C:\Windows\syswow64\PSAPI.DLL

C:\Robin\Projects\simple-build-desktop-Qt_4_8_3__vs-2008__Release\release&gt;
</pre></p>


	<p>I had to modify the exiv2/msvc64 build environment to use /MD (use DLL run-time c library) on projects zlib, expat, xmpsdk and exiv2lib.</p>


	<p>I'll update ReadMe.txt about this over the weekend.  I'll also review and update the build instructions appropriately on this page:</p>


	<p><a class="external" href="http://dev.exiv2.org/projects/exiv2/wiki/How_do_I_build_Exiv2_on_the_XYZ_platform">http://dev.exiv2.org/projects/exiv2/wiki/How_do_I_build_Exiv2_on_the_XYZ_platform</a></p></div>
  
  </div>
</div>
<span class="pagination"><ul class="pages"></ul><span><span class="items">(1-11/11)</span> </span></span>



        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
