<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Building a project under QT5 with exvi2 - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="lxpcmyubXXH84V9eDI0TrW9xvA0Bb1OMtQZskk/usrJ1V/d0WeGRcamFQFKzWh+eUOPodPCM8jZIJvwaDNdV3Q==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
</head>
<body class="project-exiv2 has-main-menu controller-messages action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="messages" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="messages" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=boards" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=boards">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards selected" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="nosidebar">
    <div id="sidebar">
        
        
    </div>

    <div id="content">
        
        <p class="breadcrumb"><a href="/projects/exiv2/boards">Forums</a> » <a href="/projects/exiv2/boards/3">Forum</a> » </p>

<div class="contextual">
    
    
    
    
</div>

<h2>Building a project under QT5 with exvi2</h2>

<div class="message">
<p><span class="author">Added by <a class="user active" href="/users/3711">Vincent VALLEZ</a> <a title="30 Dec 2012 10:33" href="/projects/exiv2/activity?from=2012-12-30">almost 9 years</a> ago</span></p>
<div class="wiki">
<p>Hello everybody,</p>


	<p>I'm actually trying to make a project under QT5 with Qtcreator. The Qt5 actually use msvc to work. Not mingw.<br />So I build the exiv2 library under VS2010.<br />It's ok the process was successfull.</p>


	<p>So back into Qt and start to code/compile.<br />When I try to use exiv2 the code did'nt want to compile.</p>


	<p>I add this into my pro file : <br /><pre>
#-------------------------------------------------
#
# Project created by QtCreator 2012-12-21T18:24:54
#
#-------------------------------------------------

QT       += core gui

greaterThan(QT_MAJOR_VERSION, 4): QT += widgets

TARGET = Bouchon
TEMPLATE = app

SOURCES += main.cpp\
mainwindow.cpp

HEADERS  += mainwindow.h

FORMS    += mainwindow.ui

win32|win32-msvc* {
INCLUDEPATH  += "I:\exiv2\Build\exiv2-0.23\msvc64\include\" 
# LIBS         += $$quote(C:/MinGW/msys/1.0/local/lib/libexiv2.dll.a)
}

unix {
INCLUDEPATH  += /usr/local/include
LIBS         += -L/usr/local/lib -lexiv2
}

macx {
INCLUDEPATH  += /usr/local/include
LIBS         += -L/usr/local/lib -lexiv2
}
</pre></p>


	<p>But the code still won't compile. There is the error I get :</p>


<blockquote>

	<p>I:\Projet Qt\Bouchon\mainwindow.cpp:6: erreur : C1083: Impossible d'ouvrir le fichier includeÿ: 'exiv2/exiv2.hpp'ÿ: No such file or directory</p>


</blockquote>

	<p>In the mainwindow.cpp at line 6 we found that include :</p>


<blockquote>

	<p>#include &lt;exiv2/exiv2.hpp&gt;</p>


</blockquote>

	<p>The architecture of my environment is : <br /> - I:\exiv2\Build\exiv2-0.23 : the build of the library<br /> - I:\Projet Qt\Bouchon : my project<br /> - C:\Qt\Qt5.0.0 : my Qt5 installation<br /> - and VC2010 is installed by default.</p>


	<p>I think that my problem is relative to the way I link my exiv2 library with the project but I'm a little lost ...</p>


	<p>I try to do the same thing on Mac and everything was fine.</p>


	<p>Thank you in advance for your help.</p>
</div>

</div>
<br />

<div id="replies">
<h3 class="comments icon icon-comments">Replies (6)</h3>
  <div class="message reply" id="message-1342">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1341?r=1342#message-1342">RE: Building a project under QT5 with exvi2</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="30 Dec 2012 11:49" href="/projects/exiv2/activity?from=2012-12-30">almost 9 years</a> ago
  </h4>
  <div class="wiki"><p>I don't believe I have ever worked the combination of exiv2/Qt/2010.  However I believe it will work OK.  I've used the MinGW build with QtCreator and that works fine.  You can't mix MinGW and DevStudio.  You have to do everything with MinGW or DevStudio.</p>


	<p>You may have linking issues, however at this moment you are unable to compile your application.  You're not setting the include search path correctly - although the includepath += I:\etc looks OK.  Here are some suggestions in addition to coffee, a good night's sleep, a walk in the park etc:</p>


	<p>1 "Double up" the back slashes<br />INCLUDEPATH  += "I:\\exiv2\\Build\\exiv2-0.23\\msvc64\\include\\"</p>


	<p>2. Try forward slash<br />INCLUDEPATH  += "I:/exiv2/Build/exiv2-0.23/msvc64/include/" <br />or even<br />INCLUDEPATH  += $$quote("I:/exiv2/Build/exiv2-0.23/msvc64/include/")</p>


	<p>3.  Avoid the slashes completely.  Use susbt (or junction) to define a drive letter for the include path:<br />INCLUDEPATH += X:\</p>


	<p>4.  In DevStudio, there's a compiler setting to "Show Include Paths".  When you have that enabled, the compiler will show you where he's sniffing for include files.  He'll help you a lot.</p>


	<p>5.  As a last resort, you can change the global search path in DevStudio. <br /><img src="http://clanmills.com/files/DevStudio2010Paths.png" alt="" /></p></div>
  
  </div>
  <div class="message reply" id="message-1343">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1341?r=1343#message-1343">RE: Building a project under QT5 with exvi2</a>
    -
    Added by <a class="user active" href="/users/3711">Vincent VALLEZ</a> <a title="30 Dec 2012 17:58" href="/projects/exiv2/activity?from=2012-12-30">almost 9 years</a> ago
  </h4>
  <div class="wiki"><p>Finally I fix it !</p>


	<p>It was simple like that : <br /><pre>
win32|win32-msvc* {
    INCLUDEPATH  += I:\exiv2\Build\exiv2-0.23\msvc64\include
    LIBS         += -LI:\exiv2\Build\exiv2-0.23\msvc64\exiv2lib\Win32\ReleaseDLL -lexiv2
    LIBS         += -LI:\exiv2\Build\exiv2-0.23\msvc64\exiv2lib\Win32\ReleaseDLL -llibexpat
    LIBS         += -LI:\exiv2\Build\exiv2-0.23\msvc64\exiv2lib\Win32\ReleaseDLL -lzlib1
}
</pre></p>


	<p>I think that the win32-msvc* is very important as my Qt version work with msvc.<br />Another thing that is important, for every modification I made on the configuration I must clean the solution.</p>


	<p>A thing I will do later is to make separate configuration for debug and release.</p>


	<p>No I've got another problem, when I open a file I get an error.<br /><pre>
        QString fic = "E:\\Annonces\\P1000\\IMG_0847.JPG";
        Exiv2::Image::AutoPtr image = Exiv2::ImageFactory::open(fic.toStdString());
</pre></p>


	<p>Return me an exception : <br /><pre>
Caught Exiv2 exception ': Failed to open the data source: Invalid argument (errno = 22)'
</pre></p>


	<p>I try with an std::string instead of a QString in case of something in the QString can be annoying. But the result is the same.<br />I guess that is due to the fact I'm using the release library instead of the debug one.</p>


	<p>What do you think about it ?</p>


	<p>Also thank you very much for your response.</p></div>
  
  </div>
  <div class="message reply" id="message-1344">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1341?r=1344#message-1344">RE: Building a project under QT5 with exvi2</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="30 Dec 2012 20:46" href="/projects/exiv2/activity?from=2012-12-30">almost 9 years</a> ago
  </h4>
  <div class="wiki"><p>Congratulations.  Build issues always involve messing about until you discover something you didn't know!  You don't need to define -LI:\exiv2\......ReleaseDLL three times - however it's harmless.</p>


	<p>Your file not opening isn't a release/debug issue.  It's something more subtle.  Can you open with exiv2.exe -pt e:\annonces.....  ?</p>


	<p>Try just passing the "string" directly and worry about QString std::string stuff later.</p>


	<p>Exiv2::Image::AutoPtr image = Exiv2::ImageFactory::open("e:\\annonces....JPG");</p>


	<p>If it open directly with "e:......", try using fic.toStdString().c_str()</p>


	<p>I think it's a good idea to link the debug version of exiv2, then you can step the code in the debugger and you'll get more information about what's going on.  Another suggestion is to use some sample code (eg samples/exifprint.cpp) as your test app (paste the code into mainwindow.cpp and modify it to fit)  You can debug the build environment without having to think about C++ code.  Once the build is settled and stable, you can start on the application you really want to develop.</p>


	<p>Good Luck.  Best Wishes for 2013.</p>


	<p>Robin</p></div>
  
  </div>
  <div class="message reply" id="message-1345">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1341?r=1345#message-1345">RE: Building a project under QT5 with exvi2</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="30 Dec 2012 21:57" href="/projects/exiv2/activity?from=2012-12-30">almost 9 years</a> ago
  </h4>
  <div class="wiki"><p>I've just had another thought about debugging the build environment.  I see you are using the DLL build of exiv2.  You'll be aware that the DLL has to be on the path OR in the same directory as the .exe.  The msvc64 build environment takes care of this for the sample applications.  However you're going to have to handle this with QMake - probably as a post-build step script of some kind.</p>


	<p>All of this is very dull and boring.  However taking the time to get the build/link/copy/test constructed correctly is time well spend as your project moves forward.  So do it as your last chore of 2012, or first of 2013.  Take the 2-4 hour hit today.  It'll hurt a lot more in a few weeks.</p>


	<p>The spirit of open-source is to share.  You get Andreas' beautiful C++ code without charge, my support and build skills for free.  We ask you to contribute discoveries to help other users.  After all, you're quite possibly the first person to ever use QtCreator/MSVC2010/exiv2.</p>


	<p>It would be very helpful for you to report discoveries back to this thread and I will add a link to the thread from this page:  <a class="external" href="http://dev.exiv2.org/projects/exiv2/wiki/How_do_I_build_Exiv2_on_the_XYZ_platform">http://dev.exiv2.org/projects/exiv2/wiki/How_do_I_build_Exiv2_on_the_XYZ_platform</a></p></div>
  
  </div>
  <div class="message reply" id="message-1346">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1341?r=1346#message-1346">RE: Building a project under QT5 with exvi2</a>
    -
    Added by <a class="user active" href="/users/3711">Vincent VALLEZ</a> <a title="31 Dec 2012 05:35" href="/projects/exiv2/activity?from=2012-12-31">almost 9 years</a> ago
  </h4>
  <div class="wiki"><p>After doing some tests, my problem when I open a JPEG, was due to the debug/release environment.<br />I don't know why, but after declaring explicitly in the pro file the lib to use in release or debug configuration, everything works like a charm.</p>


	<p>So there is the pro file now : <br />win32|win32-msvc* {<br />    INCLUDEPATH  += I:\exiv2\Build\exiv2-0.23\msvc64\include<br />    <abbr title="debug, debug|release">CONFIG</abbr> {<br />        LIBS         += -LI:\exiv2\Build\exiv2-0.23\msvc64\exiv2lib\Win32\DebugDLL -lexiv2d<br />    }<br />    <abbr title="release, debug|release">CONFIG</abbr> {<br />        LIBS         += -LI:\exiv2\Build\exiv2-0.23\msvc64\exiv2lib\Win32\ReleaseDLL -lexiv2<br />    }<br />}</p>


	<p>Previously I was using the ReleaseDLL on my debug configuration in QtCreator.</p>


	<p>About the DLL file, I agree with you, I need to found a way to bring them with the exe.<br />In QtCreator when I run the project it's ok.<br />But If I run the exe myself, it complains about missing exiv2.dll.<br />And finally If I provide the exiv2.dll and dependencies it complains about Qt DLL ... So I think there is something in QtCreator that can help me to deploy the solution. Something like an assistant for example.<br />I will do some research about it.</p>


	<p>If you want, I can write a tutorial that describe how I use QtCreator/MSVC2010/exiv2.<br />I'm totally agree with you about sharing my knowledge.</p>


	<p>Best Wishes for 2013 too.</p>


	<p>Vincent</p></div>
  
  </div>
  <div class="message reply" id="message-1350">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/1341?r=1350#message-1350">RE: Building a project under QT5 with exvi2</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="31 Dec 2012 22:07" href="/projects/exiv2/activity?from=2012-12-31">almost 9 years</a> ago
  </h4>
  <div class="wiki"><p>Vincent</p>


	<p>I am surprised that the file open issue was debug/release conflict.  As I said, build engineering is mostly discovering things you don't know!</p>


	<p>Thanks for your offer to do a tutorial about your experience here.  That'll be great.  I think you're aware of my Qt help page:  <a class="external" href="http://clanmills.com/exiv2/qt.shtml">http://clanmills.com/exiv2/qt.shtml</a></p>


	<p>We can extend my page, or write a new page "Using exiv2 with QtCreator &#38; the DevStudio2010 tool chain".  I think you can publish it on the exiv2.org Wiki (if not, I can submit it on your behalf).  I put my pages on clanmills.com because it was convenient.  One day I should move them to the exiv2 wiki.</p>


	<p>I found this page about postbuild .bat files.  I think this'll help with copying the DLLs.  <a class="external" href="http://www.qtcentre.org/threads/26691-QtCreator-PostBuild-step-solution">http://www.qtcentre.org/threads/26691-QtCreator-PostBuild-step-solution</a></p>


	<p>Anyway, good luck with your project and for 2013.</p>


	<p><img src="http://clanmills.com/files/Holidays2012.png" alt="" /></p></div>
  
  </div>
</div>
<span class="pagination"><ul class="pages"></ul><span><span class="items">(1-6/6)</span> </span></span>



        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
