<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Copy specific tags from JPG to JPG - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="tcUVW2BBkPpZRIFlKzvref09/4hXQxoAclG496YAqmBXiL60Ejtc+gwgnmmU7OdKwq+r8aagu7qPcSh/5TlNDw==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
</head>
<body class="project-exiv2 has-main-menu controller-messages action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="messages" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="messages" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=boards" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=boards">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards selected" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="nosidebar">
    <div id="sidebar">
        
        
    </div>

    <div id="content">
        
        <p class="breadcrumb"><a href="/projects/exiv2/boards">Forums</a> » <a href="/projects/exiv2/boards/3">Forum</a> » </p>

<div class="contextual">
    
    
    
    
</div>

<h2>Copy specific tags from JPG to JPG</h2>

<div class="message">
<p><span class="author">Added by <a class="user active" href="/users/4560">Nick Henshaw</a> <a title="22 Nov 2015 14:47" href="/projects/exiv2/activity?from=2015-11-22">almost 6 years</a> ago</span></p>
<div class="wiki">
<p>Hi</p>


	<p>I'm a new user of exiv2, and new to this forum.  I'm using exiv2 on Windows from the command line.</p>


	<p>Is there a straight forward way copying a specified set of tags from one JPG to another? Or this could be via a "sidecar" file.  But I only want specified tags.  I've (perhaps inappropriately) tried using -K parameters when extracting but they seem to be ignored. Perhaps they only work for reporting, not for extracting.</p>


	<p>The alternative, reporting then inserting, seems long winded, especially when the values have to be reformatted (e.g. Exif.GPSInfo.GPSLatitude has a different format when reporting from when inserting).</p>


	<p>Any help gratefully received.</p>


	<p>Nick</p>
</div>

</div>
<br />

<div id="replies">
<h3 class="comments icon icon-comments">Replies (7)</h3>
  <div class="message reply" id="message-2330">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/2329?r=2330#message-2330">RE: Copy specific tags from JPG to JPG</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="22 Nov 2015 20:02" href="/projects/exiv2/activity?from=2015-11-22">almost 6 years</a> ago
  </h4>
  <div class="wiki"><p>Nick</p>


	<p>You can copy all the metadata from one file to another in the application exiv2.exe, or the sample application metacopy.exe  The exiv2.exe -K option applies to reporting Keys.   And --grep/-g is a pattern of keys.</p>


	<p>You can of course use "the dentist's method" (you pull them out one at a time).  Very long winded and, as you're discovered, the output when reporting a key/value may require a little modification before being piped into another command.</p>


	<p>Exiv2 outputs values in two forms "vanilla" and "translated".  'Vanilla values' are in effect the data in the file.  'Translated' means that have been made "more human understandable.  You can see the different when you print GPS data.  'Vanilla' reveals raw values, and 'translated' massages them into degrees and seconds. Here's an image which I took at Stonehenge in July:<pre>531 rmills@rmillsmbp:~/gnu/exiv2/trunk $ exiv2 -pa --grep GPSInfo http://dev.exiv2.org/attachments/download/805/DSC_7154.jpg
Exif.GPSInfo.GPSVersionID                    Byte        4  2.3.0.0
Exif.GPSInfo.GPSLatitudeRef                  Ascii       2  North
Exif.GPSInfo.GPSLatitude                     Rational    3  51deg 10.69690' 
Exif.GPSInfo.GPSLongitudeRef                 Ascii       2  West
Exif.GPSInfo.GPSLongitude                    Rational    3  1deg 49.59840' 
Exif.GPSInfo.GPSAltitudeRef                  Byte        1  Above sea level
Exif.GPSInfo.GPSAltitude                     Rational    1  97 m
Exif.GPSInfo.GPSTimeStamp                    Rational    3  14:38:55.9
Exif.GPSInfo.GPSSatellites                   Ascii       3  09
Exif.GPSInfo.GPSMapDatum                     Ascii      17  WGS-84          
Exif.GPSInfo.GPSDateStamp                    Ascii      11  2015:07:16
532 rmills@rmillsmbp:~/gnu/exiv2/trunk $ </pre>If you use the "P = Fine-grained output control", you can skip the type/count information in the output:<pre>532 rmills@rmillsmbp:~/gnu/exiv2/trunk $ exiv2 -Pkv --grep GPSInfo http://dev.exiv2.org/attachments/download/805/DSC_7154.jpg
Exif.GPSInfo.GPSVersionID                     2 3 0 0
Exif.GPSInfo.GPSLatitudeRef                   N
Exif.GPSInfo.GPSLatitude                      51/1 106969/10000 0/1
Exif.GPSInfo.GPSLongitudeRef                  W
Exif.GPSInfo.GPSLongitude                     1/1 495984/10000 0/1
Exif.GPSInfo.GPSAltitudeRef                   0
Exif.GPSInfo.GPSAltitude                      97/1
Exif.GPSInfo.GPSTimeStamp                     14/1 38/1 5588/100
Exif.GPSInfo.GPSSatellites                    09
Exif.GPSInfo.GPSMapDatum                      WGS-84          
Exif.GPSInfo.GPSDateStamp                     2015:07:16
533 rmills@rmillsmbp:~/gnu/exiv2/trunk $</pre>With a little sed (or python or perl or dos) magic,  copy the GPS into a .cmd files which you can apply to another image.<pre>576 rmills@rmillsmbp:~/gnu/exiv2/trunk $ exiv2 -Pkv --grep GPSL http://dev.exiv2.org/attachments/download/805/DSC_7154.jpg | sed -E -e "s/^/set /" 
set Exif.GPSInfo.GPSLatitudeRef                   N
set Exif.GPSInfo.GPSLatitude                      51/1 106969/10000 0/1
set Exif.GPSInfo.GPSLongitudeRef                  W
set Exif.GPSInfo.GPSLongitude                     1/1 495984/10000 0/1
577 rmills@rmillsmbp:~/gnu/exiv2/trunk $ exiv2 -Pkv --grep GPSL http://dev.exiv2.org/attachments/download/805/DSC_7154.jpg | sed -E -e "s/^/set /" &gt; foo.txt</pre>So let's get a jpg with no metadata:<pre>577 580 rmills@rmillsmbp:~/gnu/exiv2/trunk $ curl http://clanmills.com/robin.jpg &gt; robin.jpg
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  8779  100  8779    0     0  10105      0 --:--:-- --:--:-- --:--:-- 25082
581 rmills@rmillsmbp:~/gnu/exiv2/trunk $ exiv2 -pa robin.jpg
582 rmills@rmillsmbp:~/gnu/exiv2/trunk $  </pre>Extract the metadata from Stonehenge into a cmd file<pre>583 rmills@rmillsmbp:~/gnu/exiv2/trunk $ exiv2 -Pkv --grep GPSL http://dev.exiv2.org/attachments/download/805/DSC_7154.jpg | sed -E -e "s/^/set /" &gt; foo.cmd</pre>And apply the command file to robin.jpg<pre>584 rmills@rmillsmbp:~/gnu/exiv2/trunk $ exiv2 -mfoo.cmd robin.jpg</pre>And robin.jpg is now at Stonehenge<pre>585 rmills@rmillsmbp:~/gnu/exiv2/trunk $ exiv2 -pa robin.jpg
Exif.Image.GPSTag                            Long        1  26
Exif.GPSInfo.GPSLatitudeRef                  Ascii       2  North
Exif.GPSInfo.GPSLatitude                     Rational    3  51deg 10.69690' 
Exif.GPSInfo.GPSLongitudeRef                 Ascii       2  West
Exif.GPSInfo.GPSLongitude                    Rational    3  1deg 49.59840' 
586 rmills@rmillsmbp:~/gnu/exiv2/trunk $ </pre></p></div>
  
  </div>
  <div class="message reply" id="message-2331">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/2329?r=2331#message-2331">RE: Copy specific tags from JPG to JPG</a>
    -
    Added by <a class="user active" href="/users/4560">Nick Henshaw</a> <a title="22 Nov 2015 23:30" href="/projects/exiv2/activity?from=2015-11-22">almost 6 years</a> ago
  </h4>
  <div class="wiki"><p>Robin</p>


	<p>This is extremely useful.  You have hit the nail on its head!</p>


	<p>I had not come across the parameters you describe, (nor have I ever used sed, but am happy to learn).  It is amazing what can be achieved with -Pkv and sed -E -e "s/^/set /" !!</p>


	<p>Thanks again for your very helpful response.</p>


	<p>Nick</p></div>
  
  </div>
  <div class="message reply" id="message-2332">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/2329?r=2332#message-2332">RE: Copy specific tags from JPG to JPG</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="23 Nov 2015 15:40" href="/projects/exiv2/activity?from=2015-11-23">almost 6 years</a> ago
  </h4>
  <div class="wiki"><p>Nick</p>


	<p>This is a rather interesting idea.  I've raised a Feature request <a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Enable piping of selective copy of metadata between images  (Closed)" href="/issues/1137">#1137</a> for which I've submitted the code <a class="changeset" title="#1137.  Implemented." href="/projects/exiv2/repository/exiv2/revisions/4044">r4044</a>.  I've added the option -PV as an additional fine grained output option to mean: "value" <em><strong>and</strong></em> insert the word 'set ' at the beginning of the command line.  So:  <pre>$ exiv2 -PkV --grep GPSL http://dev.exiv2.org/attachments/download/805/DSC_7154.jpg 
set Exif.GPSInfo.GPSLatitudeRef                   N
set Exif.GPSInfo.GPSLatitude                      51/1 106969/10000 0/1
set Exif.GPSInfo.GPSLongitudeRef                  W
set Exif.GPSInfo.GPSLongitude                     1/1 495984/10000 0/1</pre>So, you don't have to have 'sed' to insert the word 'set ' at the start of every line.</p>


	<p>I've also modified the option -mfilename to enable:<pre>-m-</pre>to be standard input.  So it's now possible to pipe the metadata from one image to another (while using the -K and -g filters if you wish).<pre>$ exiv2 -PkV --grep GPSL http://dev.exiv2.org/attachments/download/805/DSC_7154.jpg | exiv2 -m- robin.jpg
$ </pre>Examining the metadata shows:<pre>$ exiv2 -pa robin.jpg
Exif.Image.GPSTag                            Long        1  26
Exif.GPSInfo.GPSLatitudeRef                  Ascii       2  North
Exif.GPSInfo.GPSLatitude                     Rational    3  51deg 10.69690' 
Exif.GPSInfo.GPSLongitudeRef                 Ascii       2  West
Exif.GPSInfo.GPSLongitude                    Rational    3  1deg 49.59840' 
$</pre>I always have sed on my command-line in Windows, because I install Cygwin and add c:\cygwin64\bin to my Windows path.  There's quite a lengthy discussion about 'sed for Windows' here:  <a class="external" href="http://stackoverflow.com/questions/127318/is-there-any-sed-like-utility-for-cmd-exe">http://stackoverflow.com/questions/127318/is-there-any-sed-like-utility-for-cmd-exe</a></p></div>
  
  </div>
  <div class="message reply" id="message-2333">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/2329?r=2333#message-2333">RE: Copy specific tags from JPG to JPG</a>
    -
    Added by <a class="user active" href="/users/4560">Nick Henshaw</a> <a title="23 Nov 2015 19:15" href="/projects/exiv2/activity?from=2015-11-23">almost 6 years</a> ago
  </h4>
  <div class="wiki"><p>Hi Robin</p>


	<p>Yes the two additional features that you describe would make it a very easy seamless process to move tags around with no need for intermediate files.  I would be a happy user of them!</p>


	<p>I am not familiar with the Change Request / Development / Release process for exiv2. Do I just track the chnage using your hyperlinked tag <a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Enable piping of selective copy of metadata between images  (Closed)" href="/issues/1137">#1137</a>?  Is it likely that these features will be generally available in a new version some time soon?</p>


	<p>If not I will get hold of sed for Windows for the moment.</p>


	<p>Thanks again for your help.</p>


	<p>Nick</p></div>
  
  </div>
  <div class="message reply" id="message-2334">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/2329?r=2334#message-2334">RE: Copy specific tags from JPG to JPG</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="23 Nov 2015 20:00" href="/projects/exiv2/activity?from=2015-11-23">almost 6 years</a> ago
  </h4>
  <div class="wiki"><p>I've put the changes into the code and they are on the trunk.  You have to build the trunk to get them.  Our next release will be v0.26 and it should be available about Easter next year.</p>


	<p>One of the features of v0.26 is to enable users request a build (of trunk, or selected branches) and it'll be done for you by the build server.  I'm still working on this.</p>


	<p>I've been using cygwin for about 10 years.  It's very solid.  In that article on stackoverload, somebody mentioned a standalone sed.exe which they said was very good.</p></div>
  
  </div>
  <div class="message reply" id="message-2336">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/2329?r=2336#message-2336">RE: Copy specific tags from JPG to JPG</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="23 Dec 2015 21:21" href="/projects/exiv2/activity?from=2015-12-23">almost 6 years</a> ago
  </h4>
  <div class="wiki"><p>Nick</p>


	<p>You can now download builds of Exiv2.  There is a daily (weekly and monthly) build:  <a class="external" href="http://exiv2.dyndns.org:8080/userContent/builds/">http://exiv2.dyndns.org:8080/userContent/builds/</a></p>


	<p>Currently, I'm building Cygwin/MacOS-X/Linux/msvc (2005/8/10/12/13/15).  You can pull down the build of interest and follow the instructions in the bundle's ReadMe.txt.</p>


	<p>I intend to add MinGW (perhaps next week).</p>


	<p>Happy Holidays.  Best Wishes for 2016.</p>


	<p><img src="http://exiv2.org/Exiv2Logo.png" alt="" /></p></div>
  
  </div>
  <div class="message reply" id="message-2339">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/2329?r=2339#message-2339">RE: Copy specific tags from JPG to JPG</a>
    -
    Added by <a class="user active" href="/users/4560">Nick Henshaw</a> <a title="04 Jan 2016 19:45" href="/projects/exiv2/activity?from=2016-01-04">almost 6 years</a> ago
  </h4>
  <div class="wiki"><p>Robin</p>


	<p>Thanks for this.  I'll set aside some time and take a look.</p>


	<p>Happy New Year</p>


	<p>Nick</p></div>
  
  </div>
</div>
<span class="pagination"><ul class="pages"></ul><span><span class="items">(1-7/7)</span> </span></span>



        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
