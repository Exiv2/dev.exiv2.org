<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Matching error to file for redirect output on the command line? - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="o6Sr1Rzi6CXu+PMvlJh+elrrdie52QKF5evaBET3bhJB6QA6bpgkJbuc7CMrT3JJZXkiXkg6oz8Yy0qMB86JfQ==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
</head>
<body class="project-exiv2 has-main-menu controller-messages action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="messages" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="messages" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=boards" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=boards">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards selected" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="nosidebar">
    <div id="sidebar">
        
        
    </div>

    <div id="content">
        
        <p class="breadcrumb"><a href="/projects/exiv2/boards">Forums</a> » <a href="/projects/exiv2/boards/3">Forum</a> » </p>

<div class="contextual">
    
    
    
    
</div>

<h2>Matching error to file for redirect output on the command line?</h2>

<div class="message">
<p><span class="author">Added by <a class="user active" href="/users/339">Steve Wright</a> <a title="26 Jul 2010 14:06" href="/projects/exiv2/activity?from=2010-07-26">over 11 years</a> ago</span></p>
<div class="wiki">
<p>I've taken to redirecting stderr with 2>>foo.txt, but I've noticed something when I read the foo.txt:<br />I get the error, but the name (or path and name) of the graphic file that prompted Exiv2 to report it isn't anywhere in the text file.<br />I've taken the problem to linuxquestions.org here: <a class="external" href="http://www.linuxquestions.org/questions/programming-9/bash-redirect-stderr-to-file-including-name-of-file-with-the-error-822190/">http://www.linuxquestions.org/questions/programming-9/bash-redirect-stderr-to-file-including-name-of-file-with-the-error-822190/</a> and the advice I'm getting seems to suggest that either there's a flag or option in Exiv2 of which I'm unaware, or that I should write my own error-catcher that passes the name of the "offending" file along with the Exiv2 error generated, to a text or hex file.</p>


	<p>I've scanned the man page up and down, and I don't think there is such an option or call to a routine that would help in this direction. So I'm thinking it may be time to "ramp up" the error-reporting functions of Exiv2 with an eye toward redirection. Perhaps instead of just a "blind" direct to stdout, ie, one that gives an error without naming the file that caused it when called by a script with a loop (for/do/done, while or case/esac being prime examples of loops in bash), the error-return could include the name of the "offender" along with the error.</p>


	<p>I recognize that when you're checking one specific file via an "exiv2 -pa" or other command and specifying one file, it might seem redundant to have it "vomit back" the file name you just gave it with the error. But consider: returns on -g options always give you the tag you specify, even when all you may want is the value of the tag you're grepping; files Exiv2 can't find use the conventional "${FNAME}: Could not write to file" syntax on those returns, so why <em>shouldn't</em> error-checking and -reporting be likewise as informative?</p>


	<p>Something for Andreas and Robin to consider, anyway. Meantime, I'll look into "getting into" the app's "vest pocket" and seeing what I can "lift" from there via bash or some other scripting method (ie, write my own error-catcher).</p>


	<p>Steve Wright</p>
</div>

</div>
<br />

<div id="replies">
<h3 class="comments icon icon-comments">Replies (4)</h3>
  <div class="message reply" id="message-570">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/569?r=570#message-570">RE: Matching error to file for redirect output on the command line?</a>
    -
    Added by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="26 Jul 2010 19:42" href="/projects/exiv2/activity?from=2010-07-26">over 11 years</a> ago
  </h4>
  <div class="wiki"><p>Thanks for your comments. I've linked them to <a class="issue tracker-2 status-5 priority-4 priority-default closed" title="Feature: Error handler: Applications should be able to register an error handler (Closed)" href="/issues/476">#476</a>, which is a long overdue issue to "ramp up" the error handling as you put it.</p>


	<p>What's currently happening is that exiv2 (the command line tool) writes out the file name followed by the error text when it catches an exception thrown by the library. The library does that when it encounters a "fatal" issue and gives up, e.g., the image file does not exist. But there are also places where the library writes "errors" and "warnings" to standard error directly and continues processing, and these may not always have a file name (maybe because it's not easily accessible from the code which detects the problem). That happens, e.g., when it encounters invalid Exif during parsing.</p>


	<p>Andreas</p></div>
  
  </div>
  <div class="message reply" id="message-571">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/569?r=571#message-571">RE: Matching error to file for redirect output on the command line?</a>
    -
    Added by <a class="user active" href="/users/339">Steve Wright</a> <a title="27 Jul 2010 05:52" href="/projects/exiv2/activity?from=2010-07-27">over 11 years</a> ago
  </h4>
  <div class="wiki"><p>Thanks Andreas.</p>


	<p>Have you seen my other thread on the IFD error? <a class="external" href="http://dev.exiv2.org/boards/3/topics/563">http://dev.exiv2.org/boards/3/topics/563</a> .<br />I'm still puzzled by how to correct these in files. I've also never seen it happen with files with which XnView was not involved in some way in writing tag values to them. Maybe I should let Pierre know?</p>


	<p>And as you're planning to tweak error returns, is there any chance you could also do something with iconv and the XP tags? As it stands, users get told when their strings are incorrectly-formatted, but there's nothing (besides my replies to topics 530 and 531 here in the forum) that explains how to format them correctly. And even my own researches and attempts at "translation" of plain text to the curious M$ zero-spaced/trailing-zeros ASCII format that seems nearest to what works, has occasionally come up with either plain text strings shorter than the ones input via Exiv2 or blank ones. In one of those threads, I mention that my own guess at what Microsoft uses for encoding is something close to, if not spot-on with, CS1259 (or is it <em>56</em>?), which is sorely lacking in the iconv executable in both the L/unix environments I work in but seems to be present in the iconv tools or calls that you wrote into Exiv2. Again, this is me taking a shot in the (semi-)dark.</p>


	<p>Steve Wright</p></div>
  
  </div>
  <div class="message reply" id="message-653">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/569?r=653#message-653">RE: Matching error to file for redirect output on the command line?</a>
    -
    Added by <a class="user active" href="/users/339">Steve Wright</a> <a title="16 Sep 2010 21:53" href="/projects/exiv2/activity?from=2010-09-16">about 11 years</a> ago
  </h4>
  <div class="wiki"><p>Okay, so version 0.20 has improved error-trapping.</p>


	<p>Is it written into the man page, or in the "hopper" to go into the Guide pages, how to make use of it?</p>


	<p>Just curious. I'll be looking around while I wait for an answer.</p>


	<p>Steve Wright</p></div>
  
  </div>
  <div class="message reply" id="message-657">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/569?r=657#message-657">RE: Matching error to file for redirect output on the command line?</a>
    -
    Added by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="17 Sep 2010 00:50" href="/projects/exiv2/activity?from=2010-09-17">about 11 years</a> ago
  </h4>
  <div class="wiki"><p>Version 0.20 does not have the improved error-trapping yet. It was added recently, after the release of 0.20. It is currently available in the SVN repository and will be in the next release, 0.21.</p>


	<p>The exiv2 command line tool has a new option -q, which makes use of this functionality. It suppresses error messages which are otherwise written to standard error. That new switch is documented in the exiv2 -h output and in the man page.</p>


	<p>Application developers will find the necessary documentation in the API documentation for the new class LogMsg. Pointers are also in the relevant Redmine issues.</p>


	<p>Of course, all this documentation is currently only in the SVN repository, together with the code.</p>


	<p>Andreas</p></div>
  
  </div>
</div>
<span class="pagination"><ul class="pages"></ul><span><span class="items">(1-4/4)</span> </span></span>



        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
