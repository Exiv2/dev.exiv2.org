<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Is it possible to add Nikon makernote tags with exiv2? - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="C8vY/uJh5ekxFEE+VqLgdNiIGJrPdHBlo/GsoSpHSbbphnMRkBsp6WRwXjLpdexH5xpM4z6X0d9e0TwpaX6u2Q==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
</head>
<body class="project-exiv2 has-main-menu controller-messages action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="messages" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="messages" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=boards" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=boards">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards selected" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="nosidebar">
    <div id="sidebar">
        
        
    </div>

    <div id="content">
        
        <p class="breadcrumb"><a href="/projects/exiv2/boards">Forums</a> » <a href="/projects/exiv2/boards/3">Forum</a> » </p>

<div class="contextual">
    
    
    
    
</div>

<h2>Is it possible to add Nikon makernote tags with exiv2?</h2>

<div class="message">
<p><span class="author">Added by <a class="user active" href="/users/1105">Michal K</a> <a title="29 Aug 2010 16:08" href="/projects/exiv2/activity?from=2010-08-29">about 11 years</a> ago</span></p>
<div class="wiki">
<p>Hi,</p>


	<p>I've just discovered this software and I just have a quick question before I go further with my experiments: can exiv2 add new makernote tags to Nikon NEF files? I'm specifically interested in adding these: PictureControlVersion, PictureControlName, PictureControlBase, PictureControlAdjust and PictureControlQuickAdjust. I'm going to use Win executable. Thanks!</p>
</div>

</div>
<br />

<div id="replies">
<h3 class="comments icon icon-comments">Replies (7)</h3>
  <div class="message reply" id="message-615">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/614?r=615#message-615">RE: Is it possible to add Nikon makernote tags with exiv2?</a>
    -
    Added by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="30 Aug 2010 01:45" href="/projects/exiv2/activity?from=2010-08-30">about 11 years</a> ago
  </h4>
  <div class="wiki"><p>That should work. Try! And if you run into problems, post the specific issue.</p>


	<p>Andreas</p></div>
  
  </div>
  <div class="message reply" id="message-618">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/614?r=618#message-618">RE: Is it possible to add Nikon makernote tags with exiv2?</a>
    -
    Added by <a class="user active" href="/users/1105">Michal K</a> <a title="30 Aug 2010 11:10" href="/projects/exiv2/activity?from=2010-08-30">about 11 years</a> ago
  </h4>
  <div class="wiki"><p>This seems to work somehow - I added the picture control tags to a nef file but ViewNX doesn't like it and says that the optional picture control on which the one from this file is based, is missing. It is strange bacause I copied exactly all picture control exif tags from a working nef and both exiv2 and exiftool show the tags are identical. But I understand that ViewNX can check for other data that we don't know about which makes it misbehave. BTW, I'm trying to set picture control tags in a file from D60 (which does not have picture controls). I tried copying all makernote exif from a picture control nef from D3000 to D60 nef and surprisingly it worked - ViewNX allowed editing without problems. I now want to do something similar but instead of copying everything just set the picture control tags. I wonder - the tags show up in different order in the D3000 and the modified D60 file - does this make any difference? Could it be that ViewNX accepts the tags only if they are written in the order specified by Nikon?</p></div>
  
  </div>
  <div class="message reply" id="message-620">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/614?r=620#message-620">RE: Is it possible to add Nikon makernote tags with exiv2?</a>
    -
    Added by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="31 Aug 2010 03:15" href="/projects/exiv2/activity?from=2010-08-31">about 11 years</a> ago
  </h4>
  <div class="wiki"><p>Interesting project :) As this is all Nikon proprietary stuff your guess is as good as mine. From past experience, I'm not aware of any issue with the order of the tags. (According to the TIFF standard they are supposed to be sorted by tag number in an IFD, but in makernote IFDs that's not always the case.) What I have seen before is that some software only works if certain tags are present. In these cases, I would incrementally add or remove tags until it works/doesn't work anymore.</p>


	<p>Andraes</p></div>
  
  </div>
  <div class="message reply" id="message-622">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/614?r=622#message-622">RE: Is it possible to add Nikon makernote tags with exiv2?</a>
    -
    Added by <a class="user active" href="/users/1105">Michal K</a> <a title="31 Aug 2010 06:42" href="/projects/exiv2/activity?from=2010-08-31">about 11 years</a> ago
  </h4>
  <div class="wiki"><p>Yes, interesting but really hard trying to hack proprietry stuff :). I have tried incrementally adding tags but I didn't go anywhere that route. The best result was when I used exiftool to copy all makernotes from a true D3000 nef to a D60 nef. But still I need to adjust certain tags.</p>


	<p>Now I experience weird behaviour with exiv2. I use it to insert Nikon Capture data (ViewNX adjustment settings) to a nef file like this:</p>


	<p>set Exif.Nikon3.CaptureData 64 169 134 122...</p>


	<p>Of course, there's a lot more data than this. This command corrupts the nef somehow - the settings appear to be okay in ViewNX but as soon as I try to load the raw image the colours are corrupted, there's a strong red/magenta cast and the image seems to be unusable. But I can work around this problem by running exiv2 twice. First time I can change anything simple, for example:</p>


	<p>set Exif.Nikon3.WhiteBalance SUNNY</p>


	<p>or:</p>


	<p>set Exif.Nikon3.Quality RAW</p>


	<p>Then when I inject the CaptureData in the second pass, the file works correctly in ViewNX. This is very strange and it took me a while to figure this out. Is this a bug in exiv2?</p></div>
  
  </div>
  <div class="message reply" id="message-624">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/614?r=624#message-624">RE: Is it possible to add Nikon makernote tags with exiv2?</a>
    -
    Added by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="01 Sep 2010 07:16" href="/projects/exiv2/activity?from=2010-09-01">about 11 years</a> ago
  </h4>
  <div class="wiki"><p>May be a bug. Can you please provide an original image and the exact steps that work and don't work, so that I can reproduce this here and compare the resulting images in detail? (This reminds me of <a class="issue tracker-1 status-5 priority-4 priority-default closed" title="Bug: Nikon capture nx won&#39;t save a raw file which was metadata manipulated from svn exiv2 (Closed)" href="/issues/701">#701</a>.)</p>


	<p>Andreas</p></div>
  
  </div>
  <div class="message reply" id="message-625">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/614?r=625#message-625">RE: Is it possible to add Nikon makernote tags with exiv2?</a>
    -
    Added by <a class="user active" href="/users/1105">Michal K</a> <a title="01 Sep 2010 17:20" href="/projects/exiv2/activity?from=2010-09-01">about 11 years</a> ago
  </h4>
  <div class="wiki"><p>Okay, I'll send you the file soon.</p>


	<p>Another question - is this possible to use exiv2 to add the FirmwareVersion tag? It is not reported by exiv2 and seems to be unsupported. It's the one listed here: <a class="external" href="http://owl.phy.queensu.ca/~phil/exiftool/TagNames/Nikon.html#ShotInfo">http://owl.phy.queensu.ca/~phil/exiftool/TagNames/Nikon.html#ShotInfo</a>. I suspect it is necessary for ViewNX when I add the picture control tags but neither exiv2 not exiftool allows me to access it. Or perhaps there is a way to add unsupported tags somehow? My guess is the key name should be Exif.NikonSi02xx.FirmwareVersion.</p></div>
  
  </div>
  <div class="message reply" id="message-628">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/614?r=628#message-628">RE: Is it possible to add Nikon makernote tags with exiv2?</a>
    -
    Added by <a class="user active" href="/users/53">Andreas Huggel</a> <a title="03 Sep 2010 20:32" href="/projects/exiv2/activity?from=2010-09-03">about 11 years</a> ago
  </h4>
  <div class="wiki"><p>Yes, you should be able to view and add/modify unknown tags within known groups, like this case. Run exiv2 -u -pa img.NEF to see the unknown tags and use the tagnumber in hex notation to set them, e.g., Exif.NikonSi02xx.0x0004</p>


	<p>Andreas</p></div>
  
  </div>
</div>
<span class="pagination"><ul class="pages"></ul><span><span class="items">(1-7/7)</span> </span></span>



        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
