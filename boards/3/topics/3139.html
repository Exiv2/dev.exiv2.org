<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<title>Linking Problem with MinGW binary distribution and QT - Exiv2</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="description" content="Redmine" />
<meta name="keywords" content="issue,bug,tracker" />
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="Xei63mlPSSajwzpGPmJTY6WdGyz+gMd2I6j7j7CYDyW/pRExGzWFJvanJUqBtV9Qmg9PVQ9jZszeiGsH86HoSg==" />
<link rel='shortcut icon' href='/favicon.ico?1550767427' />
<link rel="stylesheet" media="all" href="/stylesheets/jquery/jquery-ui-1.11.0.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/application.css?1550767427" />
<link rel="stylesheet" media="all" href="/stylesheets/responsive.css?1550767427" />

<script src="/javascripts/jquery-1.11.1-ui-1.11.0-ujs-4.3.1.js?1550767427"></script>
<script src="/javascripts/application.js?1550767427"></script>
<script src="/javascripts/responsive.js?1550767427"></script>
<script>
//<![CDATA[
$(window).load(function(){ warnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>


<!-- page specific tags -->
</head>
<body class="project-exiv2 has-main-menu controller-messages action-show avatars-off">

<div id="wrapper">

<div class="flyout-menu js-flyout-menu">


        <div class="flyout-menu__search">
            <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
            <input type="hidden" name="messages" value="1" />
            <label class="search-magnifier search-magnifier--flyout" for="flyout-search">&#9906;</label>
            <input type="text" name="q" id="flyout-search" class="small js-search-input" placeholder="Search" />
</form>        </div>


        <h3>Project</h3>
        <span class="js-project-menu"></span>

    <h3>General</h3>
    <span class="js-general-menu"></span>

    <span class="js-sidebar flyout-menu__sidebar"></span>

    <h3>Profile</h3>
    <span class="js-profile-menu"></span>

</div>

<div id="wrapper2">
<div id="wrapper3">
<div id="top-menu">
    <div id="account">
        <ul><li><a class="login" href="/login">Sign in</a></li></ul>    </div>
    
    <ul><li><a class="home" href="/">Home</a></li><li><a class="projects" href="/projects">Projects</a></li><li><a class="help" href="https://www.redmine.org/guide">Help</a></li></ul></div>

<div id="header">

    <a href="#" class="mobile-toggle-button js-flyout-menu-toggle-button"></a>

    <div id="quick-search">
        <form action="/projects/exiv2/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input type="hidden" name="scope" />
        <input type="hidden" name="messages" value="1" />
        <label for='q'>
          <a accesskey="4" href="/projects/exiv2/search">Search</a>:
        </label>
        <input type="text" name="q" id="q" size="20" class="small" accesskey="f" />
</form>        <div id="project-jump" class="drdn"><span class="drdn-trigger">Exiv2</span><div class="drdn-content"><div class="quick-search"><input type="text" name="q" id="projects-quick-search" value="" class="autocomplete" data-automcomplete-url="/projects/autocomplete.js?jump=boards" autocomplete="off" /></div><div class="drdn-items projects selection"></div><div class="drdn-items all-projects selection"><a href="/projects?jump=boards">All Projects</a></div></div></div>
    </div>

    <h1><span class="current-project">Exiv2</span></h1>

    <div id="main-menu" class="tabs">
        <ul><li><a class="overview" href="/projects/exiv2">Overview</a></li><li><a class="activity" href="/projects/exiv2/activity">Activity</a></li><li><a class="roadmap" href="/projects/exiv2/roadmap">Roadmap</a></li><li><a class="issues" href="/projects/exiv2/issues">Issues</a></li><li><a class="news" href="/projects/exiv2/news">News</a></li><li><a class="wiki" href="/projects/exiv2/wiki">Wiki</a></li><li><a class="boards selected" href="/projects/exiv2/boards">Forums</a></li><li><a class="repository" href="/projects/exiv2/repository">Repository</a></li></ul>
        <div class="tabs-buttons" style="display:none;">
            <button class="tab-left" onclick="moveTabLeft(this); return false;"></button>
            <button class="tab-right" onclick="moveTabRight(this); return false;"></button>
        </div>
    </div>
</div>

<div id="main" class="nosidebar">
    <div id="sidebar">
        
        
    </div>

    <div id="content">
        
        <p class="breadcrumb"><a href="/projects/exiv2/boards">Forums</a> » <a href="/projects/exiv2/boards/3">Forum</a> » </p>

<div class="contextual">
    
    
    
    
</div>

<h2>Linking Problem with MinGW binary distribution and QT</h2>

<div class="message">
<p><span class="author">Added by <a class="user active" href="/users/7117">Michael Möllney</a> <a title="03 May 2018 20:29" href="/projects/exiv2/activity?from=2018-05-03">over 3 years</a> ago</span></p>
<div class="wiki">
<p>Hi</p>


	<p>Sorry if this is handled somewhere else. I found a message with answer giving hints how to use the prebuild exiv2 MinGW version with Qt but this does not seem to work with my installation.</p>


	<p>The messges I found are using MinGW 4.9.2 and Qt 5.6 while I like to use the current Qt LTS 5.9.x which is prebuild by Qt along with MinGW 5.3.0.</p>


	<p>Whenever I link my program with MinGW I get the message:</p>


<pre>
g++ -Wl,-subsystem,windows -mthreads -o debug\PhotoCollector.exe debug/main.o debug/mainwindow.o debug/photocollection.o debug/photofile.o debug/photocollectionmodel.o debug/moc_mainwindow.o debug/moc_photocollection.o  -lmingw32 -LC:\Qt_online\5.9.5\mingw53_32\lib C:\Qt_online\5.9.5\mingw53_32\lib\libqtmaind.a -LC:\utils\my_sql\my_sql\lib -LC:\utils\postgresql\pgsql\lib -lshell32 -LC:\Users\Michael\Downloads\Exif\exiv2-0.26-mingw.tar\exiv2-0.26-mingw\dist\mingw\lib -lexiv2.dll C:\Qt_online\5.9.5\mingw53_32\lib\libQt5Widgetsd.a C:\Qt_online\5.9.5\mingw53_32\lib\libQt5Guid.a C:\Qt_online\5.9.5\mingw53_32\lib\libQt5Cored.a 
debug/photocollectionmodel.o: In function `ZNK20PhotoCollectionModel4dataERK11QModelIndexi':
C:\Users\Michael\Documents\Projects\PhotoCollector\PC_trunk\build-PhotoCollector-Desktop_Qt_5_9_5_MinGW_32bit-Debug/../PhotoCollector/photocollectionmodel.cpp:61: undefined reference to `Exiv2::ImageFactory::open(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&#38;, bool)'
C:\Users\Michael\Documents\Projects\PhotoCollector\PC_trunk\build-PhotoCollector-Desktop_Qt_5_9_5_MinGW_32bit-Debug/../PhotoCollector/photocollectionmodel.cpp:64: undefined reference to `Exiv2::ExifData::operator[](std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&#38;)'
C:\Users\Michael\Documents\Projects\PhotoCollector\PC_trunk\build-PhotoCollector-Desktop_Qt_5_9_5_MinGW_32bit-Debug/../PhotoCollector/photocollectionmodel.cpp:64: undefined reference to `Exiv2::Value::toString[abi:cxx11]() const'
collect2.exe: error: ld returned 1 exit status
mingw32-make[1]: *** [debug\PhotoCollector.exe] Error 1
</pre>

	<p>I tried different constallations in the Qt qmake .pro file but to no gain.</p>


<pre>
win32: LIBS += -L$$PWD/../../../../../Downloads/Exif/exiv2-0.26-mingw.tar/exiv2-0.26-mingw/dist/mingw/lib/ -lexiv2.dll

INCLUDEPATH += $$PWD/../../../../../Downloads/Exif/exiv2-0.26-mingw.tar/exiv2-0.26-mingw/dist/mingw/include
DEPENDPATH += $$PWD/../../../../../Downloads/Exif/exiv2-0.26-mingw.tar/exiv2-0.26-mingw/dist/mingw/include
</pre>

	<p>and</p>


<pre>
win32: LIBS += -L$$PWD/../../../../../Downloads/Exif/exiv2-0.26-mingw.tar/exiv2-0.26-mingw/dist/mingw/lib/ -lexiv2

INCLUDEPATH += $$PWD/../../../../../Downloads/Exif/exiv2-0.26-mingw.tar/exiv2-0.26-mingw/dist/mingw/include
DEPENDPATH += $$PWD/../../../../../Downloads/Exif/exiv2-0.26-mingw.tar/exiv2-0.26-mingw/dist/mingw/include
</pre>

	<p>did not work, too.</p>


	<p>Could someone be so nice and give me a hint, what I'm doing wrong.</p>


	<p>Thanks,<br />Michael</p>
</div>

</div>
<br />

<div id="replies">
<h3 class="comments icon icon-comments">Replies (5)</h3>
  <div class="message reply" id="message-3140">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/3139?r=3140#message-3140">RE: Linking Problem with MinGW binary distribution and QT</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="03 May 2018 21:18" href="/projects/exiv2/activity?from=2018-05-03">over 3 years</a> ago
  </h4>
  <div class="wiki"><p>Michael</p>


	<p>I have to admit to both a love of Qt and a dislike of MinGW.</p>


	<p>I see you're getting undefined reference: Exiv2::Value::toString[abi:cxx11]() const and I'm wondering if building your application with C++11 when the library is built with C++98 is not possible.  I've never thought about this combination.  You can inspect entries in the library with the command: <pre>471 -32- /usr/local/lib&gt; nm -g --demangle libexiv2.dll.a | grep Exiv2::Value::toString
00000000 T Exiv2::Value::toString() const
00000000 T Exiv2::Value::toString(long) const
472 -32- /usr/local/lib&gt;</pre></p>


	<p>I have investigated Exiv2+MinGW+Qt for users several times:<br /><a class="external" href="http://dev.exiv2.org/boards/3/topics/2705">http://dev.exiv2.org/boards/3/topics/2705</a><br /><a class="external" href="http://dev.exiv2.org/issues/871">http://dev.exiv2.org/issues/871</a><br /><a class="external" href="http://dev.exiv2.org/boards/3/topics/1304">http://dev.exiv2.org/boards/3/topics/1304</a></p>


	<p>There's an article about using MinGW+Exiv2<br /><a class="external" href="http://clanmills.com/exiv2/mingw.shtml">http://clanmills.com/exiv2/mingw.shtml</a></p>


	<p>There is a sample application:<br />exiv2/contrib/cmake/mingw</p></div>
  
  </div>
  <div class="message reply" id="message-3141">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/3139?r=3141#message-3141">RE: Linking Problem with MinGW binary distribution and QT</a>
    -
    Added by <a class="user active" href="/users/76">Gilles Caulier</a> <a title="04 May 2018 03:32" href="/projects/exiv2/activity?from=2018-05-04">over 3 years</a> ago
  </h4>
  <div class="wiki"><p>More than one time i read weird reports about Qt + Exiv2 + Mingw from Exiv2 world...</p>


	<p>How I can say... MinGW is certainly the best compiler that i know. And i know what i mean : I use it to package WHOLE digiKam installer for Windows, including last Qt5.10 + KF5 + All digiKam core 6.0.0 , and of course Exiv2 0.26.</p>


	<p>But i don't use directly MinGw, but MXE cross compiler envirronement. It's a Jewel !</p>


	<p><a class="external" href="http://mxe.cc/">http://mxe.cc/</a></p>


	<p>As you can see, MXE, as all that you need including Exiv2 package.</p>


	<p>All source code are cross compiled under Linux. I don't use Windows to make the digiKam Windows installer. This take around 2 hours to buidl all from scratch on my host Linux computer (8 core, 32 Gb of RAM, SSD).</p>


	<p>Remember : digiKam is more and less 1,5 M of lines of C++ code based on Qt5, and all compile, link, and run like a charm, under Windows 7, 8, and 10. You can debug under Windows using QtCreator at runtime.</p>


	<p><a class="external" href="https://www.openhub.net/p/digikam/analyses/latest/languages_summary">https://www.openhub.net/p/digikam/analyses/latest/languages_summary</a></p>


	<p>I cannot said better under MacOS (Macports) which is really a puzzle and a waste of time to maintain.</p>


	<p>What's about MSVC : it's the most weird compiler and development env. that i need to use in my office where i manage around 250.000 line of code of C and C++ (Qt based). I don't want to use it about digiKam project, because it's a waste of time.</p>


	<p>My scripts to compile and package digiKam for Windows under Linux using MXE :</p>


	<p><a class="external" href="https://github.com/KDE/digikam/tree/master/project/bundles/mxe">https://github.com/KDE/digikam/tree/master/project/bundles/mxe</a></p>


	<p>Best</p>


	<p>Gilles Caulier</p></div>
  
  </div>
  <div class="message reply" id="message-3146">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/3139?r=3146#message-3146">RE: Linking Problem with MinGW binary distribution and QT</a>
    -
    Added by <a class="user active" href="/users/7117">Michael Möllney</a> <a title="09 May 2018 21:52" href="/projects/exiv2/activity?from=2018-05-09">over 3 years</a> ago
  </h4>
  <div class="wiki"><p>Robin</p>


	<p>sorry for the late reply.</p>


	<p>Robin Mills wrote:</p>


<blockquote>

	<p>Michael</p>


	<p>I have to admit to both a love of Qt and a dislike of MinGW.</p>


	<p>I see you're getting undefined reference: Exiv2::Value::toString[abi:cxx11]() const and I'm wondering if building your application with C++11 when the library is built with C++98 is not possible.  I've never thought about this combination.  You can inspect entries in the library with the command: [...]</p>


</blockquote>

	<p>And thats probably it.<br />I found <br />Exiv2::ImageFactory::open(std::string const&#38;, bool)<br />in the library using the nm tool you mentioned.</p>


	<p>As far as I understood Qt 5.7 and newer need C++11 in the library so they probably bind agains the std::__cxx11::basic_string... so this may be it.</p>


	<p>I think they still have a Qt 5.6 LTS (over 2 years old feature wise) and a toolchain with MinGW 4.9.2 around...</p>


	<p>But maybe it is time to support the new C++11 abi in the precompiled versions.<br />Any chance to get a MinGW 5.3.x C++11 precompiled exiv2 download, maybe using the tools coming with the QtOnline installer?<br />That would be geat....</p>


	<p>Kind regards,<br />Michael</p></div>
  
  </div>
  <div class="message reply" id="message-3147">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/3139?r=3147#message-3147">RE: Linking Problem with MinGW binary distribution and QT</a>
    -
    Added by <a class="user active" href="/users/7117">Michael Möllney</a> <a title="09 May 2018 21:57" href="/projects/exiv2/activity?from=2018-05-09">over 3 years</a> ago
  </h4>
  <div class="wiki"><p>Hi Gilles</p>


	<p>Gilles Caulier wrote:</p>


<blockquote>

	<p>More than one time i read weird reports about Qt + Exiv2 + Mingw from Exiv2 world...</p>


	<p>How I can say... MinGW is certainly the best compiler that i know. And i know what i mean : I use it to package WHOLE digiKam installer for Windows, including last Qt5.10 + KF5 + All digiKam core 6.0.0 , and of course Exiv2 0.26.</p>


	<p>But i don't use directly MinGw, but MXE cross compiler envirronement. It's a Jewel !</p>


	<p><a class="external" href="http://mxe.cc/">http://mxe.cc/</a></p>


	<p>As you can see, MXE, as all that you need including Exiv2 package.</p>


	<p>All source code are cross compiled under Linux. I don't use Windows to make the digiKam Windows installer. This take around 2 hours to buidl all from scratch on my host Linux computer (8 core, 32 Gb of RAM, SSD).</p>


	<p>Remember : digiKam is more and less 1,5 M of lines of C++ code based on Qt5, and all compile, link, and run like a charm, under Windows 7, 8, and 10. You can debug under Windows using QtCreator at runtime.</p>


	<p><a class="external" href="https://www.openhub.net/p/digikam/analyses/latest/languages_summary">https://www.openhub.net/p/digikam/analyses/latest/languages_summary</a></p>


	<p>I cannot said better under MacOS (Macports) which is really a puzzle and a waste of time to maintain.</p>


	<p>What's about MSVC : it's the most weird compiler and development env. that i need to use in my office where i manage around 250.000 line of code of C and C++ (Qt based). I don't want to use it about digiKam project, because it's a waste of time.</p>


	<p>My scripts to compile and package digiKam for Windows under Linux using MXE :</p>


	<p><a class="external" href="https://github.com/KDE/digikam/tree/master/project/bundles/mxe">https://github.com/KDE/digikam/tree/master/project/bundles/mxe</a></p>


	<p>Best</p>


	<p>Gilles Caulier</p>


</blockquote>

	<p>This is really interesting stuff.</p>


	<p>At my company we cross-compile apps from linux to embedded linux and use VS to create windows GUI apps.<br />One gui in my team use MinGW to crosscompile his Windows Apps under linux. I will talk to him about how he manages to accomplish this. Maybe he even uses MXE but did tell me...</p>


	<p>Thanks,</p>


	<p>Michael</p></div>
  
  </div>
  <div class="message reply" id="message-3148">
    <div class="contextual">
      
      
      
    </div>
  <h4>
    
    <a href="/boards/3/topics/3139?r=3148#message-3148">RE: Linking Problem with MinGW binary distribution and QT</a>
    -
    Added by <a class="user active" href="/users/119">Robin Mills</a> <a title="10 May 2018 12:22" href="/projects/exiv2/activity?from=2018-05-10">over 3 years</a> ago
  </h4>
  <div class="wiki"><p>Michael</p>


	<p>I built and distributed Exiv2 v0.26 MinGW binaries with C++98 and there is a simple test to compile code to link with Qt in the build.  We will be adding support to build with C++11 in v0.27</p>


	<p>We had an "Exiv2 Developer's Meeting" at my home in England last weekend.  We discussed cross-compiling over lunch on Sunday.  None of the three of us have ever done this.  If you or your co-workers would like to work with me to get cross-compiling to work, I would appreciate your help.</p>


	<p>I did try to install MXE on a VM running Kubuntu 16.04.  After installing a couple of dependencies, the VM froze and would not reboot.  I reverted to a snap-shot.  I repeated the exercise with the same unsuccessful result.</p>


	<p>Robin</p></div>
  
  </div>
</div>
<span class="pagination"><ul class="pages"></ul><span><span class="items">(1-5/5)</span> </span></span>



        
        <div style="clear:both;"></div>
    </div>
</div>
</div>

<div id="ajax-indicator" style="display:none;"><span>Loading...</span></div>
<div id="ajax-modal" style="display:none;"></div>

<div id="footer">
  <div class="bgl"><div class="bgr">
    Powered by <a href="https://www.redmine.org/">Redmine</a> &copy; 2006-2018 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
